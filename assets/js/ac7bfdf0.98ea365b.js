"use strict";(self.webpackChunkcapella_documentation=self.webpackChunkcapella_documentation||[]).push([[1968],{2220:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Terraform-Kubernetes/Cambria_Cluster_Terraform_Akamai_Kubernetes","title":"Terraform on Akamai Kubernetes","description":"Terraform Installation","source":"@site/docs/Cambria_FTC/01-Installation Guides/01-Kubernetes/02-Akamai/Akamai-Terraform-Kubernetes/Cambria_Cluster_and_FTC_5_6_0_Terraform_on_Akamai_Kubernetes_index.md","sourceDirName":"Cambria_FTC/01-Installation Guides/01-Kubernetes/02-Akamai/Akamai-Terraform-Kubernetes","slug":"/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Terraform-Kubernetes/Cambria_Cluster_Terraform_Akamai_Kubernetes","permalink":"/docs/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Terraform-Kubernetes/Cambria_Cluster_Terraform_Akamai_Kubernetes","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Cambria_Cluster_Terraform_Akamai_Kubernetes","title":"Terraform on Akamai Kubernetes"},"sidebar":"FTCSidebar","previous":{"title":"Akamai Cloud Kubernetes","permalink":"/docs/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Kubernetes/"},"next":{"title":"Cambria Cluster / FTC 5.5.0 - Oracle Kubernetes","permalink":"/docs/Cambria_FTC/Installation Guides/Kubernetes/Oracle/"}}');var i=s(4848),t=s(8453);const l={id:"Cambria_Cluster_Terraform_Akamai_Kubernetes",title:"Terraform on Akamai Kubernetes"},a="Cambria Cluster / FTC 5.6.0 \u2014 Akamai Cloud Kubernetes Help Documentation",o={},d=[{value:"Terraform Installation",id:"terraform-installation",level:2},{value:"Document History",id:"document-history",level:3},{value:"Limitations and Security Information",id:"limitations-and-security-information",level:3},{value:"Important: Before You Begin",id:"important-before-you-begin",level:3},{value:"Information",id:"information",level:3},{value:"\u26a0 Critical Information: Read Before Proceeding with Installation",id:"-critical-information-read-before-proceeding-with-installation",level:2},{value:"1. Prerequisites",id:"1-prerequisites",level:2},{value:"1.1. X11 Forwarding for User Interface",id:"11-x11-forwarding-for-user-interface",level:3},{value:"1.1.1. Option 1: Microsoft Windows Tools",id:"111-option-1-microsoft-windows-tools",level:4},{value:"1.1.2. Option 2: Apple macOS Tools",id:"112-option-2-apple-macos-tools",level:4},{value:"1.2. Prepare Deployment Server",id:"12-prepare-deployment-server",level:3},{value:"2. Cambria FTC Package",id:"2-cambria-ftc-package",level:2},{value:"3. Installation",id:"3-installation",level:2},{value:"3.1. Configure the Kubernetes Cluster",id:"31-configure-the-kubernetes-cluster",level:3},{value:"3.2. (Optional) Cambria FTC Optional Values",id:"32-optional-cambria-ftc-optional-values",level:3},{value:"3.3. Deploy Kubernetes Cluster",id:"33-deploy-kubernetes-cluster",level:3},{value:"4. Verification and Testing",id:"4-verification-and-testing",level:2},{value:"4.1. Cambria Cluster / FTC Info",id:"41-cambria-cluster--ftc-info",level:3},{value:"5. Upgrading",id:"5-upgrading",level:2},{value:"6. Cleanup / Delete",id:"6-cleanup--delete",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"cambria-cluster--ftc-560--akamai-cloud-kubernetes-help-documentation",children:"Cambria Cluster / FTC 5.6.0 \u2014 Akamai Cloud Kubernetes Help Documentation"})}),"\n",(0,i.jsx)(n.h2,{id:"terraform-installation",children:"Terraform Installation"}),"\n",(0,i.jsx)(n.h3,{id:"document-history",children:"Document History"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Version"}),(0,i.jsx)(n.th,{children:"Date"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"5.5.0"}),(0,i.jsx)(n.td,{children:"04/11/2025"}),(0,i.jsx)(n.td,{children:"Updated for release 5.5.0.23529 (Linux)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"5.6.0"}),(0,i.jsx)(n.td,{children:"10/31/2025"}),(0,i.jsx)(n.td,{children:"Updated for release 5.6.0.26533 (Linux)"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Download the online version of this document for the latest information and latest files. Always download the latest files."})}),"\n",(0,i.jsx)(n.p,{children:"Do not move forward with the installation process if you do not agree with the End User License Agreement (EULA) for our products. You can download and read the EULA for Cambria FTC, Cambria Cluster, and Cambria License Manager from the links below:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Cambria License Manager: ",(0,i.jsx)(n.a,{href:"https://www.dropbox.com/s/1wg7ee7a59kzi8h/EULA_Cambria_License_Manager.pdf?dl=0",children:"https://www.dropbox.com/s/1wg7ee7a59kzi8h/EULA_Cambria_License_Manager.pdf?dl=0"})]}),"\n",(0,i.jsxs)(n.li,{children:["Cambria Cluster: ",(0,i.jsx)(n.a,{href:"https://www.dropbox.com/s/oemlax63aatjjiw/EULA_Cluster.pdf?dl=0",children:"https://www.dropbox.com/s/oemlax63aatjjiw/EULA_Cluster.pdf?dl=0"})]}),"\n",(0,i.jsxs)(n.li,{children:["Cambria FTC: ",(0,i.jsx)(n.a,{href:"https://www.dropbox.com/s/ualv9usxsowh6m2/EULA_FTC.pdf?dl=0",children:"https://www.dropbox.com/s/ualv9usxsowh6m2/EULA_FTC.pdf?dl=0"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"limitations-and-security-information",children:"Limitations and Security Information"}),"\n",(0,i.jsx)(n.p,{children:"Cambria FTC, Cluster, and License Manager are installed on Linux Docker containers. Limitations and security checks done for this version are included in our general Linux Documents below."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," these documents are for informational use only. The setup for Kubernetes starts in section ",(0,i.jsx)(n.strong,{children:"2. Create Kubernetes Cluster"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Cambria FTC / Cluster:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/ljzuqv0azo3o7gpyi7y7x/Linux_Cambria_Cluster_and_FTC_5_6_0_Guide.pdf?rlkey=nldkuz4hoirupwvgm3yq1tgcu&st=wfnaz6lz&dl=0",children:"https://www.dropbox.com/scl/fi/ljzuqv0azo3o7gpyi7y7x/Linux_Cambria_Cluster_and_FTC_5_6_0_Guide.pdf?rlkey=nldkuz4hoirupwvgm3yq1tgcu&st=wfnaz6lz&dl=0"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"important-before-you-begin",children:"Important: Before You Begin"}),"\n",(0,i.jsx)(n.p,{children:"PDF documents have a copy/paste issue. For best results, download this document and any referenced PDF documents in this guide and open them in a PDF viewer such as Adobe Acrobat."}),"\n",(0,i.jsx)(n.p,{children:"For commands that are in more than one line, copy each line one by one and check that the copied command matches the one in the document."}),"\n",(0,i.jsx)(n.h3,{id:"information",children:"Information"}),"\n",(0,i.jsxs)(n.p,{children:["This document references ",(0,i.jsx)(n.strong,{children:"Kubernetes version 1.34"})," only."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-critical-information-read-before-proceeding-with-installation",children:"\u26a0 Critical Information: Read Before Proceeding with Installation"}),"\n",(0,i.jsx)(n.p,{children:"Before starting the installation, carefully review the following considerations. Skipping this section may result in errors, failed deployments, or misconfigurations."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Review the main Akamai Kubernetes Document:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Read the ",(0,i.jsx)(n.em,{children:"Critical Information: Read Before Proceeding with Installation"})," section of the document:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/jmndc09hsb308uzfv5yzd/Cambria_Cluster_and_FTC_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=0yx9di8w6k8r79g28mu8quza7&st=rr0ocfdz&dl=0",children:"https://www.dropbox.com/scl/fi/jmndc09hsb308uzfv5yzd/Cambria_Cluster_and_FTC_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=0yx9di8w6k8r79g28mu8quza7&st=rr0ocfdz&dl=0"})]}),"\n",(0,i.jsxs)(n.li,{children:["Read the ",(0,i.jsx)(n.em,{children:"Critical Information: Read Before Proceeding with Installation"})," section of the document:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/cb75lsh6ipvbf0x1y4ysp/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=kcxit4i6ntj5ynv2e26zydhiy&st=1bpaoqrx&dl=0",children:"https://www.dropbox.com/scl/fi/cb75lsh6ipvbf0x1y4ysp/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=kcxit4i6ntj5ynv2e26zydhiy&st=1bpaoqrx&dl=0"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"GUI-Based Operating System Required"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The Terraform deployment uses a desktop UI tool for editing configuration files."}),"\n",(0,i.jsx)(n.li,{children:"Either the Linux deployment server or an SSH client for the Linux deployment server needs to have a UI."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-prerequisites",children:"1. Prerequisites"}),"\n",(0,i.jsx)(n.h3,{id:"11-x11-forwarding-for-user-interface",children:"1.1. X11 Forwarding for User Interface"}),"\n",(0,i.jsx)(n.p,{children:"If using SSH to access the Linux deployment server and the SSH client machine is either Windows or Mac, there are some special tools that need to be installed in order to be able to use the user interface from Capella's Terraform installer. If using Linux, the machine must have a graphical user interface (GUI)."}),"\n",(0,i.jsx)(n.h4,{id:"111-option-1-microsoft-windows-tools",children:"1.1.1. Option 1: Microsoft Windows Tools"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Download and install the X11 Forwarding Tool ",(0,i.jsx)(n.strong,{children:"Xming"}),":",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://github.com/marchaesen/vcxsrv/releases/download/21.1.16.1/vcxsrv-64.21.1.16.1.installer.noadmin.exe",children:"https://github.com/marchaesen/vcxsrv/releases/download/21.1.16.1/vcxsrv-64.21.1.16.1.installer.noadmin.exe"})]}),"\n",(0,i.jsxs)(n.li,{children:["Also, download and install ",(0,i.jsx)(n.strong,{children:"PuTTY"})," or similar tool that allows X11 Forwarding SSH:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html",children:"https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html"})]}),"\n",(0,i.jsxs)(n.li,{children:["Open ",(0,i.jsx)(n.strong,{children:"XLaunch"})," and do the following:",(0,i.jsx)(n.br,{}),"\n","a. Window 1: Choose ",(0,i.jsx)(n.strong,{children:"Multiple windows"})," and set ",(0,i.jsx)(n.strong,{children:"Display number"})," to ",(0,i.jsx)(n.strong,{children:"0"}),(0,i.jsx)(n.br,{}),"\n","b. Window 2: Choose to ",(0,i.jsx)(n.strong,{children:"Start no client"}),(0,i.jsx)(n.br,{}),"\n","c. Window 3: Enable all checkboxes: ",(0,i.jsx)(n.strong,{children:"Clipboard"}),", ",(0,i.jsx)(n.strong,{children:"Primary Selection"}),", ",(0,i.jsx)(n.strong,{children:"Native opengl"}),", and ",(0,i.jsx)(n.strong,{children:"Disable access control"}),(0,i.jsx)(n.br,{}),"\n","d. Window 4: Click on ",(0,i.jsx)(n.strong,{children:"Save configuration"})," and save this somewhere to reuse in the future"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"112-option-2-apple-macos-tools",children:"1.1.2. Option 2: Apple macOS Tools"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Download and install the X11 Forwarding Tool ",(0,i.jsx)(n.strong,{children:"XQuartz"}),":",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://github.com/XQuartz/XQuartz/releases/download/XQuartz-2.8.5/XQuartz-2.8.5.pkg",children:"https://github.com/XQuartz/XQuartz/releases/download/XQuartz-2.8.5/XQuartz-2.8.5.pkg"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"12-prepare-deployment-server",children:"1.2. Prepare Deployment Server"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["On the Akamai Dashboard, create a new Ubuntu Linode used for the Terraform deployment. For best performance, choose an ",(0,i.jsx)(n.strong,{children:"8GB RAM"})," or higher machine as X11 Forwarding uses a lot of memory on the Linode instance."]}),"\n",(0,i.jsx)(n.li,{children:"SSH into the new Linode and install general tools:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'sudo apt update && sudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::="--force-confold" -y upgrade && sudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::="--force-confold" -y install curl unzip libice6 libsm6 dbus libgtk-3-0\n'})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," If during this step, a ",(0,i.jsx)(n.em,{children:"Configuring openssh-server"})," menu shows up, choose ",(0,i.jsx)(n.strong,{children:"keep the local version currently installed"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-cambria-ftc-package",children:"2. Cambria FTC Package"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"SSH into the Linux deployment server, if not already done so."}),"\n",(0,i.jsx)(n.li,{children:"Download the Terraform package:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -o terraform_CambriaClusterLKE_5.6.0.zip -L "https://www.dropbox.com/scl/fi/yubw0u4qm5fu43gvljfsf/terraform_CambriaClusterLKE_5.6.0.zip?rlkey=pwmndosi686btc5fwzh2f8uvm&st=pn69pmm7&dl=0"\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Unzip the package and make the shell scripts executable:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"unzip -o terraform_CambriaClusterLKE_5.6.0.zip && chmod +x ./bin/*.sh ./bin/TerraformVariableEditor\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Install the tools needed for deployment:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/setupTools.sh && ./bin/installKubeToolsAkamai.sh && ./bin/installLogcli.sh && ./bin/installTerraformDocs.sh\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Restart the SSH terminal window for the changes to take effect."}),"\n",(0,i.jsx)(n.li,{children:"Verify the tools are installed:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl version --client && helm version && terraform --version && terraform-docs --version && linode-cli --version\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-installation",children:"3. Installation"}),"\n",(0,i.jsx)(n.h3,{id:"31-configure-the-kubernetes-cluster",children:"3.1. Configure the Kubernetes Cluster"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["SSH into the instance created in section ",(0,i.jsx)(n.strong,{children:"1.2. Prepare Deployment Server"})," using one of the following methods (depending on the OS being used as the SSH client):"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option 1: Windows"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Open PuTTY or similar tool. Enable ",(0,i.jsx)(n.strong,{children:"X11 Forwarding"})," in the configuration. On PuTTY, this can be found in ",(0,i.jsx)(n.strong,{children:"Connection > SSH > X11 > X11 forwarding"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["SSH into the instance with the created user. Usually, the user is ",(0,i.jsx)(n.strong,{children:"root"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option 2: Unix (Linux, macOS)"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Open a terminal window and ",(0,i.jsx)(n.code,{children:"ssh"})," into the Linode instance using ",(0,i.jsx)(n.code,{children:"-Y"})," option and one of the created users. This is usually ",(0,i.jsx)(n.strong,{children:"root"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ssh -Y -i "mysshkey" root@123.123.123.123\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Run the Terraform editor UI:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/TerraformVariableEditor\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["Click on ",(0,i.jsx)(n.strong,{children:"Open Terraform File"})," and choose the ",(0,i.jsx)(n.code,{children:"CambriaClusterValues_SENSITIVE_VALUES.tf"})," file from the ",(0,i.jsx)(n.strong,{children:"values"})," directory."]}),"\n",(0,i.jsx)(n.li,{children:"Using the UI, edit the fields accordingly. Reference the following table for values that should be changed:"}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Terraform UI Editor Field"}),(0,i.jsx)(n.th,{children:"Explanation"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"linode_token"})}),(0,i.jsxs)(n.td,{children:["See ",(0,i.jsx)(n.a,{href:"https://www.linode.com/docs/products/tools/api/guides/manage-api-tokens/",children:"https://www.linode.com/docs/products/tools/api/guides/manage-api-tokens/"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"pg_cluster_password"})}),(0,i.jsx)(n.td,{children:"The password for the PostgreSQL database that Cambria Cluster uses. General password rules apply."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cambria_cluster_api_token"})}),(0,i.jsxs)(n.td,{children:["A token needed for making calls to the Cambria FTC web server. General token rules apply (Eg. ",(0,i.jsx)(n.code,{children:"1234-5678-90abcdefg"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cambria_cluster_webui_user"})}),(0,i.jsxs)(n.td,{children:["This is the login credentials for all of the Cambria WebUIs for the Kubernetes cluster. Each user is listed in the form: ",(0,i.jsx)(n.code,{children:"role,username,password"}),".",(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(n.strong,{children:"Allowed roles:"}),(0,i.jsx)("br",{}),"1. ",(0,i.jsx)(n.strong,{children:"admin"})," \u2014 can view/create/edit/delete anything on the WebUI. Can also create/manage WebUI users.",(0,i.jsx)("br",{}),"2. ",(0,i.jsx)(n.strong,{children:"superuser"})," \u2014 can view/create/edit/delete anything on the WebUI.",(0,i.jsx)("br",{}),"3. ",(0,i.jsx)(n.strong,{children:"user"})," \u2014 can only view anything on the WebUI.",(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"For multiple users, separate each by a comma. Example: ",(0,i.jsx)(n.code,{children:"admin,admin,changethispassword1234,user,guest,password123"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"argo_event_webhook_source_bearer_token"})}),(0,i.jsxs)(n.td,{children:["A token needed for making specific argo events calls. General token rules apply (Eg. ",(0,i.jsx)(n.code,{children:"1234-5678-90abcdefg"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ftc_license_key"})}),(0,i.jsxs)(n.td,{children:["This is the Cambria FTC license key that Capella should have provided. The license key should start with a '2'. Only one license key is needed here (Eg. ",(0,i.jsx)(n.code,{children:"2AB122-11123A-ABC890-DEF345-ABC321-543A21"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"grafana_admin_password"})}),(0,i.jsx)(n.td,{children:"The password for Grafana Dashboard. General password rules apply."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_s3_access_key"})}),(0,i.jsxs)(n.td,{children:["The recommended log storage solution is AWS S3 or compatible S3 storage. If using this solution, this is the ",(0,i.jsx)(n.code,{children:"ACCESS_KEY"})," or ",(0,i.jsx)(n.code,{children:"AWS_ACCESS_KEY_ID"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_s3_secret_key"})}),(0,i.jsxs)(n.td,{children:["The recommended log storage solution is AWS S3 or compatible S3 storage. If using this solution, this is the ",(0,i.jsx)(n.code,{children:"SECRET_KEY"})," or ",(0,i.jsx)(n.code,{children:"AWS_SECRET_ACCESS_KEY"}),"."]})]})]})]}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsxs)(n.li,{children:["Once done, click on ",(0,i.jsx)(n.strong,{children:"Save Changes"})," and wait for the message ",(0,i.jsx)(n.strong,{children:"Changes were saved"})," to appear."]}),"\n",(0,i.jsxs)(n.li,{children:["Click on ",(0,i.jsx)(n.strong,{children:"Open Terraform File"})," and choose the ",(0,i.jsx)(n.code,{children:"CambriaClusterValues_IMPORTANT_VALUES.tf"})," file."]}),"\n",(0,i.jsx)(n.li,{children:"Using the UI, edit the fields accordingly. Reference the following table for values that should be changed:"}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Terraform UI Editor Field"}),(0,i.jsx)(n.th,{children:"Explanation"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lke_cluster_name"})}),(0,i.jsx)(n.td,{children:"The name of the Kubernetes cluster."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lk_region"})}),(0,i.jsx)(n.td,{children:"The region code where the Kubernetes cluster should be deployed."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lke_manager_pool_node_count"})}),(0,i.jsx)(n.td,{children:"The number of Cambria Cluster nodes to create."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lke_worker_pool_node_count"})}),(0,i.jsx)(n.td,{children:"The number of Cambria Stream nodes to create."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"manager_instance_type"})}),(0,i.jsx)(n.td,{children:"The instance type of the Cambria Cluster nodes. See Akamai documentation for information on how to get the instance type name."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ftc_instance_type"})}),(0,i.jsx)(n.td,{children:"The instance type of the Cambria FTC nodes. See Akamai documentation for information on how to get the instance type name."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"max_ftc_instances"})}),(0,i.jsx)(n.td,{children:"The maximum number of encoders that the Kubernetes cluster can have up and running."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cambria_cluster_replicas"})}),(0,i.jsxs)(n.td,{children:["The maximum number of Cambria management + replica machines to have up and running. This should match the ",(0,i.jsx)(n.code,{children:"lke_manager_pool_node_count"})," or be greater if more manager replicas will be needed after installation."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"host_name"}),", ",(0,i.jsx)(n.code,{children:"acme_registration_email"}),", ",(0,i.jsx)(n.code,{children:"acme_server"})]}),(0,i.jsx)(n.td,{children:"One way to expose the main Cambria applications is to use an ingress. This information is needed to connect a real domain and TLS certificate to the ingress. The default values are only usable under a test environment."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_storage_type"})}),(0,i.jsxs)(n.td,{children:["Decide what type of storage to use for Loki logs. Recommended to use an S3 compatible storage like AWS S3. For testing purposes only, there is a filesystem version (set this to ",(0,i.jsx)(n.code,{children:"local"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_local_storage_size_gi"})}),(0,i.jsxs)(n.td,{children:["Used only for the local ",(0,i.jsx)(n.code,{children:"loki_storage_type"}),". This is how many GB the Loki log volume should be.  Volumes can fill up quickly so testing different sizes may be required."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_s3_bucket_name"})}),(0,i.jsxs)(n.td,{children:["Used when ",(0,i.jsx)(n.code,{children:"loki_storage_type = s3_embedcred"}),". This option should be changed if using the s3_embedcred loki_storage_type. This is the name of the S3 compatible bucket to write logs to"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_s3_region"})}),(0,i.jsx)(n.td,{children:"This option should be changed if using the s3_embedcred loki_storage_type. This is the region where the S3 bucket is located"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_log_retention_period"})}),(0,i.jsx)(n.td,{children:"Number of days to retain Loki logs in the storage device. Default is 7 days."})]})]})]}),"\n",(0,i.jsxs)(n.ol,{start:"8",children:["\n",(0,i.jsxs)(n.li,{children:["Once done, click on ",(0,i.jsx)(n.strong,{children:"Save Changes"})," and wait for the message ",(0,i.jsx)(n.strong,{children:"Changes were saved"})," to appear."]}),"\n",(0,i.jsx)(n.li,{children:"Close the Terraform UI Editor window."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"32-optional-cambria-ftc-optional-values",children:"3.2. (Optional) Cambria FTC Optional Values"}),"\n",(0,i.jsxs)(n.p,{children:["Skip this step if the optional values don't need to be modified. Review the list of values in the chart below to help determine if any of the features need to be modified, such as ",(0,i.jsx)(n.strong,{children:"NVENC (GPU)"}),", ",(0,i.jsx)(n.strong,{children:"Ingress"}),", etc."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Run the Terraform editor UI:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/TerraformVariableEditor\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Click on ",(0,i.jsx)(n.strong,{children:"Open Terraform File"})," and choose the ",(0,i.jsx)(n.code,{children:"CambriaClusterValues_OPTIONAL_VALUES.tf"})," file. Using the UI, edit the fields accordingly. Reference the following table for values that should be changed:"]}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Terraform UI Editor Field"}),(0,i.jsx)(n.th,{children:"Explanation"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"workersUseGPU"})," [ BETA ]"]}),(0,i.jsx)(n.td,{children:"This must be set to true if planning to use NVENC capabilities on the encoding machines. This is set to false by default."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"nbGPUs"})}),(0,i.jsx)(n.td,{children:"The max number of GPUs to use from the encoding machines if GPU functionality is enabled. This value should not exceed the amount of GPUs available."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"workersUseVPU"})," [ BETA ]"]}),(0,i.jsx)(n.td,{children:"This must be set to true if planning to use netint VPU capabilities on the encoding machines. This is set to false by default."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"nbVPUs"})}),(0,i.jsx)(n.td,{children:"The max number of VPUs to use from the encoding machines if VPU functionality is enabled. This value should not exceed the amount of VPUs available."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ftc_enable_auto_scaler"})}),(0,i.jsx)(n.td,{children:"This is used to enable / disable the FTC autoscaler which controls auto deployment of Cambria FTC encoders to handle encoding tasks dynamically. By default this is enabled (true)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ftc_enable_scriptable_workflow"})}),(0,i.jsx)(n.td,{children:"This is used to enable / disable the FTC scriptable workflow feature. By default, this is disabled."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"enable_manager_webui"})}),(0,i.jsx)(n.td,{children:"If enabled, this allows users to use Cambria Clusterr's Web UI. Otherwise, only the REST API server can be used to interact with Cambria Cluster."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"storage_class_name"})}),(0,i.jsx)(n.td,{children:"The name of the storage class to use for volumes in the Kubernetes cluster."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ftc_encoding_slots"})}),(0,i.jsx)(n.td,{children:"When a Cambria FTC worker node is connected to Cambria Cluster, this is the max number of encoding jobs it can run concurrently by default."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"expose_capella_service_externally"})}),(0,i.jsx)(n.td,{children:"This option tells the deployment to create load balancers to publicly expose the Capella application."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"enable_ingress"})}),(0,i.jsx)(n.td,{children:"This option tells the deployment to create an ingress for the Capella applications that should be exposed."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ftc_license_mode"})}),(0,i.jsx)(n.td,{children:"The license mode for Cambria Cluster and FTC instances. Do not change this value unless instructed by Capella."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"enable_eventing"})}),(0,i.jsx)(n.td,{children:"This enables / disables the argo-events event-based system. By default, this is enabled (true)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"kubernetes_version"})}),(0,i.jsx)(n.td,{children:"The Kubernetes version number to use. Do not change this value unless instructed by Capella."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"install_monitoring"})}),(0,i.jsx)(n.td,{children:"This controls whether monitoring features (prometheus, grafana) should be installed. Do not change this value unless instructed by Capella."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"install_loki"})}),(0,i.jsx)(n.td,{children:"This controls whether the Loki logs feature should be installed. Do not change this value unless instructed by Capella."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"expose_grafana"})}),(0,i.jsx)(n.td,{children:"This option tells the deployment to make the Grafana dashboard accessible publicly via a load balancer"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_replicas "})}),(0,i.jsx)(n.td,{children:"This option should only be changed if using the s3_embedcred loki_storage_type. This is the number of Loki pod replicas to use for handling log requests. At least 2 replicas need to be active for Loki to work properly. Also, there should be at least the same amount of nodes running to cover the number of replicas specified here."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"loki_max_unavailable"})}),(0,i.jsx)(n.td,{children:"This option should only be changed if using the s3_embedcred loki_storage_type. This is how many Loki pods can be taken down when performing upgrades. For simplicity, this value should be loki_replicas + 1"})]})]})]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["Once done, click on ",(0,i.jsx)(n.strong,{children:"Save Changes"})," and close the UI."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"33-deploy-kubernetes-cluster",children:"3.3. Deploy Kubernetes Cluster"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Save the configured values to a ",(0,i.jsx)(n.code,{children:".tfvars"})," file (change ",(0,i.jsx)(n.strong,{children:"my-values"})," to desired name):"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'terraform-docs tfvars hcl . --description --sort=false --output-file=./my-values.tfvars --output-mode=replace --output-template="{{ .Content }}"\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Create a Terraform plan. Follow the prompts on the terminal window:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"terraform init && terraform plan -var-file=./my-values.tfvars\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Create the Kubernetes cluster:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"terraform apply -auto-approve -var-file=./my-values.tfvars\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["Set the ",(0,i.jsx)(n.code,{children:"KUBECONFIG"})," environment variable:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export KUBECONFIG=kubeconfig.yaml\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsxs)(n.li,{children:["If deployment completes successfully, ",(0,i.jsx)(n.strong,{children:"store"})," the following files in a private location:"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"terraform.tfstate"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"my-values.tfvars"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These files are needed to make any changes to the created Kubernetes cluster."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-verification-and-testing",children:"4. Verification and Testing"}),"\n",(0,i.jsxs)(n.p,{children:["Follow the steps in ",(0,i.jsx)(n.strong,{children:"section 5. Verify Cambria FTC / Cluster Installation"})," of the main ",(0,i.jsx)(n.em,{children:"Cambria Cluster Kubernetes Installation Guide"})," for verification and ",(0,i.jsx)(n.strong,{children:"section 6. Testing Cambria FTC / Cluster"})," for testing with Cambria FTC jobs:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/jmndc09hsb308uzfv5yzd/Cambria_Cluster_and_FTC_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=0yx9di8w6k8r79g28mu8quza7&st=azkbabl8&dl=0",children:"https://www.dropbox.com/scl/fi/jmndc09hsb308uzfv5yzd/Cambria_Cluster_and_FTC_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=0yx9di8w6k8r79g28mu8quza7&st=azkbabl8&dl=0"})}),"\n",(0,i.jsx)(n.h3,{id:"41-cambria-cluster--ftc-info",children:"4.1. Cambria Cluster / FTC Info"}),"\n",(0,i.jsxs)(n.p,{children:["Run the following script to get important information such as ",(0,i.jsx)(n.strong,{children:"Cambria Cluster WebUI URL"}),", ",(0,i.jsx)(n.strong,{children:"REST API URL"}),", etc."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/getFtcInfo.sh\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-upgrading",children:"5. Upgrading"}),"\n",(0,i.jsx)(n.p,{children:"This is the default way to perform an upgrade for anything from updating license keys, Cambria version, etc."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important"}),(0,i.jsx)(n.br,{}),"\n","In cases where the Cambria installation / upgrade isn't working and is in an unrecoverable state, run steps ",(0,i.jsx)(n.strong,{children:"1\u20137"})," of this section and then run this command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall capella-cluster --wait\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"WARNING:"})," THIS COMMAND WILL DELETE THE CAMBRIA DATABASE. PLEASE SAVE ANY PROJECT FILES, CONFIG FILES, CREDENTIALS, ETC BEFORE RUNNING IT."]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Review ",(0,i.jsx)(n.strong,{children:"section 1. Prerequisites"})," to verify they have been met."]}),"\n",(0,i.jsxs)(n.li,{children:["Verify that you have a ",(0,i.jsx)(n.strong,{children:"Linux deployment server"}),". To create a new Linux deployment server or verify that the deployment server tools are installed, run the steps in ",(0,i.jsx)(n.strong,{children:"1.2. Prepare Deployment Server"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Download / Paste your ",(0,i.jsx)(n.code,{children:".tfvars"})," and ",(0,i.jsx)(n.code,{children:".tfstate"})," files that were used for the Kubernetes cluster deployment into the Linux deployment server."]}),"\n",(0,i.jsxs)(n.li,{children:["Follow the steps in ",(0,i.jsx)(n.strong,{children:"section 2. Cambria FTC Package"})," to download the new Cambria FTC package."]}),"\n",(0,i.jsxs)(n.li,{children:["Update the Cambria FTC package with the values from the ",(0,i.jsx)(n.code,{children:".tfvars"})," file (replace ",(0,i.jsx)(n.code,{children:"my-values.tfvars"})," with your file):","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/updateTfValuesFromTfvars.sh my-values.tfvars\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Follow the steps in ",(0,i.jsx)(n.strong,{children:"3.1. Configure the Kubernetes Cluster"})," and ",(0,i.jsx)(n.strong,{children:"3.2. (Optional) Cambria FTC Optional Values"})," to configure new values / update previous values."]}),"\n",(0,i.jsxs)(n.li,{children:["Set the kubeconfig environment variable for the Kubernetes API and Terraform:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export KUBECONFIG=kubeconfig.yaml && export KUBE_CONFIG_PATH=kubeconfig.yaml\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Make sure all ",(0,i.jsx)(n.code,{children:"cambriacluster"})," and ",(0,i.jsx)(n.code,{children:"pgcluster"})," pods are attached to a node. Check that all pods are in a running state:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -n default && kubectl get pods -n capella-database\n"})}),"\n","If any pod in this list is in a ",(0,i.jsx)(n.strong,{children:"pending"})," state, see ",(0,i.jsx)(n.strong,{children:"section 3.1"})," and make sure the number of manager nodes created equals the amount of ",(0,i.jsx)(n.code,{children:"cambriastreammanager-xyz"})," pods you see in this list."]}),"\n",(0,i.jsxs)(n.li,{children:["Run the Terraform install instructions from ",(0,i.jsx)(n.strong,{children:"section 3.3. Deploy Kubernetes Cluster"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"(Skip if you ran the \u201cImportant\u201d steps above.)"})," Run this command to restart the manager deployments:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl rollout restart deployment cambriaclusterwebui cambriaclusterapp -n default\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"(Skip if you ran the \u201cImportant\u201d steps above.)"})," Restart the worker deployment:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl rollout restart deployment cambriaftcapp -n capella-worker\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-cleanup--delete",children:"6. Cleanup / Delete"}),"\n",(0,i.jsx)(n.p,{children:"Many resources are created in a Kubernetes environment. It is important that each step is followed carefully."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Verify that you have a ",(0,i.jsx)(n.strong,{children:"Linux deployment server"}),". To create a new Linux deployment server or verify that the deployment server tools are installed, run the steps in ",(0,i.jsx)(n.strong,{children:"1.2. Prepare Deployment Server"})," and also in ",(0,i.jsx)(n.strong,{children:"2. Cambria Stream Package"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Download / Paste your ",(0,i.jsx)(n.code,{children:".tfvars"})," and ",(0,i.jsx)(n.code,{children:".tfstate"})," files that were used for the Kubernetes cluster deployment into the Linux deployment server."]}),"\n",(0,i.jsxs)(n.li,{children:["Download / Paste the ",(0,i.jsx)(n.code,{children:"kubeconfig.yaml"})," file of your Kubernetes cluster into the Linux deployment server."]}),"\n",(0,i.jsxs)(n.li,{children:["Linux deployment server, run the following command to update the Cambria Stream package with the values from the ",(0,i.jsx)(n.code,{children:".tfvars"})," file (replace ",(0,i.jsx)(n.code,{children:"my-values.tfvars"})," with your file):","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/updateTfValuesFromTfvars.sh my-values.tfvars\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Run the following command to destroy the Kubernetes cluster:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"terraform init && terraform apply -destroy -auto-approve -var-file=./my-values.tfvars\n"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);