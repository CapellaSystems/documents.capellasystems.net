"use strict";(self.webpackChunkcapella_documentation=self.webpackChunkcapella_documentation||[]).push([[1605],{5198:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Kubernetes/cambria-cluster-ftc-5-6-akamai-kubernetes","title":"Akamai Cloud Kubernetes","description":"Document History","source":"@site/docs/Cambria_FTC/01-Installation Guides/01-Kubernetes/02-Akamai/Akamai-Kubernetes/index.md","sourceDirName":"Cambria_FTC/01-Installation Guides/01-Kubernetes/02-Akamai/Akamai-Kubernetes","slug":"/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Kubernetes/","permalink":"/docs/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Kubernetes/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"cambria-cluster-ftc-5-6-akamai-kubernetes","title":"Akamai Cloud Kubernetes"},"sidebar":"FTCSidebar","previous":{"title":"Cambria Cluster / FTC 5.5.0 - AWS Kubernetes","permalink":"/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/"},"next":{"title":"Terraform on Akamai Kubernetes","permalink":"/docs/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Terraform-Kubernetes/Cambria_Cluster_Terraform_Akamai_Kubernetes"}}');var i=s(4848),t=s(8453);const a={id:"cambria-cluster-ftc-5-6-akamai-kubernetes",title:"Akamai Cloud Kubernetes"},l="Cambria Cluster / FTC 5.6.0 \u2014 Akamai Cloud Kubernetes Help Documentation",o={},d=[{value:"Document History",id:"document-history",level:2},{value:"Limitations and Security Information",id:"limitations-and-security-information",level:3},{value:"\u26a0\ufe0f Critical Information: Read Before Proceeding with Installation",id:"\ufe0f-critical-information-read-before-proceeding-with-installation",level:2},{value:"Document Overview",id:"document-overview",level:2},{value:"1. Overview",id:"1-overview",level:2},{value:"1.1. Cambria Cluster / FTC Kubernetes Deployment",id:"11-cambria-cluster--ftc-kubernetes-deployment",level:3},{value:"Cambria FTC:",id:"cambria-ftc",level:3},{value:"1.2. Resource Usage",id:"12-resource-usage",level:3},{value:"1.3. Akamai Cloud Machine Information and Benchmark",id:"13-akamai-cloud-machine-information-and-benchmark",level:3},{value:"Benchmark Job Information",id:"benchmark-job-information",level:4},{value:"a. g6-dedicated-16 [ AMD EPYC 7713 ]",id:"a-g6-dedicated-16--amd-epyc-7713-",level:2},{value:"Machine Info",id:"machine-info",level:3},{value:"Benchmark Results",id:"benchmark-results",level:3},{value:"b. g6-dedicated-56 [ AMD EPYC 7713 ]",id:"b-g6-dedicated-56--amd-epyc-7713-",level:2},{value:"Machine Info",id:"machine-info-1",level:3},{value:"Benchmark Results",id:"benchmark-results-1",level:3},{value:"Benchmark Findings",id:"benchmark-findings",level:3},{value:"1.4. Cambria Application Access",id:"14-cambria-application-access",level:3},{value:"1.4.1. External Access via TCP Load Balancer",id:"141-external-access-via-tcp-load-balancer",level:4},{value:"1.4.2. HTTP Ingress via Reverse Proxy",id:"142-http-ingress-via-reverse-proxy",level:3},{value:"1.5. Firewall Information",id:"15-firewall-information",level:3},{value:"1.6. Specifications for Linux Deployment Server",id:"16-specifications-for-linux-deployment-server",level:3},{value:"2. Prerequisites",id:"2-prerequisites",level:2},{value:"2.1. Linux Tools",id:"21-linux-tools",level:3},{value:"2.2.1. Kubernetes Tools: kubectl, helm, linode\u2011cli",id:"221-kubernetes-tools-kubectl-helm-linodecli",level:4},{value:"2.2.2. Verification",id:"222-verification",level:4},{value:"3. Create Kubernetes Cluster (Akamai LKE)",id:"3-create-kubernetes-cluster-akamai-lke",level:2},{value:"3.1. Create LKE Cluster and Cambria Cluster Node Group",id:"31-create-lke-cluster-and-cambria-cluster-node-group",level:3},{value:"3.1.1. Cambria Cluster Nodegroup (Managers)",id:"311-cambria-cluster-nodegroup-managers",level:4},{value:"Information / Recommendation",id:"information--recommendation",level:4},{value:"3.1.2. Create Cambria FTC Node Group(s) (Workers)",id:"312-create-cambria-ftc-node-groups-workers",level:4},{value:"Information / Recommendation",id:"information--recommendation-1",level:4},{value:"3.1.3. Deploy the Kubernetes Cluster",id:"313-deploy-the-kubernetes-cluster",level:4},{value:"3.2. [BETA] GPU Operator for NVENC (optional)",id:"32-beta-gpu-operator-for-nvenc-optional",level:3},{value:"3.3. Application Ingress: ingress\u2011nginx",id:"33-application-ingress-ingressnginx",level:3},{value:"3.4. Performance Metrics and Logging",id:"34-performance-metrics-and-logging",level:3},{value:"4. Install Cambria Cluster, FTC, and Dependencies",id:"4-install-cambria-cluster-ftc-and-dependencies",level:2},{value:"4.1. Prerequisite: Deploy External Kubernetes Tools",id:"41-prerequisite-deploy-external-kubernetes-tools",level:3},{value:"4.2. Creating and Editing Helm Configuration File",id:"42-creating-and-editing-helm-configuration-file",level:3},{value:"4.3. Installing Cambria FTC / Cluster",id:"43-installing-cambria-ftc--cluster",level:3},{value:"5. Verify Cambria FTC / Cluster Installation",id:"5-verify-cambria-ftc--cluster-installation",level:2},{value:"5.1. Verify Cambria Cluster Deployment",id:"51-verify-cambria-cluster-deployment",level:3},{value:"5.2. Verify Cambria FTC Deployment",id:"52-verify-cambria-ftc-deployment",level:3},{value:"5.3. Verify Applications are Accessible",id:"53-verify-applications-are-accessible",level:3},{value:"5.3.1. Cambria Cluster WebUI",id:"531-cambria-cluster-webui",level:4},{value:"5.3.2. Cambria Cluster REST API",id:"532-cambria-cluster-rest-api",level:4},{value:"5.3.3. Cambria License WebUI",id:"533-cambria-license-webui",level:4},{value:"5.3.4. Cambria Ingress",id:"534-cambria-ingress",level:4},{value:"5.3.4.1. Get the Ingress Endpoints",id:"5341-get-the-ingress-endpoints",level:5},{value:"5.3.4.2. Test Ingress Endpoints",id:"5342-test-ingress-endpoints",level:5},{value:"6. Testing Cambria FTC / Cluster",id:"6-testing-cambria-ftc--cluster",level:2},{value:"7. Updating / Upgrading Cambria Cluster / FTC",id:"7-updating--upgrading-cambria-cluster--ftc",level:2},{value:"7.1. Option 1 \u2014 Normal Upgrade (Helm Upgrade)",id:"71-option-1--normal-upgrade-helm-upgrade",level:3},{value:"7.2. Option 2 \u2014 Reinstall (Deletes DB and Jobs)",id:"72-option-2--reinstall-deletes-db-and-jobs",level:3},{value:"7.3. Upgrade Verification",id:"73-upgrade-verification",level:3},{value:"8. Deleting Kubernetes Cluster",id:"8-deleting-kubernetes-cluster",level:2},{value:"9. Quick Reference: Installation, Testing, and Teardown",id:"9-quick-reference-installation-testing-and-teardown",level:2},{value:"9.1. Installation (Terraform quick path)",id:"91-installation-terraform-quick-path",level:3},{value:"9.2. Upgrades and Teardown",id:"92-upgrades-and-teardown",level:3},{value:"10. Quick Reference: Helpful Commands / Info (Post\u2011Install)",id:"10-quick-reference-helpful-commands--info-postinstall",level:2},{value:"11. Glossary (selected)",id:"11-glossary-selected",level:2},{value:"11.1. Kubernetes",id:"111-kubernetes",level:3},{value:"11.2. Third\u2011Party Tools",id:"112-thirdparty-tools",level:3},{value:"11.3. Capella Applications",id:"113-capella-applications",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"cambria-cluster--ftc-560--akamai-cloud-kubernetes-help-documentation",children:"Cambria Cluster / FTC 5.6.0 \u2014 Akamai Cloud Kubernetes Help Documentation"})}),"\n",(0,i.jsx)(n.h2,{id:"document-history",children:"Document History"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Version"}),(0,i.jsx)(n.th,{children:"Date"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5.5.0"}),(0,i.jsx)(n.td,{children:"04/11/2025"}),(0,i.jsx)(n.td,{children:"Updated for release 5.5.0.23529 (Linux)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5.6.0"}),(0,i.jsx)(n.td,{children:"10/31/2025"}),(0,i.jsx)(n.td,{children:"Updated for release 5.6.0.26533 (Linux)"})]})]})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Download the online version of this document for the latest information and latest files. Always download the latest files."})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Do not move forward with the installation process if you do not agree with the End User License Agreement (EULA) for our products. You can download and read the EULA for Cambria FTC, Cambria Cluster, and Cambria License Manager from the links below:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cambria Cluster"})," \u2014 ",(0,i.jsx)("a",{href:"https://www.dropbox.com/s/oemlax63aatjjiw/EULA_Cluster.pdf?dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/s/oemlax63aatjjiw/EULA_Cluster.pdf?dl=0",children:"https://www.dropbox.com/s/oemlax63aatjjiw/EULA_Cluster.pdf?dl=0"})})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cambria FTC"})," \u2014 ",(0,i.jsx)("a",{href:"https://www.dropbox.com/s/ualv9usxsowh6m2/EULA_FTC.pdf?dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/s/ualv9usxsowh6m2/EULA_FTC.pdf?dl=0",children:"https://www.dropbox.com/s/ualv9usxsowh6m2/EULA_FTC.pdf?dl=0"})})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cambria License Manager"})," \u2014 ",(0,i.jsx)("a",{href:"https://www.dropbox.com/s/1wg7ee7a59kzi8h/EULA_Cambria_License_Manager.pdf?dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/s/1wg7ee7a59kzi8h/EULA_Cambria_License_Manager.pdf?dl=0",children:"https://www.dropbox.com/s/1wg7ee7a59kzi8h/EULA_Cambria_License_Manager.pdf?dl=0"})})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"limitations-and-security-information",children:"Limitations and Security Information"}),"\n",(0,i.jsxs)(n.p,{children:["Cambria FTC, Cluster, and License Manager are installed on Linux Docker containers. Limitations and security checks for this version are included in the Linux document below (",(0,i.jsx)(n.strong,{children:"informational only"}),"; Kubernetes setup starts in ",(0,i.jsx)(n.strong,{children:"3. Create Kubernetes Cluster"}),")."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cambria FTC / Cluster (sections 8 and 9):"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)("a",{href:"https://www.dropbox.com/scl/fi/rvf02h8tajsxrfbhpgmzy/Linux_Cambria_FTC_5_6_0_Guide.pdf?rlkey=gtqeowx2b9gartth8s6dwo95j&st=4wpy1dfi&dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/rvf02h8tajsxrfbhpgmzy/Linux_Cambria_FTC_5_6_0_Guide.pdf?rlkey=gtqeowx2b9gartth8s6dwo95j&st=4wpy1dfi&dl=0",children:"https://www.dropbox.com/scl/fi/rvf02h8tajsxrfbhpgmzy/Linux_Cambria_FTC_5_6_0_Guide.pdf?rlkey=gtqeowx2b9gartth8s6dwo95j&st=4wpy1dfi&dl=0"})})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["**Important: Before You Begin\nPDF documents have a copy/paste issue. For best results, download this document and any referenced PDF documents in this guide and open them in a PDF viewer such as Adobe Acrobat.",(0,i.jsx)(n.br,{}),"\n","For commands that are in more than one line, copy each line one by one and check that the copied command matches the one in the document."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"When copying commands:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If a command spans multiple lines, ",(0,i.jsx)(n.strong,{children:"copy each line individually"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["After copying, ",(0,i.jsx)(n.strong,{children:"verify that the pasted command matches the text shown in the document"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Information:"})," This document references ",(0,i.jsx)(n.strong,{children:"Kubernetes 1.34"})," only."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-critical-information-read-before-proceeding-with-installation",children:"\u26a0\ufe0f Critical Information: Read Before Proceeding with Installation"}),"\n",(0,i.jsx)(n.p,{children:"Before starting the installation, carefully review the following considerations. Skipping this section\nmay result in errors, failed deployments, or misconfigurations."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"A New Kubernetes Cluster Will Be Deployed"}),(0,i.jsx)(n.br,{}),"\n","\u25cf The installation process creates a brand-new Kubernetes cluster to keep the Cambria ecosystem\nisolated from other applications."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Default Installation is Non-Secure"}),(0,i.jsx)(n.br,{}),"\n","\u25cf The guide covers installation with default settings in an open environment (not secure).",(0,i.jsx)(n.br,{}),"\n","\u25cf If you require a secure or customized setup, you will need Akamai Cloud expertise, which is not\ncovered in this guide.",(0,i.jsx)(n.br,{}),"\n","\u25cf Firewall information is provided in section 1.5. Firewall Information"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Understand Your Transcoding Requirements"}),(0,i.jsx)(n.br,{}),"\n","\u25cf Know your expected transcoding volume, input/output specs, and whether a GPU is needed.",(0,i.jsx)(n.br,{}),"\n","\u25cf Refer to section 1.3. Akamai Cloud Machine Information and Benchmark for guidelines on machine\nrequirements."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Administrative Rights Required"}),(0,i.jsx)(n.br,{}),"\n","\u25cf Many of the steps in this guide require administrative rights to Akamai Cloud for adding permissions and\nperforming other administrative functions of that sort."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Check Akamai Cloud Account Quota"}),(0,i.jsx)(n.br,{}),"\n","\u25cf Ensure the Akamai Cloud account has sufficient quota to deploy Kubernetes resources.",(0,i.jsx)(n.br,{}),"\n","\u25cf See section 1.2. Resource Usage for estimated resource requirements."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"A Separate Linux Machine is Required"}),(0,i.jsx)(n.br,{}),"\n","\u25cf A dedicated Linux machine (preferably Ubuntu on an Akamai Cloud Linode machine) is needed to\ndeploy Kubernetes.",(0,i.jsx)(n.br,{}),"\n","\u25cf Keeping Kubernetes tools and configuration files on a dedicated system is strongly recommended."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify Region-Specific Resource Availability"}),(0,i.jsx)(n.br,{}),"\n","\u25cf Not all Akamai Cloud regions support the same resources (e.g., GPU availability varies by region).",(0,i.jsx)(n.br,{}),"\n","\u25cf Consult Akamai Cloud documentation to confirm available resources in your desired region."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"document-overview",children:"Document Overview"}),"\n",(0,i.jsx)(n.p,{children:"The purpose of this document is to provide a walkthrough of the installation and initial testing process of the Cambria Cluster and Cambria FTC applications in the Kubernetes environment. The basic view of the document is the following:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Overview of the Cambria Cluster / FTC Environment in a Kubernetes Environment"}),"\n",(0,i.jsx)(n.li,{children:"Preparation for the installation (Prerequisites)"}),"\n",(0,i.jsx)(n.li,{children:"Create and configure the Kubernetes Cluster"}),"\n",(0,i.jsx)(n.li,{children:"Install Cambria Cluster and Cambria FTC on the Kubernetes Cluster"}),"\n",(0,i.jsx)(n.li,{children:"Verify the installation is working properly"}),"\n",(0,i.jsx)(n.li,{children:"Test the Cambria Cluster / FTC applications"}),"\n",(0,i.jsx)(n.li,{children:"Update the Cambria Cluster / FTC applications on Kubernetes Cluster"}),"\n",(0,i.jsx)(n.li,{children:"Delete a Kubernetes Cluster"}),"\n",(0,i.jsx)(n.li,{children:"Quick Reference of Kubernetes Installation"}),"\n",(0,i.jsx)(n.li,{children:"Quick Reference of Important Kubernetes Components (URLs, template projects, test player, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Glossary of important terms"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,i.jsx)(n.h3,{id:"11-cambria-cluster--ftc-kubernetes-deployment",children:"1.1. Cambria Cluster / FTC Kubernetes Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["There are two major applications involved in this installation: ",(0,i.jsx)(n.strong,{children:"Cambria Cluster"})," and ",(0,i.jsx)(n.strong,{children:"Cambria FTC"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cambria Cluster"})," This deployment is recommended to run on at least 3 nodes (replica = 3) with a service (Load Balancer) that exposes the application externally. For each of these nodes, Cambria Cluster will be installed on its own pod and designated to its own node. One node acts as the leader and the other two are replicas for the purpose of replacing the leader in the case it becomes inactive, corrupted, etc. Each Cambria Cluster pod has three containers::"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cambria Cluster"})," (application)"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Leader Elector"})," \u2014 that chooses which of the Cambria Cluster node / pod will be the leader"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cambria FTC Autoscaler"})," \u2014 that when the FTC autoscaler is enabled, it will automatically deploy worker nodes for encoding purposes based on the number of encoding jobs queued to the system. This is based on the calculation (rounded down):"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Number of Nodes to Deploy = (Number of Queued Jobs + 2) / 3"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Also for the Cluster deployment, there is a corresponding PostgreSQL database installed on a separate pod for each active Cambria Cluster pod. The data is replicated between the different database pods in order to preserve data in case of issues with the database and/or Cluster."}),"\n",(0,i.jsx)(n.h3,{id:"cambria-ftc",children:"Cambria FTC:"}),"\n",(0,i.jsx)(n.p,{children:"Capella\u2019s Cambria FTC deployment consists of one or more nodes that (by default) are of different instance\ntypes than the Cambria Cluster nodes. These nodes focus specifically on running encoding tasks. Similar to\nCambria Cluster, the Cambria FTC application is installed on its own pod and designated to its own node. Each\nCambria FTC pod has three containers:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Cambria FTC (application)"}),"\n",(0,i.jsx)(n.li,{children:"Auto-Connect FTC dotnet tool that does the following: 1. list pods, 2. attempts to find Cambria\nCluster, and 3. connects the Cambria FTC application running in the pod to the Cambria Cluster that it\nfound. This container also deletes its own node pool or recycles its node if no Cambria Cluster is found\nwithin a specific time (~20 minutes)"}),"\n",(0,i.jsx)(n.li,{children:"Pgcluster database for storing its encoder's own job contents and other such information for as long\nas the pod is running."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Each node in the Kubernetes Cluster will either be running the Cluster deployment or the FTC deployment."}),"\n",(0,i.jsx)(n.h3,{id:"12-resource-usage",children:"1.2. Resource Usage"}),"\n",(0,i.jsx)(n.p,{children:"The resources used and their quantities will vary depending on requirements and different\nenvironments. Below is general information about some of the major resource usage (other resources may be\nused. Consult Akamai Cloud documentation for other resources created, usage limits, etc):"}),"\n",(0,i.jsxs)(n.p,{children:["Akamai Cloud Documentation:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://techdocs.akamai.com/cloud-computing/docs/getting-started-with-lke-linode-kubernetes-engine",children:"https://techdocs.akamai.com/cloud-computing/docs/getting-started-with-lke-linode-kubernetes-engine"})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Resource"}),(0,i.jsx)(n.th,{children:"Details"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"NodeBalancers"}),(0,i.jsxs)(n.td,{children:["0\u20133 NodeBalancers (Manager WebUI, Manager Web Server, Grafana)",(0,i.jsx)("br",{}),"0\u20131 NodeBalancer (Ingress)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Nodes"}),(0,i.jsxs)(n.td,{children:["X Cambria Manager Instances (Default is 3)",(0,i.jsx)("br",{}),"Y Cambria FTC Instances (Depends on max FTC instance configuration; Default is 20)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Networking"}),(0,i.jsx)(n.td,{children:"No VPCs are created"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Security"}),(0,i.jsx)(n.td,{children:"By default, no firewalls are created. However, Firewalls can be applied to the LKE cluster nodes for stricter security"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"13-akamai-cloud-machine-information-and-benchmark",children:"1.3. Akamai Cloud Machine Information and Benchmark"}),"\n",(0,i.jsxs)(n.p,{children:["The following is a benchmark of two Akamai Cloud machines. The information below is as of October 2025.",(0,i.jsx)(n.br,{}),"\n","Note that the benchmark involves read from / write to Akamai ObjectStorage which influences the real-time speed of\ntranscoding jobs."]}),"\n",(0,i.jsx)(n.h4,{id:"benchmark-job-information",children:"Benchmark Job Information"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Container"}),(0,i.jsx)(n.th,{children:"Codec"}),(0,i.jsx)(n.th,{children:"Frame Rate"}),(0,i.jsx)(n.th,{children:"Resolution"}),(0,i.jsx)(n.th,{children:"Bitrate"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Source"}),(0,i.jsx)(n.td,{children:"TS H.264"}),(0,i.jsx)(n.td,{children:"30"}),(0,i.jsx)(n.td,{children:"1920 x 1080"}),(0,i.jsx)(n.td,{children:"8 Mbps"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Output"}),(0,i.jsx)(n.td,{children:"HLS/TS H.264"}),(0,i.jsx)(n.td,{children:"29.97"}),(0,i.jsxs)(n.td,{children:["1920 x 1080 @ 4Mbps",(0,i.jsx)("br",{}),"1280 x 720 @ 2.4Mbps",(0,i.jsx)("br",{}),"640 x 480 @ 0.8Mbps",(0,i.jsx)("br",{}),"320 x 240 @ 0.3Mbps"]}),(0,i.jsx)(n.td,{children:"\u2014"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"a-g6-dedicated-16--amd-epyc-7713-",children:"a. g6-dedicated-16 [ AMD EPYC 7713 ]"}),"\n",(0,i.jsx)(n.h3,{id:"machine-info",children:"Machine Info"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"RAM"}),(0,i.jsx)(n.th,{children:"CPUs"}),(0,i.jsx)(n.th,{children:"Storage"}),(0,i.jsx)(n.th,{children:"Transfer"}),(0,i.jsx)(n.th,{children:"Network In/Out"}),(0,i.jsx)(n.th,{children:"Cost per Hour"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dedicated 32 GB"}),(0,i.jsx)(n.td,{children:"32 GB"}),(0,i.jsx)(n.td,{children:"16"}),(0,i.jsx)(n.td,{children:"640 GB"}),(0,i.jsx)(n.td,{children:"7 TB"}),(0,i.jsx)(n.td,{children:"40 Gbps / 7 Gbps"}),(0,i.jsx)(n.td,{children:"$0.432 (As of 10/15/2025)"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"benchmark-results",children:"Benchmark Results"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"# of Concurrent Jobs:"})," 2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Real Time Speed:"})," For each job: 0.65x RT (slower than real-time)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Throughput:"})," 1.30x RT (it takes around 47 seconds to transcode 1 minute of source)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CPU Usage:"})," 100%"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"b-g6-dedicated-56--amd-epyc-7713-",children:"b. g6-dedicated-56 [ AMD EPYC 7713 ]"}),"\n",(0,i.jsx)(n.h3,{id:"machine-info-1",children:"Machine Info"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"RAM"}),(0,i.jsx)(n.th,{children:"CPUs"}),(0,i.jsx)(n.th,{children:"Storage"}),(0,i.jsx)(n.th,{children:"Transfer"}),(0,i.jsx)(n.th,{children:"Network In/Out"}),(0,i.jsx)(n.th,{children:"Cost per Hour"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dedicated 256 GB"}),(0,i.jsx)(n.td,{children:"256 GB"}),(0,i.jsx)(n.td,{children:"56"}),(0,i.jsx)(n.td,{children:"5000 GB"}),(0,i.jsx)(n.td,{children:"11 TB"}),(0,i.jsx)(n.td,{children:"40 Gbps / 11 Gbps"}),(0,i.jsx)(n.td,{children:"$3.456 (As of 05/28/2024)"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"benchmark-results-1",children:"Benchmark Results"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"# of Concurrent Jobs:"})," 2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Real Time Speed:"})," For each job: 1.56x RT (faster than real-time)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Throughput:"})," 3.12x RT (it takes around 20 seconds to transcode 1 minute of source)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CPU Usage:"})," ~90%"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"benchmark-findings",children:"Benchmark Findings"}),"\n",(0,i.jsxs)(n.p,{children:["The results show the g6-dedicated-56 has higher overall throughput. This is expected as the instance has\nmore processing power than the g6-dedicated-16. However, if you take into account the cost per hour for\neach machine, the more cost efficient option is to go with the ",(0,i.jsx)(n.strong,{children:"g6-dedicated-16"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"14-cambria-application-access",children:"1.4. Cambria Application Access"}),"\n",(0,i.jsx)(n.p,{children:"The Cambria applications are accessible via the following methods:"}),"\n",(0,i.jsx)(n.h4,{id:"141-external-access-via-tcp-load-balancer",children:"1.4.1. External Access via TCP Load Balancer"}),"\n",(0,i.jsx)(n.p,{children:"The default Cambria installation configures the Cambria applications to be exposed through load balancers.\nThere is one for the Cambria Manager WebUI + License Manager, and one for the web / REST API server. The\nload balancers are publicly available and can be accessed either through its public ip address or domain name,\nand the application's TCP port."}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsx)(n.p,{children:"Cambria Manager WebUI:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://44.33.212.155:8161",children:"https://44.33.212.155:8161"}),(0,i.jsx)(n.br,{}),"\n","Cambria REST API:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://121.121.121.121:8650/CambriaFC/v1/SystemInfo",children:"https://121.121.121.121:8650/CambriaFC/v1/SystemInfo"})]}),"\n",(0,i.jsxs)(n.p,{children:["External access in this way can be turned on / off via a configuration variable. See ",(0,i.jsx)(n.strong,{children:"4.2. Creating and Editing\nHelm Configuration File"}),". If this feature is disabled, another method of access will need to be configured."]}),"\n",(0,i.jsx)(n.h3,{id:"142-http-ingress-via-reverse-proxy",children:"1.4.2. HTTP Ingress via Reverse Proxy"}),"\n",(0,i.jsx)(n.p,{children:"In cases where the external access via TCP load balancer is not acceptable or for using a purchased domain\nname from servicers such as GoDaddy, the Cambria installation provides the option to expose an ingress."}),"\n",(0,i.jsxs)(n.p,{children:["Similar to the external access load balancers, the Cambria Manager WebUI and web / REST API server are\nexposed. However, only ",(0,i.jsx)(n.strong,{children:"one"})," IP address / domain name is needed in this case."]}),"\n",(0,i.jsxs)(n.p,{children:["How it works is that the Cambria WebUI is exposed through the subdomain ",(0,i.jsx)(n.strong,{children:"webui"}),", the Cambria web server\nthrough the subdomain ",(0,i.jsx)(n.strong,{children:"api"}),", and Grafana dashboard through the subdomain ",(0,i.jsx)(n.strong,{children:"monitoring"}),". The following is an\nexample with the domain ",(0,i.jsx)(n.strong,{children:"mydomain.com"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Cambria Manager WebUI:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://webui.mydomain.com",children:"https://webui.mydomain.com"})]}),"\n",(0,i.jsxs)(n.li,{children:["Cambria REST API:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://api.mydomain.com",children:"https://api.mydomain.com"})]}),"\n",(0,i.jsxs)(n.li,{children:["Grafana Dashboard:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.a,{href:"https://monitoring.mydomain.com",children:"https://monitoring.mydomain.com"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Capella provides a default ingress hostname for testing purposes only. In production, the default hostname, SSL\ncertificate, and other such information needs to be configured. More information about ingress configuration is\nexplained later in this guide."}),"\n",(0,i.jsx)(n.h3,{id:"15-firewall-information",children:"1.5. Firewall Information"}),"\n",(0,i.jsx)(n.p,{children:"By default, this guide creates a kubernetes cluster with default settings which do not include a\nFirewall. For custom / non-default configurations, or to explore with a more restrictive network based on the\ndefault virtual network created, the following is a list of known ports that the Cambria applications use:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Port(s)"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"Protocol"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"Direction"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8650"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Cambria Cluster REST API"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8161"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Cambria Cluster WebUI"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8678"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Cambria License Manager Web Server"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8481"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Cambria License Manager WebUI"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"9100"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Prometheus System Exporter for Cambria Cluster"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"8648"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Cambria FTC REST API"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"3100"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Loki Logging Service"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"3000"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Grafana Dashboard"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"443"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Inbound"}),(0,i.jsx)(n.td,{children:"Capella Ingress"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"ALL"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"TCP/UDP"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Outbound"}),(0,i.jsx)(n.td,{children:"Allow all outbound traffic"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Also, for Cambria licensing, any Cambria Cluster and Cambria FTC machine requires that at least the following\ndomains be exposed in your firewall (both inbound and outbound traffic):"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Domain"}),(0,i.jsx)(n.th,{children:"Port(s)"}),(0,i.jsx)(n.th,{children:"Protocol"}),(0,i.jsx)(n.th,{children:"Traffic"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"api.cryptlex.com"}),(0,i.jsx)(n.td,{children:"443"}),(0,i.jsx)(n.td,{children:"TCP"}),(0,i.jsx)(n.td,{children:"In/Out"}),(0,i.jsx)(n.td,{children:"License Server"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cryptlexapi.capellasystems.net"}),(0,i.jsx)(n.td,{children:"8485"}),(0,i.jsx)(n.td,{children:"TCP"}),(0,i.jsx)(n.td,{children:"In/Out"}),(0,i.jsx)(n.td,{children:"License Cache Server"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cpfs.capellasystems.net"}),(0,i.jsx)(n.td,{children:"8483"}),(0,i.jsx)(n.td,{children:"TCP"}),(0,i.jsx)(n.td,{children:"In/Out"}),(0,i.jsx)(n.td,{children:"License Backup Server"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"16-specifications-for-linux-deployment-server",children:"1.6. Specifications for Linux Deployment Server"}),"\n",(0,i.jsx)(n.p,{children:"In order to deploy Cambria FTC, a Linux Deployment Server is required because this is where all of the tools,\ndependencies, and packages for the Cambria FTC Kubernetes deployment will be installed and/or stored. If you\nalready have a deployment server, you can skip this section."}),"\n",(0,i.jsxs)(n.p,{children:["Important: Linux Deployment Server Machine Information",(0,i.jsx)(n.br,{}),"\n","The instructions in this document perform functions using a root user. To keep things consistent, Capella\nstrongly recommends using Akamai Linode instances for the deployment process."]}),"\n",(0,i.jsx)(n.p,{children:"Capella tests deployment with the Dedicated 4GB (g6-dedicated-2) instance type"}),"\n",(0,i.jsxs)(n.p,{children:["Minimum Requirements:",(0,i.jsx)(n.br,{}),"\n","Operating System (OS) Ubuntu 24.04",(0,i.jsx)(n.br,{}),"\n","CPU(s) 2",(0,i.jsx)(n.br,{}),"\n","RAM 2 GB",(0,i.jsx)(n.br,{}),"\n","Storage 10 GB"]}),"\n",(0,i.jsx)(n.h2,{id:"2-prerequisites",children:"2. Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"The following steps need to be completed before the deployment process."}),"\n",(0,i.jsx)(n.h3,{id:"21-linux-tools",children:"2.1. Linux Tools"}),"\n",(0,i.jsx)(n.p,{children:"This guide uses curl, unzip, and jq to run certain commands and download the required tools and applications.\nTherefore, the Linux server used for deployment will need to have these tools installed."}),"\n",(0,i.jsx)(n.p,{children:"Example with Ubuntu 24.04:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'sudo apt update && \\\nsudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::="--force-confold" -y upgrade && \\\nsudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::="--force-confold" -y install curl unzip jq\n\n### 2.1. Linux Tools\n\nInstall `curl`, `unzip`, and `jq` (Ubuntu 24.04 example):\n\n### 2.2. Cambria FTC Package\n\nThe components of this installation are packaged in a zip archive. Download it using the following command:\n\n```bash\ncurl -o CambriaClusterKubernetesAkamai_5_6_0.zip -L \\\n"https://www.dropbox.com/scl/fi/58x4oeiijhf3au3hnit38/CambriaClusterKubernetesAkamai_5_6_0.zip?rlkey=\\\nuppqqa29s9yresdk2xk7qh7lt&st=s2mus6im&dl=0"\n\nunzip -o CambriaClusterKubernetesAkamai_5_6_0.zip && chmod +x *.sh ./bin/*.sh\n\nImportant: the scripts included have been tested with Ubuntu. They may work with other Linux distributions\nbut not tested\n\n'})}),"\n",(0,i.jsx)(n.h4,{id:"221-kubernetes-tools-kubectl-helm-linodecli",children:"2.2.1. Kubernetes Tools: kubectl, helm, linode\u2011cli"}),"\n",(0,i.jsx)(n.p,{children:"There are 2 options available for installing the kubernetes required tools for deployment to Akamai Cloud:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option 1 (script, verified on Ubuntu):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/installKubeTools.sh && ./bin/installKubeToolsAkamai.sh\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"If successful, use a new terminal window or restart the terminal window where the above steps were run"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option 2 (manual):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["kubectl \u2014 ",(0,i.jsx)("a",{href:"https://kubernetes.io/docs/tasks/tools/",children:(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/tools/",children:"https://kubernetes.io/docs/tasks/tools/"})})]}),"\n",(0,i.jsxs)(n.li,{children:["helm \u2014 ",(0,i.jsx)("a",{href:"https://helm.sh/docs/intro/install/",children:(0,i.jsx)(n.a,{href:"https://helm.sh/docs/intro/install/",children:"https://helm.sh/docs/intro/install/"})})]}),"\n",(0,i.jsxs)(n.li,{children:["linode\u2011cli \u2014 ",(0,i.jsx)("a",{href:"https://techdocs.akamai.com/cloud-computing/docs/install-and-configure-the-cli",children:(0,i.jsx)(n.a,{href:"https://techdocs.akamai.com/cloud-computing/docs/install-and-configure-the-cli",children:"https://techdocs.akamai.com/cloud-computing/docs/install-and-configure-the-cli"})})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"222-verification",children:"2.2.2. Verification"}),"\n",(0,i.jsx)(n.p,{children:"If any of the commands below fail, review the installation instructions for the failing tool and try again:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl version --client && helm version && linode-cli --version\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-create-kubernetes-cluster-akamai-lke",children:"3. Create Kubernetes Cluster (Akamai LKE)"}),"\n",(0,i.jsx)(n.p,{children:"The following section provides the basic steps needed to create a Kubernetes Cluster on Akamai Cloud."}),"\n",(0,i.jsx)(n.h3,{id:"31-create-lke-cluster-and-cambria-cluster-node-group",children:"3.1. Create LKE Cluster and Cambria Cluster Node Group"}),"\n",(0,i.jsx)(n.p,{children:"In the Akamai Cloud Dashboard, go to Kubernetes and Create Cluster and configure as follows:"}),"\n",(0,i.jsxs)(n.p,{children:["|---|---|\n| Cluster Label | e.g., ",(0,i.jsx)(n.code,{children:"cambria-cluster"})," |\n| Cluster Tier | LKE In most cases, this should be LKE |\n| Region | e.g., Your region of operation (Eg. US, Los Angeles, CA (us-lax)) |\n| Kubernetes Version | ",(0,i.jsx)(n.strong,{children:"1.34"})," |\n| Akamai App Platform | No |\n| HA Control Plane | For testing, set to No. For production, it is recommended to set this to Yes (Incurs additional cost. See Akamai documentation) |\n| Control Plane ACL | Only enable this if you already know which IP CIDRs will need access to the LKE control plane. Otherwise, leave as is Only if you know allowed CIDRs |"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Do ",(0,i.jsx)(n.strong,{children:"not"})," create the cluster yet; add nodegroups first."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"311-cambria-cluster-nodegroup-managers",children:"3.1.1. Cambria Cluster Nodegroup (Managers)"}),"\n",(0,i.jsxs)(n.p,{children:["One set of nodes that need to be added are the Cambria Cluster nodes. These are also referred to as the\nManager Nodes. At least one Cambria Cluster node needs to be running at all times in the Kubernetes cluster.",(0,i.jsx)(n.br,{}),"\n","To create these nodes, select the number of nodes to assign to the Cambria Cluster node pool in the Add Node\nPools section"]}),"\n",(0,i.jsx)(n.h4,{id:"information--recommendation",children:"Information / Recommendation"}),"\n",(0,i.jsxs)(n.p,{children:["Cambria Cluster manages scheduling and handling Cambria FTC encoding / packaging programs. Think about\nhow many programs will be intended to run and choose an instance type accordingly. The lowest recommended\nmachine type for the manager machines is ",(0,i.jsx)(n.strong,{children:"Dedicated 8GB"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["It is also recommended to set the node count to ",(0,i.jsx)(n.strong,{children:"3"}),". This is because ",(0,i.jsx)(n.strong,{children:"1 of the nodes will act as the Cambria\nCluster node"})," while the other ",(0,i.jsx)(n.strong,{children:"2 nodes act as backup"})," (web server and database are replicated / duplicated).\nIf the Cambria Cluster node goes down or stops responding, one of the other two nodes will take over as the\nCambria Cluster node. Depending on your workflow(s), think about how many backup nodes may be needed."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Plan:"})," Dedicated 8GB (this is the recommended plan, but can be configured as needed)",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Nodes:"})," 3 (this is the recommended for manager redundancy, but can be configured as needed)"]}),"\n",(0,i.jsx)(n.h4,{id:"312-create-cambria-ftc-node-groups-workers",children:"3.1.2. Create Cambria FTC Node Group(s) (Workers)"}),"\n",(0,i.jsx)(n.p,{children:"Skip this step if planning to use Cambria FTC's autoscaler. Run the following steps to create the Node\nGroup(s) for the worker application instances (replace the highlighted values to those of your specific\nenvironment):"}),"\n",(0,i.jsx)(n.h4,{id:"information--recommendation-1",children:"Information / Recommendation"}),"\n",(0,i.jsxs)(n.p,{children:["For this particular case, ",(0,i.jsx)(n.strong,{children:"Cambria FTC nodes need to be added manually"}),". Therefore, you will need to think\nabout what machine / instance types are needed for running the Cambria FTC workflows. Based on benchmarks",(0,i.jsx)(n.br,{}),"\n","(See ",(0,i.jsx)(n.strong,{children:"1.3. Akamai Cloud Machine Information and Benchmark"}),"), the recommended machine / instance type\nto get started is ",(0,i.jsx)(n.strong,{children:"g6-dedicated-16"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To get started, it is recommended to start with ",(0,i.jsx)(n.strong,{children:"one instance"}),". This way, when the installation is complete,\nthere will already be one Cambria FTC instance available to test with. The number of instances can always be\nscaled up or down, up to the maximum FTC instance count configured in",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"section 4.2. Creating and Editing Helm Configuration File"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Plan:"})," Dedicated 32GB (this is the recommended plan, but can be configured as needed)",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Nodes:"})," 1+"]}),"\n",(0,i.jsx)(n.h4,{id:"313-deploy-the-kubernetes-cluster",children:"3.1.3. Deploy the Kubernetes Cluster"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"After selecting the initial node group(s), create the cluster. This will begin the LKE cluster deployment with\nthe initial nodes."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"It may take a few minutes for everything configured so far to be in a usable state. Wait for the nodes to all have\na Status of Running."}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Once the LKE Cluster is running, labels need to be added to the Cambria Cluster node pool:\na. In the Akamai Cloud Dashboard, go into the kubernetes cluster and look for the Cambria Cluster\nnode pool\nb. Select Labels and Taints and Add Label. In the Label field, enter capella-manager: true and then\nsave the changes"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Only if you added Cambria FTC nodes, do the following:\na. In the Akamai Cloud Dashboard, go to the kubernetes cluster and look for the Cambria FTC node pool\nb. Select Labels and Taints and Add Label. In the Label field, enter capella-worker: true and then\nsave the changes"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"(Optional) If you want Cambria Cluster nodes to also be able to run encoding jobs, set this label on the\nCambria Cluster node pool as well: capella-worker: true"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Copy the contents of the Kubeconfig file:\na. In the Linux Deployment Server, run the following commands (replace cambria-cluster with the\nKubernetes Cluster's name):",(0,i.jsx)(n.br,{}),"\n","export CLUSTER_NAME=cambria-cluster && nano $CLUSTER_NAME-kubeconfig.yaml",(0,i.jsx)(n.br,{}),"\n","b. In the Akamai dashboard, navigate to the Kubernetes cluster that was created. In the Kubeconfig\nsection, click on View and copy the contents",(0,i.jsx)(n.br,{}),"\n","c. In the Linux Deployment Server, paste the kubeconfig contents. Save the file by holding CTRL/CMD"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"X, pressing the letter 'y', and then the Enter/Return key"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Still in the Linux Deployment Server, set the KUBECONFIG environment variable for terminal interaction\nwith the LKE cluster:",(0,i.jsx)(n.br,{}),"\n","export KUBECONFIG=$CLUSTER_NAME-kubeconfig.yaml"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Verify that kubectl works with the cluster",(0,i.jsx)(n.br,{}),"\n","kubectl get nodes"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'NAME STATUS ROLES AGE VERSION\nlke525068-759150-2bfe0e460000 Ready <none> 20m v1.34.0\nlke525068-759150-4661256b0000 Ready <none> 20m v1.34.0\nlke525068-759150-5d7b909a0000 Ready <none> 20m v1.34.0\n\n\n8. Back in the Akamai dashboard in the LKE cluster, click on Copy Token. Then, on Kubernetes Dashboard, use the token to log in to the dashboard\n\nThis will show details about the LKE cluster in its current state. This dashboard can be used to view and manage\nthe LKE cluster from a graphical point of view.\n\n![Screenshot](01_screenshot.png)\n\n#### 3.1.4. Default Storage Class\nSet the storage class linode-block-storage as the default storage class:\n\n```bash\nkubectl patch storageclass linode-block-storage \\\n  -p \'{"metadata": {"annotations": {"storageclass.kubernetes.io/is-default-class": "true"}}}\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"32-beta-gpu-operator-for-nvenc-optional",children:"3.2. [BETA] GPU Operator for NVENC (optional)"}),"\n",(0,i.jsx)(n.p,{children:"This section is only required for a Kubernetes cluster that will use GPUs. Skip this step if GPUs will\nnot be used in this Kubernetes cluster."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"BETA Feature:"})," GPU can be used in Cambria Cluster/FTC. However, this feature is still a work in progress and may not function as expected."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm repo add nvidia https://helm.ngc.nvidia.com/nvidia; \\\nhelm repo update; \\\nhelm install nvidia-operator nvidia/gpu-operator \\\n  --create-namespace \\\n  --namespace gpu-operator\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Wait ~5 minutes."}),"\n",(0,i.jsxs)(n.li,{children:["Check pods: ",(0,i.jsx)(n.code,{children:"kubectl get pods -n gpu-operator"})]}),"\n",(0,i.jsxs)(n.li,{children:["Troubleshoot: ",(0,i.jsx)(n.code,{children:"kubectl describe pod <pod> -n gpu-operator"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"33-application-ingress-ingressnginx",children:"3.3. Application Ingress: ingress\u2011nginx"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.13.0/deploy/static/provider/cloud/deploy.yaml\nkubectl get all -n ingress-nginx\n"})}),"\n",(0,i.jsxs)(n.p,{children:["For production DNS/TLS, see:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)("a",{href:"https://www.dropbox.com/scl/fi/kxt7tnv9q18fqjmjjuwrc/Cambria_Kubernetes_Domain_DNS_Guide.pdf?rlkey=mvm4jnplyji95snq4109noiwj&st=6a7nial5&dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/kxt7tnv9q18fqjmjjuwrc/Cambria_Kubernetes_Domain_DNS_Guide.pdf?rlkey=mvm4jnplyji95snq4109noiwj&st=6a7nial5&dl=0",children:"https://www.dropbox.com/scl/fi/kxt7tnv9q18fqjmjjuwrc/Cambria_Kubernetes_Domain_DNS_Guide.pdf?rlkey=mvm4jnplyji95snq4109noiwj&st=6a7nial5&dl=0"})})]}),"\n",(0,i.jsx)(n.h3,{id:"34-performance-metrics-and-logging",children:"3.4. Performance Metrics and Logging"}),"\n",(0,i.jsxs)(n.p,{children:["Install ",(0,i.jsx)(n.strong,{children:"Prometheus, Grafana, Loki, Promtail"}),":",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)("a",{href:"https://www.dropbox.com/scl/fi/cb75lsh6ipvbf0x1y4ysp/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=kcxit4i6ntj5ynv2e26zydhiy&st=douvkvi9&dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/cb75lsh6ipvbf0x1y4ysp/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=kcxit4i6ntj5ynv2e26zydhiy&st=douvkvi9&dl=0",children:"https://www.dropbox.com/scl/fi/cb75lsh6ipvbf0x1y4ysp/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_Akamai_Kubernetes.pdf?rlkey=kcxit4i6ntj5ynv2e26zydhiy&st=douvkvi9&dl=0"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-install-cambria-cluster-ftc-and-dependencies",children:"4. Install Cambria Cluster, FTC, and Dependencies"}),"\n",(0,i.jsx)(n.h3,{id:"41-prerequisite-deploy-external-kubernetes-tools",children:"4.1. Prerequisite: Deploy External Kubernetes Tools"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/deployCambriaKubeDependencies.sh\n\nkubectl get all -n cnpg-system\nkubectl get all -n argo-events\nkubectl get all -n cert-manager\n"})}),"\n",(0,i.jsx)(n.h3,{id:"42-creating-and-editing-helm-configuration-file",children:"4.2. Creating and Editing Helm Configuration File"}),"\n",(0,i.jsx)(n.p,{children:"Create values file and edit:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm show values ./config/capella-cluster-0.5.4.tgz > cambriaClusterConfig.yaml\nnano cambriaClusterConfig.yaml\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key fields:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'workersUseGPU: false         # true if using NVENC/GPU; also set nbGPUs accordingly\nnbGPUs: 1\nenableManagerWebUI: true\nftcEnableAutoScaler: true\nftcEnableScriptableWorkflow: true\nftcInstanceType: "g6-dedicated-16"\nmaxFTCInstances: 20\n\npgInstances: 3\ncambriaClusterReplicas: 3\n\nexternalAccess:\n  exposeStreamServiceExternally: true\n  enableIngress: true\n  hostName: myhost.com\n  acmeRegistrationEmail: test@example.com\n  acmeServer: https://acme-staging-v02.api.letsencrypt.org/directory\n\nsecrets:\n  pgClusterPassword: "CHANGE_ME"\n  ftcLicenseKey: "2XXXXX-XXXXXX-XXXXXX-XXXXXX-XXXXXX-XXXXXX"\n  cambriaClusterAPIToken: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"\n  cambriaClusterWebUIUser: "admin,admin,changeme"\n  akamaiCloudAPIToken: "AKAMAI_API_TOKEN"\n  argoEventWebhookSourceBearerToken: "changeme"\n\noptionalInstall:\n  enableEventing: true\n'})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Blue items are provided by Capella (release values). Red items are environment\u2011specific."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"43-installing-cambria-ftc--cluster",children:"4.3. Installing Cambria FTC / Cluster"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade --install capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml\n"})}),"\n",(0,i.jsx)(n.p,{children:"After a few minutes, get deployment info:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/getFtcInfo.sh\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-verify-cambria-ftc--cluster-installation",children:"5. Verify Cambria FTC / Cluster Installation"}),"\n",(0,i.jsx)(n.h3,{id:"51-verify-cambria-cluster-deployment",children:"5.1. Verify Cambria Cluster Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get all -n default\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Expect:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deployments:"})," ",(0,i.jsx)(n.code,{children:"cambriaclusterapp"})," (active), ",(0,i.jsx)(n.code,{children:"cambriaclusterwebui"})," (active)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pods:"})," ",(0,i.jsx)(n.code,{children:"cambriaclusterapp-*"})," (count = replicas), ",(0,i.jsx)(n.code,{children:"cambriaclusterwebui-*"})," (active)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services:"})," ",(0,i.jsx)(n.code,{children:"cambriaclusterservice"})," and ",(0,i.jsx)(n.code,{children:"cambriaclusterwebuiservice"})," (EXTERNAL\u2011IP if external access enabled)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Check database resources:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get all -n capella-database\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Expect:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pods:"})," ",(0,i.jsx)(n.code,{children:"pgcluster-*"})," replicas = config; all Running"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services:"})," 3 services with ",(0,i.jsx)(n.code,{children:"pgcluster"})," in name (ClusterIP)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"52-verify-cambria-ftc-deployment",children:"5.2. Verify Cambria FTC Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get all -n capella-worker\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Expect:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pods:"})," ",(0,i.jsx)(n.code,{children:"cambriaftcapp-*"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["With autoscaler: most in ",(0,i.jsx)(n.strong,{children:"Pending"})," until autoscaler creates nodes"]}),"\n",(0,i.jsx)(n.li,{children:"Without autoscaler: Y Running (equals number of active FTC nodes)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deployments:"})," one ",(0,i.jsx)(n.code,{children:"cambriaftcapp"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"53-verify-applications-are-accessible",children:"5.3. Verify Applications are Accessible"}),"\n",(0,i.jsx)(n.h4,{id:"531-cambria-cluster-webui",children:"5.3.1. Cambria Cluster WebUI"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"External URL (if enabled):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get svc/cambriaclusterwebuiservice -n default -o=jsonpath=\"{'https://'}{.status.loadBalancer.ingress[0].hostname}{':8161'}{'\\n'}\"\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Port\u2011forward (temporary):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward -n default svc/cambriaclusterwebuiservice 8161:8161 --address=0.0.0.0\n# URL: https://<server>:8161\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Proceed past the browser\u2019s unsafe warning and log in using ",(0,i.jsx)(n.code,{children:"cambriaClusterWebUIUser"})," credentials from values."]}),"\n",(0,i.jsx)(n.h4,{id:"532-cambria-cluster-rest-api",children:"5.3.2. Cambria Cluster REST API"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"External URL (if enabled):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get svc/cambriaclusterservice -n default -o=jsonpath=\"{'https://'}{.status.loadBalancer.ingress[0].hostname}{':8650'}{'\\n'}\"\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Port\u2011forward (temporary) & test:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward -n default svc/cambriaclusterservice 8650:8650 --address=0.0.0.0\ncurl -k -X GET https://<server>:8650/CambriaFC/v1/SystemInfo\n"})}),"\n",(0,i.jsx)(n.h4,{id:"533-cambria-license-webui",children:"5.3.3. Cambria License WebUI"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"External URL (if enabled):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get svc/cambriaclusterwebuiservice -n default -o=jsonpath=\"{'https://'}{.status.loadBalancer.ingress[0].hostname}{':8481'}{'\\n'}\"\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Port\u2011forward (temporary):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward -n default svc/cambriaclusterwebuiservice 8481:8481 --address=0.0.0.0\n# URL: https://<server>:8481\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Proceed past the unsafe warning; sign in with ",(0,i.jsx)(n.code,{children:"cambriaClusterWebUIUser"}),". Ensure License Status is valid (Primary and/or Backup)."]}),"\n",(0,i.jsx)(n.h4,{id:"534-cambria-ingress",children:"5.3.4. Cambria Ingress"}),"\n",(0,i.jsx)(n.h5,{id:"5341-get-the-ingress-endpoints",children:"5.3.4.1. Get the Ingress Endpoints"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get ingress -A\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example output:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"NAMESPACE    NAME                       CLASS   HOSTS                              ADDRESS      PORTS  AGE\ndefault      cambriaclusteringress      nginx   api.mydomain.com,webui.mydomain.com 55.99.103.99 80,443 23m\nmonitoring   cambriamonitoringingress   nginx   monitoring.mydomain.com             55.99.103.99 80,443 58m\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Option 1 (test only):"})," Add to ",(0,i.jsx)(n.code,{children:"/etc/hosts"})," on client machines:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"55.99.103.99  api.mydomain.com\n55.99.103.99  webui.mydomain.com\n55.99.103.99  monitoring.mydomain.com\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Option 2 (production):"})," Use a publicly registered domain and proper DNS/TLS (see DNS guide above)."]}),"\n",(0,i.jsx)(n.h5,{id:"5342-test-ingress-endpoints",children:"5.3.4.2. Test Ingress Endpoints"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["WebUI: ",(0,i.jsx)(n.code,{children:"https://webui.mydomain.com"})]}),"\n",(0,i.jsxs)(n.li,{children:["REST: ",(0,i.jsx)(n.code,{children:"https://api.mydomain.com/CambriaFC/v1/SystemInfo"})]}),"\n",(0,i.jsxs)(n.li,{children:["Grafana: ",(0,i.jsx)(n.code,{children:"https://monitoring.mydomain.com"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-testing-cambria-ftc--cluster",children:"6. Testing Cambria FTC / Cluster"}),"\n",(0,i.jsxs)(n.p,{children:["See:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)("a",{href:"https://www.dropbox.com/scl/fi/ymu5fln1n811a1i92radv/Cambria_Cluster_and_FTC_5_6_0_Kubernetes_User_Guide.pdf?rlkey=cd0unkt9hcs3mhjp1fjbcvi9n&st=fb030h8o&dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/ymu5fln1n811a1i92radv/Cambria_Cluster_and_FTC_5_6_0_Kubernetes_User_Guide.pdf?rlkey=cd0unkt9hcs3mhjp1fjbcvi9n&st=fb030h8o&dl=0",children:"https://www.dropbox.com/scl/fi/ymu5fln1n811a1i92radv/Cambria_Cluster_and_FTC_5_6_0_Kubernetes_User_Guide.pdf?rlkey=cd0unkt9hcs3mhjp1fjbcvi9n&st=fb030h8o&dl=0"})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"7-updating--upgrading-cambria-cluster--ftc",children:"7. Updating / Upgrading Cambria Cluster / FTC"}),"\n",(0,i.jsx)(n.h3,{id:"71-option-1--normal-upgrade-helm-upgrade",children:"7.1. Option 1 \u2014 Normal Upgrade (Helm Upgrade)"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Known issues:"})," ",(0,i.jsx)(n.code,{children:"pgClusterPassword"})," and PostgreSQL version cannot be changed via this method."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml\n\nkubectl rollout restart deployment cambriaclusterapp cambriaclusterwebui -n default\nkubectl rollout restart deployment cambriaftcapp -n capella-worker\n"})}),"\n",(0,i.jsx)(n.h3,{id:"72-option-2--reinstall-deletes-db-and-jobs",children:"7.2. Option 2 \u2014 Reinstall (Deletes DB and Jobs)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall capella-cluster --wait\nhelm upgrade --install capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"73-upgrade-verification",children:"7.3. Upgrade Verification"}),"\n",(0,i.jsxs)(n.p,{children:["Repeat the checks in ",(0,i.jsx)(n.strong,{children:"5. Verify Cambria FTC / Cluster Installation"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"8-deleting-kubernetes-cluster",children:"8. Deleting Kubernetes Cluster"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall capella-cluster -n default --wait\n"})}),"\n",(0,i.jsx)(n.p,{children:"If PVs remain:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get pv -o name | awk -F'/' '{print $2}' | xargs -I{} kubectl patch pv {} -p='{\"spec\": {\"persistentVolumeReclaimPolicy\": \"Delete\"}}'\n"})}),"\n",(0,i.jsx)(n.p,{children:"Delete ingress controller:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl delete namespace ingress-nginx\n"})}),"\n",(0,i.jsx)(n.p,{children:"Uninstall monitoring:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/quickDestroyMonitoring.sh <install_type>   # 's3_embedcred' or 'local'\n"})}),"\n",(0,i.jsx)(n.p,{children:"Delete the LKE cluster in the Akamai console."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"9-quick-reference-installation-testing-and-teardown",children:"9. Quick Reference: Installation, Testing, and Teardown"}),"\n",(0,i.jsx)(n.h3,{id:"91-installation-terraform-quick-path",children:"9.1. Installation (Terraform quick path)"}),"\n",(0,i.jsx)("a",{href:"https://www.dropbox.com/scl/fi/0vhx8634n6s12qjwxw25f/Cambria_Cluster_and_FTC_5_6_0_Terraform_on_Akamai_Kubernetes.pdf?rlkey=xamh1hkjbli55mwfm6gs67tti&st=yp5057bh&dl=0",children:(0,i.jsx)(n.a,{href:"https://www.dropbox.com/scl/fi/0vhx8634n6s12qjwxw25f/Cambria_Cluster_and_FTC_5_6_0_Terraform_on_Akamai_Kubernetes.pdf?rlkey=xamh1hkjbli55mwfm6gs67tti&st=yp5057bh&dl=0",children:"https://www.dropbox.com/scl/fi/0vhx8634n6s12qjwxw25f/Cambria_Cluster_and_FTC_5_6_0_Terraform_on_Akamai_Kubernetes.pdf?rlkey=xamh1hkjbli55mwfm6gs67tti&st=yp5057bh&dl=0"})}),"\n",(0,i.jsx)(n.h3,{id:"92-upgrades-and-teardown",children:"9.2. Upgrades and Teardown"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Upgrade helper:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./quickUpgradeCambriaCluster.sh\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Uninstall apps only:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall capella-cluster --wait\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Full teardown:"})," see ",(0,i.jsx)(n.strong,{children:"8. Deleting Kubernetes Cluster"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"10-quick-reference-helpful-commands--info-postinstall",children:"10. Quick Reference: Helpful Commands / Info (Post\u2011Install)"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"General Cambria FTC Deployment Info"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./bin/getFtcInfo.sh\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add worker label"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl label node <node-name> capella-worker=true\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add manager label"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl label node <node-name> capella-manager=true\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Kubeconfig"})," \u2014 copy from Akamai console (Clusters \u2192 Kubeconfig)."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Akamai Kubernetes Dashboard"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Copy ",(0,i.jsx)(n.strong,{children:"Token"})," in your cluster."]}),"\n",(0,i.jsxs)(n.li,{children:["Open ",(0,i.jsx)(n.strong,{children:"Kubernetes Dashboard"})," and log in with the token."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"WebUI address (kubectl)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get service/cambriaclusterwebuiservice -n default -o=jsonpath=\"{'https://'}{.status.loadBalancer.ingress[0].hostname}{':8161'}\"\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"WebUI address (Dashboard)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Services \u2192 ",(0,i.jsx)(n.code,{children:"cambriaclusterwebuiservice"})," \u2192 External Endpoint \u2192 ",(0,i.jsx)(n.code,{children:"https://<EXTERNAL-IP>:8161"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"REST base URL (kubectl)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get service/cambriaclusterservice -n default -o=jsonpath=\"{'https://'}{.status.loadBalancer.ingress[0].hostname}{':8650'}\"\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"REST base URL (Dashboard)"}),"\n",(0,i.jsx)(n.code,{children:"https://<EXTERNAL-IP>:8650/CambriaFC/v1/Jobs?usertoken=<token>"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"FTC pod external IP"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# get node of the pod\nkubectl get pod/<pod-name> -n capella-worker -o=jsonpath={.spec.nodeName}\n# get external IP of node\nkubectl get node/<node-name> -o=jsonpath={.status.addresses[1].address}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Leader pod"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'kubectl get lease -o=jsonpath="{.items[0].spec.holderIdentity}"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Remote shell"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl exec -it <pod-name> -n <namespace> -- /bin/bash\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Collect logs"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl cp <pod>:/opt/capella/Cambria/Logs ./CambriaFTCLogs -n capella-worker\nkubectl cp <pod>:/opt/capella/CambriaCluster/Logs ./CambriaClusterLogs -n default\nkubectl cp <pod>:/opt/capella/CambriaLicenseManager/Logs ./CambriaFTCLicLogs -n capella-worker\nkubectl cp <pod>:/opt/capella/CambriaLicenseManager/Logs ./CambriaClusterLicLogs -n default\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Copy files into pods"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl cp /path/to/file <pod>:/path/in/container -n <namespace>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Restart pods (delete to recreate)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl delete pod <pod-name> -n <namespace>\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"11-glossary-selected",children:"11. Glossary (selected)"}),"\n",(0,i.jsx)(n.h3,{id:"111-kubernetes",children:"11.1. Kubernetes"}),"\n",(0,i.jsxs)(n.p,{children:["For Kubernetes terms, see the official glossary: ",(0,i.jsx)("a",{href:"https://kubernetes.io/docs/reference/glossary/?fundamental=true",children:(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/glossary/?fundamental=true",children:"https://kubernetes.io/docs/reference/glossary/?fundamental=true"})})]}),"\n",(0,i.jsx)(n.h3,{id:"112-thirdparty-tools",children:"11.2. Third\u2011Party Tools"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Argo"})," \u2014 Orchestrates parallel jobs in Kubernetes."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Argo\u2011Events"})," \u2014 Triggers Kubernetes functions from events (webhook, S3, etc.)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cert\u2011manager"})," \u2014 Automates TLS certificate issuance/renewal."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Helm"})," \u2014 Package manager for Kubernetes."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ingress\u2011nginx"})," \u2014 Nginx\u2011based reverse proxy and load balancer for Ingress."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"113-capella-applications",children:"11.3. Capella Applications"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cambriaclusterapp"})," \u2014 Cambria Cluster application container."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cambriaftautoscale"})," \u2014 Spawns FTC nodes based on queue depth."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cambriaftcapp"})," \u2014 Cambria FTC application container."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cambriaftcconnect"})," \u2014 Auto\u2011connects FTC instances to Cambria Cluster."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"cambrialeaderelector"})," \u2014 Handles Cambria Cluster leader election."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"pgcluster-capella"})," \u2014 PostgreSQL pod used by Cambria Cluster."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"End of document."})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(6540);const i={},t=r.createContext(i);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);