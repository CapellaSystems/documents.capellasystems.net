<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Cambria_FTC/Installation Guides/Kubernetes/AWS/cambria-cluster-ftc-aws-5-6-0" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Cambria Cluster / FTC 5.6.0 – AWS Kubernetes | Capella Documents</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://documents.capellasystems.net/img/capellalogo.png"><meta data-rh="true" name="twitter:image" content="https://documents.capellasystems.net/img/capellalogo.png"><meta data-rh="true" property="og:url" content="https://documents.capellasystems.net/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cambria Cluster / FTC 5.6.0 – AWS Kubernetes | Capella Documents"><meta data-rh="true" name="description" content="Document History"><meta data-rh="true" property="og:description" content="Document History"><link data-rh="true" rel="icon" href="/img/capellalogo.png"><link data-rh="true" rel="canonical" href="https://documents.capellasystems.net/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/"><link data-rh="true" rel="alternate" href="https://documents.capellasystems.net/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/" hreflang="en"><link data-rh="true" rel="alternate" href="https://documents.capellasystems.net/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://FG2ZSI8I7W-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WQ8DZ3HYRX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WQ8DZ3HYRX",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Capella Documents" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.32bb5c81.css">
<script src="/assets/js/runtime~main.60aef16f.js" defer="defer"></script>
<script src="/assets/js/main.bb1aba5a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/capellalogo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/capellalogo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/capellalogo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Capella Documentation</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Cambria_FTC/FTC-Overview/">Cambria FTC</a><a class="navbar__item navbar__link" href="/docs/Cambria Stream/Installation Guides/Kubernetes/AWS/AWS_Kubernetes_Documentation/">Cambria Stream</a><a href="https://www.capellasystems.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Capella Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Cambria_FTC/FTC-Overview/">FTC Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/">Installation Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/">Kubernetes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/">AWS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/AWS/">Cambria Cluster / FTC 5.6.0 – AWS Kubernetes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Kubernetes/">Akamai</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/Oracle/placeholder">Oracle</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Cambria_FTC/Installation Guides/Windows/placeholder">Windows</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Cambria_FTC/Release Notes/FTC_v5.6_to_v4.0">Release Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Cambria_FTC/API/REST_API_FTC_5_0_1_index">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Cambria_FTC/Tutorials/AMI_Creation_and_Editing/">Tutorials<button style="margin-left:5px;cursor:pointer;margin-bottom:-2px;z-index:1000;background:transparent;padding:0;display:inline-flex;align-items:center;justify-content:center;border:none;color:var(--ifm-color-primary)" title="Sort A-Z"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-az lucide-arrow-down-a-z tutorial-sort-icon" aria-hidden="true"><path d="m3 16 4 4 4-4"></path><path d="M7 20V4"></path><path d="M20 8h-5"></path><path d="M15 10V6.5a2.5 2.5 0 0 1 5 0V10"></path><path d="M15 14h5l-5 6h5"></path></svg></button></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Cambria_FTC/FAQ/">FAQ</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Installation Guides</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Kubernetes</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AWS</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cambria Cluster / FTC 5.6.0 – AWS Kubernetes</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cambria Cluster / FTC 5.6.0 – AWS Kubernetes</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="document-history">Document History<a href="#document-history" class="hash-link" aria-label="Direct link to Document History" title="Direct link to Document History">​</a></h2>
<table><thead><tr><th>Version</th><th>Date</th><th>Description</th></tr></thead><tbody><tr><td>5.5.0</td><td>04/11/2025</td><td>Updated for release 5.5.0.23529 (Linux)</td></tr><tr><td>5.6.0</td><td>10/31/2025</td><td>Updated for release 5.6.0.26533 (Linux)</td></tr></tbody></table>
<blockquote>
<p><strong>Download the online version of this document for the latest information and latest files. Always download the latest files.</strong></p>
</blockquote>
<p>Do not move forward with the installation process if you do not agree with the End User License Agreement (EULA) for our products.<br>
<!-- -->You can download and read the EULA for Cambria FTC, Cambria Cluster, and Cambria License Manager from the links below:</p>
<ul>
<li><a href="https://www.dropbox.com/s/1wg7ee7a59kzi8h/EULA_Cambria_License_Manager.pdf?dl=0" target="_blank" rel="noopener noreferrer">Cambria License Manager EULA</a></li>
<li><a href="https://www.dropbox.com/s/oemlax63aatjjiw/EULA_Cluster.pdf?dl=0" target="_blank" rel="noopener noreferrer">Cambria Cluster EULA</a></li>
<li><a href="https://www.dropbox.com/s/ualv9usxsowh6m2/EULA_FTC.pdf?dl=0" target="_blank" rel="noopener noreferrer">Cambria FTC EULA</a></li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitations-and-security-information">Limitations and Security Information<a href="#limitations-and-security-information" class="hash-link" aria-label="Direct link to Limitations and Security Information" title="Direct link to Limitations and Security Information">​</a></h3>
<p>Cambria FTC, Cluster, and License Manager run inside Linux Docker containers.<br>
<!-- -->Security checks for this version are included in the general Linux documentation:</p>
<ul>
<li><strong>Cambria FTC / Cluster (sections 8 and 9):</strong><br>
<a href="https://www.dropbox.com/scl/fi/rvf02h8tajsxrfbhpgmzy/Linux_Cambria_FTC_5_6_0_Guide.pdf?rlkey=gtqeowx2b9gartth8s6dwo95j&amp;st=4wpy1dfi&amp;dl=0" target="_blank" rel="noopener noreferrer">https://www.dropbox.com/scl/fi/rvf02h8tajsxrfbhpgmzy/Linux_Cambria_FTC_5_6_0_Guide.pdf?rlkey=gtqeowx2b9gartth8s6dwo95j&amp;st=4wpy1dfi&amp;dl=0</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-important-before-you-begin">⚠️ Important: Before You Begin<a href="#️-important-before-you-begin" class="hash-link" aria-label="Direct link to ⚠️ Important: Before You Begin" title="Direct link to ⚠️ Important: Before You Begin">​</a></h2>
<p>PDF documents often have copy/paste issues. For best results, download this document and any referenced PDFs and open them in a viewer such as Adobe Acrobat.</p>
<p>For commands that span multiple lines, copy each line individually and verify accuracy.</p>
<p>This document references <strong>Kubernetes version 1.34 only</strong>.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-critical-information-read-before-proceeding">⚠️ Critical Information: Read Before Proceeding<a href="#️-critical-information-read-before-proceeding" class="hash-link" aria-label="Direct link to ⚠️ Critical Information: Read Before Proceeding" title="Direct link to ⚠️ Critical Information: Read Before Proceeding">​</a></h2>
<p>Before starting the installation, review the following key points:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-a-new-kubernetes-cluster-will-be-deployed">1. A New Kubernetes Cluster Will Be Deployed<a href="#1-a-new-kubernetes-cluster-will-be-deployed" class="hash-link" aria-label="Direct link to 1. A New Kubernetes Cluster Will Be Deployed" title="Direct link to 1. A New Kubernetes Cluster Will Be Deployed">​</a></h3>
<p>The installation process creates a <strong>brand-new AWS EKS cluster</strong>, isolated from other applications.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-default-installation-is-non-secure">2. Default Installation is Non-Secure<a href="#2-default-installation-is-non-secure" class="hash-link" aria-label="Direct link to 2. Default Installation is Non-Secure" title="Direct link to 2. Default Installation is Non-Secure">​</a></h3>
<ul>
<li>The default deployment uses open, non-secure settings.</li>
<li>Secure or hardened deployments require AWS expertise (not covered in this guide).</li>
<li>Firewall details are provided in <strong>Section 1.5</strong>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-understand-your-transcoding-requirements">3. Understand Your Transcoding Requirements<a href="#3-understand-your-transcoding-requirements" class="hash-link" aria-label="Direct link to 3. Understand Your Transcoding Requirements" title="Direct link to 3. Understand Your Transcoding Requirements">​</a></h3>
<p>Know your:</p>
<ul>
<li>Expected encoding workload</li>
<li>Input/output specifications</li>
<li>GPU requirements</li>
</ul>
<p>See <strong>Section 1.3</strong> for AWS machine recommendations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-administrative-aws-rights-required">4. Administrative AWS Rights Required<a href="#4-administrative-aws-rights-required" class="hash-link" aria-label="Direct link to 4. Administrative AWS Rights Required" title="Direct link to 4. Administrative AWS Rights Required">​</a></h3>
<p>Many steps require IAM-level administrative permissions in AWS.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-verify-aws-account-quota">5. Verify AWS Account Quota<a href="#5-verify-aws-account-quota" class="hash-link" aria-label="Direct link to 5. Verify AWS Account Quota" title="Direct link to 5. Verify AWS Account Quota">​</a></h3>
<p>Ensure your AWS account has enough quota to deploy all required EKS resources<br>
<!-- -->(see <strong>Section 1.2</strong>).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-a-separate-linux-machine-is-required">6. A Separate Linux Machine is Required<a href="#6-a-separate-linux-machine-is-required" class="hash-link" aria-label="Direct link to 6. A Separate Linux Machine is Required" title="Direct link to 6. A Separate Linux Machine is Required">​</a></h3>
<p>A dedicated Linux machine is required to:</p>
<ul>
<li>Install AWS and Kubernetes tools</li>
<li>Run AWS CLI</li>
<li>Safely store kubeconfig files</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-verify-region-specific-resource-availability">7. Verify Region-Specific Resource Availability<a href="#7-verify-region-specific-resource-availability" class="hash-link" aria-label="Direct link to 7. Verify Region-Specific Resource Availability" title="Direct link to 7. Verify Region-Specific Resource Availability">​</a></h3>
<p>GPU availability and instance types vary by AWS region.<br>
<!-- -->Check AWS documentation to confirm support in your region of operation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="document-overview">Document Overview<a href="#document-overview" class="hash-link" aria-label="Direct link to Document Overview" title="Direct link to Document Overview">​</a></h2>
<p>This guide provides a full walkthrough for installation and testing of Cambria Cluster and Cambria FTC on AWS Kubernetes.</p>
<p>It includes:</p>
<ol>
<li>Overview of the Cambria Cluster / FTC Environment in a Kubernetes Environment</li>
<li>Preparation for the installation (Prerequisites)</li>
<li>Create and configure the Kubernetes Cluster</li>
<li>Install Cambria Cluster and Cambria FTC on the Kubernetes Cluster</li>
<li>Verify the installation is working properly</li>
<li>Test the Cambria Cluster / FTC applications</li>
<li>Update the Cambria Cluster / FTC applications on Kubernetes Cluster</li>
<li>Delete a Kubernetes Cluster</li>
<li>Quick Reference of Kubernetes Installation</li>
<li>Quick Reference of Important Kubernetes Components (urls, template projects, test player, etc)</li>
<li>Glossary of important terms</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-overview">1. Overview<a href="#1-overview" class="hash-link" aria-label="Direct link to 1. Overview" title="Direct link to 1. Overview">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-cambria-cluster--ftc-kubernetes-deployment">1.1 Cambria Cluster / FTC Kubernetes Deployment<a href="#11-cambria-cluster--ftc-kubernetes-deployment" class="hash-link" aria-label="Direct link to 1.1 Cambria Cluster / FTC Kubernetes Deployment" title="Direct link to 1.1 Cambria Cluster / FTC Kubernetes Deployment">​</a></h3>
<p>Two major applications are deployed in this environment:</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cambria-cluster"><strong>Cambria Cluster</strong><a href="#cambria-cluster" class="hash-link" aria-label="Direct link to cambria-cluster" title="Direct link to cambria-cluster">​</a></h3>
<p>This deployment is recommended to run on at least 3 nodes (replica = 3) with a service (Load Balancer) that
exposes the application externally. For each of these nodes, Cambria Cluster will be installed on its own pod and
designated to its own node. One node acts as the leader and the other two are replicas for the purpose of
replacing the leader in the case it becomes inactive, corrupted, etc. Each Cambria Cluster pod has three
containers:</p>
<ol>
<li><strong>Cambria Cluster (application)</strong></li>
<li><strong>Leader Elector</strong> that chooses which of the Cambria Cluster node / pod will be the leader)</li>
<li><strong>FTC Autoscaler</strong>, that when the FTC autoscaler is enabled, it will automatically deploy worker nodes for encoding purposes based on the number of encoding jobs queued to the system. This is based on the calculation (rounded down):</li>
</ol>
<p>Number of Nodes = (Queued Jobs + 2) / 3</p>
<p>Also for the Cluster deployment, there is a corresponding PostgreSQL database installed on a separate pod for each active Cambria Cluster pod. The data is replicated between the different database pods in order to preserve data in case of issues with the database and/or Cluster.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cambria-ftc"><strong>Cambria FTC</strong><a href="#cambria-ftc" class="hash-link" aria-label="Direct link to cambria-ftc" title="Direct link to cambria-ftc">​</a></h3>
<p>Capella’s Cambria FTC deployment consists of one or more nodes that (by default) are of different instance
types than the Cambria Cluster nodes. These nodes focus specifically on running encoding tasks. Similar to
Cambria Cluster, the Cambria FTC application is installed on its own pod and designated to its own node. Each
Cambria FTC pod has three containers:</p>
<ol>
<li>
<p><strong>Cambria FTC application</strong></p>
</li>
<li>
<p><strong>Auto-Connect FTC .NET tool</strong>, that does the following: 1. list pods, 2. attempts to find Cambria
Cluster, and 3. connects the Cambria FTC application running in the pod to the Cambria Cluster that it
found. This container also deletes its own node pool or recycles its node if no Cambria Cluster is found
within a specific time (~20 minutes)</p>
</li>
<li>
<p><strong>Pgcluster database</strong> for storing its encoder&#x27;s own job contents and other such information for as long as the pod is running.</p>
</li>
</ol>
<p>Each node in the Kubernetes Cluster will either be running the Cluster deployment or the FTC deployment.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-resource-usage">1.2 Resource Usage<a href="#12-resource-usage" class="hash-link" aria-label="Direct link to 1.2 Resource Usage" title="Direct link to 1.2 Resource Usage">​</a></h3>
<p>The resources used and their quantities will vary depending on requirements and different
environments. Below is general information about some of the major resource usage (other resources may be
used. Consult AWS and eksctl documentation for other resources created, usage limits, etc):</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="useful-aws-documentation">Useful AWS Documentation<a href="#useful-aws-documentation" class="hash-link" aria-label="Direct link to Useful AWS Documentation" title="Direct link to Useful AWS Documentation">​</a></h4>
<ul>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/eks-deployment-options.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/userguide/eks-deployment-options.html</a></li>
<li><a href="https://eksctl.io/usage/creating-and-managing-clusters/" target="_blank" rel="noopener noreferrer">https://eksctl.io/usage/creating-and-managing-clusters/</a></li>
<li><a href="https://eksctl.io/usage/vpc-networking/" target="_blank" rel="noopener noreferrer">https://eksctl.io/usage/vpc-networking/</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/best-practices/subnets.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/best-practices/subnets.html</a></li>
<li><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AvailableIpPerENI.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AvailableIpPerENI.html</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/best-practices/network-security.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/best-practices/network-security.html</a></li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="approximate-components">Approximate Components<a href="#approximate-components" class="hash-link" aria-label="Direct link to Approximate Components" title="Direct link to Approximate Components">​</a></h3>
<table><thead><tr><th>Resource</th><th>Notes</th></tr></thead><tbody><tr><td>Load Balancers</td><td>0–3 Classic LBs (WebUI, Web Server, Grafana), 0–1 NLB (Ingress)</td></tr><tr><td>Nodes</td><td>3 Cambria Manager nodes (default), plus FTC nodes</td></tr><tr><td>Networking</td><td>1 VPC, 3 public + 3 private subnets</td></tr><tr><td>IP Space</td><td>Default <code>/16</code>, subnets <code>/19</code></td></tr><tr><td>Security Groups</td><td>Default is 1 security group for control plane, Default is X security groups</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="13-aws-machine-information-and-benchmark">1.3 AWS Machine Information and Benchmark<a href="#13-aws-machine-information-and-benchmark" class="hash-link" aria-label="Direct link to 1.3 AWS Machine Information and Benchmark" title="Direct link to 1.3 AWS Machine Information and Benchmark">​</a></h2>
<p>The following is a benchmark of two AWS machines. The information below is as of October 2025. Note that the
benchmark involves read from / write to AWS S3 which influences the real-time speed of transcoding jobs.</p>
<p><strong>Benchmark Input</strong></p>
<ul>
<li>Source: <strong>TS H.264 @ 1080p 8 Mbps</strong></li>
<li>Outputs: <strong>HLS variants</strong> (1080p → 240p)</li>
</ul>
<p><strong>a. c6a.4xlarge [ AMD EPYC 7R13 ]</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-aws-machine-information-and-benchmark-1">1.3 AWS Machine Information and Benchmark<a href="#13-aws-machine-information-and-benchmark-1" class="hash-link" aria-label="Direct link to 1.3 AWS Machine Information and Benchmark" title="Direct link to 1.3 AWS Machine Information and Benchmark">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="a-c6a4xlarge--amd-epyc-7r13"><strong>a. c6a.4xlarge – AMD EPYC 7R13</strong><a href="#a-c6a4xlarge--amd-epyc-7r13" class="hash-link" aria-label="Direct link to a-c6a4xlarge--amd-epyc-7r13" title="Direct link to a-c6a4xlarge--amd-epyc-7r13">​</a></h4>
<table><thead><tr><th>Spec</th><th>Value</th></tr></thead><tbody><tr><td>RAM</td><td>32 GB</td></tr><tr><td>CPUs</td><td>16</td></tr><tr><td>Network</td><td>12.5 Gbps</td></tr><tr><td>Cost</td><td>$0.612/hr</td></tr></tbody></table>
<p><strong>Benchmark Results</strong></p>
<table><thead><tr><th>Concurrent Jobs</th><th>Speed</th><th>CPU</th></tr></thead><tbody><tr><td>2</td><td>0.67x RT</td><td>100%</td></tr></tbody></table>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="b-c6a16xlarge--amd-epyc-7r13"><strong>b. c6a.16xlarge – AMD EPYC 7R13</strong><a href="#b-c6a16xlarge--amd-epyc-7r13" class="hash-link" aria-label="Direct link to b-c6a16xlarge--amd-epyc-7r13" title="Direct link to b-c6a16xlarge--amd-epyc-7r13">​</a></h4>
<table><thead><tr><th>Spec</th><th>Value</th></tr></thead><tbody><tr><td>RAM</td><td>128 GB</td></tr><tr><td>CPUs</td><td>64</td></tr><tr><td>Network</td><td>25 Gbps</td></tr><tr><td>Cost</td><td>$2.448/hr</td></tr></tbody></table>
<p><strong>Benchmark Results</strong></p>
<table><thead><tr><th>Concurrent Jobs</th><th>Speed</th><th>CPU</th></tr></thead><tbody><tr><td>2</td><td>1.59x RT</td><td>94%</td></tr></tbody></table>
<hr>
<p><strong>Benchmark Finding:</strong><br>
<!-- -->The results show the <strong>c6a.16xlarge</strong> has higher overall throughput. This is expected as the instance has more
processing power than the <strong>c6a.4xlarge.</strong> However, if you take into account the cost per hour for each machine,
the more cost efficient option is to go with the c6a.4xlarge</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="14-cambria-application-access">1.4 Cambria Application Access<a href="#14-cambria-application-access" class="hash-link" aria-label="Direct link to 1.4 Cambria Application Access" title="Direct link to 1.4 Cambria Application Access">​</a></h2>
<p>The Cambria applications are accessible via the following methods:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="141-external-access-via-tcp-load-balancer">1.4.1 External Access via TCP Load Balancer<a href="#141-external-access-via-tcp-load-balancer" class="hash-link" aria-label="Direct link to 1.4.1 External Access via TCP Load Balancer" title="Direct link to 1.4.1 External Access via TCP Load Balancer">​</a></h3>
<p>The default Cambria installation configures the Cambria applications to be exposed through load balancers.
There is one for the Cambria Manager WebUI + License Manager, and one for the web / REST API server. The
load balancers are publicly available and can be accessed either through its public ip address or domain name,
and the application&#x27;s TCP port.</p>
<p>Examples:</p>
<ul>
<li>WebUI: <strong><a href="https://44.33.212.155:8161" target="_blank" rel="noopener noreferrer">https://44.33.212.155:8161</a></strong></li>
<li>REST API: <strong><a href="https://121.121.121.121:8650/CambriaFC/v1/SystemInfo" target="_blank" rel="noopener noreferrer">https://121.121.121.121:8650/CambriaFC/v1/SystemInfo</a></strong></li>
</ul>
<p>External access in this way can be turned on / off via a configuration variable. See 4.2. Creating and Editing
Helm Configuration File. If this feature is disabled, another method of access will need to be configured.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="142-http-ingress-via-reverse-proxy">1.4.2 HTTP Ingress via Reverse Proxy<a href="#142-http-ingress-via-reverse-proxy" class="hash-link" aria-label="Direct link to 1.4.2 HTTP Ingress via Reverse Proxy" title="Direct link to 1.4.2 HTTP Ingress via Reverse Proxy">​</a></h3>
<p>In cases where the external access via TCP load balancer is not acceptable or for using a purchased domain
name from servicers such as GoDaddy, the Cambria installation provides the option to expose an ingress.
Similar to the external access load balancers, the Cambria Manager WebUI and web / REST API server are
exposed. However, only one ip address / domain name is needed in this case.</p>
<p>How it works is that the Cambria WebUI is exposed through the subdomain <strong>webui</strong>, the Cambria web server
through the subdomain <strong>api</strong>, and Grafana dashboard through the subdomain monitoring. The following is an
example with the domain <strong>mydomain.com</strong></p>
<ul>
<li>Cambria Manager WebUI: <strong>webui.mydomain.com</strong></li>
<li>Cambria REST API: <strong>api.mydomain.com</strong></li>
<li>Grafana Dashboard: <strong>monitoring.mydomain.com</strong></li>
</ul>
<p>Capella provides a default ingress hostname for testing purposes only. In production, the default hostname, ssl
certificate, and other such information needs to be configured. More information about ingress configuration is
explained later in this guide.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="15-firewall-information">1.5 Firewall Information<a href="#15-firewall-information" class="hash-link" aria-label="Direct link to 1.5 Firewall Information" title="Direct link to 1.5 Firewall Information">​</a></h2>
<p>By default, this guide creates a kubernetes cluster with default settings which includes the default
network firewall configurations. In the default configuration, a virtual network is created alongside the
kubernetes cluster. For custom / non-default configurations, or to explore with a more restrictive network based
on the default virtual network created, the following is a list of known ports that the Cambria applications use:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-ports">Required Ports<a href="#required-ports" class="hash-link" aria-label="Direct link to Required Ports" title="Direct link to Required Ports">​</a></h3>
<p>| Port | Protocol | Traffic   Description                |
|------|----------|---------|--------------------|
| 8650 | TCP      | Inbound |Cluster REST API           |
| 8161 | TCP      | Inbound | Cluster WebUI              |
| 8678 | TCP      | Inbound | License Manager Web Server |
| 8481 | TCP      | Inbound | License Manager WebUI      |
| 9100 | TCP      | Inbound | Prometheus Exporter        |
| 8648 | TCP      | Inbound | FTC REST API               |
| 3100 | TCP      | Inbound | Loki                       |
| 3000 | TCP      | Inbound | Grafana                    |
| 443  | TCP      | Inbound | Ingress                    |
| ALL  | TCP/UDP  | Outbound| Outbound allowed           |</p>
<p>Also, for Cambria licensing, any Cambria Cluster and Cambria FTC machine requires that at least the following
domains be exposed in your firewall (both inbound and outbound traffic):</p>
<table><thead><tr><th>Domain</th><th>Port(s)</th><th>Protocol</th><th>Traffic Direction</th><th>Description</th></tr></thead><tbody><tr><td>api.cryptlex.com</td><td>443</td><td>TCP</td><td>Inbound / Outbound</td><td>License Server</td></tr><tr><td>cryptlexapi.capellasystems.net</td><td>8485</td><td>TCP</td><td>Inbound / Outbound</td><td>License Cache Server</td></tr><tr><td>cpfs.capellasystems.net</td><td>8483</td><td>TCP</td><td>Inbound / Outbound</td><td>License Backup Server</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="16-specifications-for-linux-deployment-server">1.6 Specifications for Linux Deployment Server<a href="#16-specifications-for-linux-deployment-server" class="hash-link" aria-label="Direct link to 1.6 Specifications for Linux Deployment Server" title="Direct link to 1.6 Specifications for Linux Deployment Server">​</a></h2>
<p>In order to deploy Cambria FTC, a Linux Deployment Server is required because this is where all of the tools,
dependencies, and packages for the Cambria FTC Kubernetes deployment will be installed and/or stored. If you
already have a deployment server, you can skip this section.</p>
<p><strong>Important: Linux Deployment Server Machine Information</strong>
The instructions in this document require IAM admin rights and IAM role assignment. For this purpose, it
is required to use an AWS EC2 instance (unless you already have a way to assign IAM roles to a machine that
is not an EC2 instance).</p>
<p>Capella tests deployment with the <strong>t3.small</strong> instance type</p>
<p><strong>Minimum Requirements:</strong>
|--------------------------------|---------|
| Operating System (OS)          | 443     |
| CPU(s)                         | 8485    |
| RAM                            | 8483    |
| Storage                        | 10 GB   |</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-prerequisites">2. Prerequisites<a href="#2-prerequisites" class="hash-link" aria-label="Direct link to 2. Prerequisites" title="Direct link to 2. Prerequisites">​</a></h2>
<p>The following steps need to be completed before the deployment process.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-linux-tools">2.1 Linux Tools<a href="#21-linux-tools" class="hash-link" aria-label="Direct link to 2.1 Linux Tools" title="Direct link to 2.1 Linux Tools">​</a></h3>
<p>This guide uses curl, unzip, and jq to run certain commands and download the required tools and applications.
Therefore, the Linux server used for deployment will need to have these tools installed.</p>
<p>Example with Ubuntu 24.04:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt update &amp;&amp; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::=&quot;--force-confold&quot; -y upgrade &amp;&amp; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::=&quot;--force-confold&quot; -y install curl unzip jq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>2.2 Cambria FTC Package</h1>
<p>The components of this installation are packaged in a zip archive. Download it using the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -o CambriaClusterKubernetesAws_5_6_0.zip -L &quot;https://www.dropbox.com/scl/fi/dtsqn334iu6e82atem5jy/CambriaClusterKubernetesAws_5_6_0.zip?rlkey=ds31kx7hgtuazidejxu64okpq&amp;st=4x3whwtv&amp;dl=1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">unzip -o CambriaClusterKubernetesAws_5_6_0.zip &amp;&amp; chmod +x *.sh ./bin/*.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Important:</em> the scripts included have been tested with Ubuntu. They may work with other Linux distributions
but not tested</p>
<h1>2.2.1 Kubernetes Tools: kubectl, helm, eksctl, aws-cli</h1>
<p>There are 2 options available for installing the kubernetes required tools for deployment to AWS:</p>
<p><em>Option 1:</em>  Use Installation Script (Verified on Ubuntu)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/installKubeTools.sh &amp;&amp; ./bin/installKubeToolsAws.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Option 2:</em> Other Installation Options</p>
<ol>
<li>Kubectl: <a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tools/</a></li>
<li>Helm: <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">https://helm.sh/docs/intro/install/</a></li>
<li>Eksctl: <a href="https://eksctl.io/installation/" target="_blank" rel="noopener noreferrer">https://eksctl.io/installation/</a></li>
<li>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html</a></li>
</ol>
<h1>2.2.2 Verification</h1>
<p>If any of the commands below fail, review the installation instructions for the failing tool and try again:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl version --client &amp;&amp; helm version &amp;&amp; eksctl version &amp;&amp; aws --version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>2.3 Create and Configure AWS Permissions</h1>
<p>In order to create resources on AWS for the kubernetes cluster, certain policies and roles need to be created and
configured.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="important-aws-admin-rights">Important: AWS Admin Rights<a href="#important-aws-admin-rights" class="hash-link" aria-label="Direct link to Important: AWS Admin Rights" title="Direct link to Important: AWS Admin Rights">​</a></h3>
<p>This section requires IAM administrative permission. The steps can be done manually using the AWS
Dashboard. However, the aws-cli will be used in this guide. To follow the exact steps, the <strong>Linux Deployment Server</strong> (in this case, an EC2 machine with the admin IAM role) and the aws-cli will be required.</p>
<ol>
<li>Create an IAM admin role (if not already done so)</li>
<li>On the AWS EC2 Dashboard, select the Linux Deployment Server created. Go to Actions &gt; Security &gt;
Modify IAM role and select the IAM admin role</li>
</ol>
<p>Before continuing, the AWS account id must be temporarily set as an environment variable to run the
commands in this section.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export AWS_ACCOUNT_ID=$(aws sts get-caller-identity --query &quot;Account&quot; --output text)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>2.3.1 Create Custom Policies</h1>
<p>The eksctl tool used for creating the kubernetes cluster requires certain permissions. This section will configure
those permissions that AWS doesn&#x27;t already manage as policies. For more details on eksctl policies, see
<a href="https://eksctl.io/usage/minimum-iam-policies/" target="_blank" rel="noopener noreferrer">https://eksctl.io/usage/minimum-iam-policies/</a></p>
<ol>
<li>Run the following command to create the EksAllAccess and IamLimitedAccess as mentioned in the eksctl
documentation</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/createEksctlCustomAwsPolicies.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>*If the policies were created successfully, a json description of each policy will be returned.
*Otherwise, verify the information is correct and retry. If the policies already exist, delete the old
*policies and create the new ones.</p>
<h1>2.3.2 Create and Assign eksctl Role</h1>
<p>In order to deploy the kubernetes cluster and run eksctl commands, the user of the Linux deployment machine
needs to be able to assume an AWS role with the minimum permissions per eksctl documentation:</p>
<ol>
<li>Create a new IAM role called eksctl-user with the following policies:</li>
</ol>
<ul>
<li>AmazonEC2FullAccess</li>
<li>AWSCloudFormationFullAccess</li>
<li>EksAllAccess</li>
<li>IamLimitedAccess</li>
</ul>
<p>*Needs administrative role and instance profile creation permissions</p>
<p>eksctl-user: the name of the role for deploying EKS clusters via eksctl. The name must start with eksctl- in
order for permissions to work</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/createEksctlClusterUserRole.sh eksctl-user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Assume the new role on the Linux deployment machine. If using an AWS EC2 instance, select the instance
and go to Actions &gt; Security &gt; Modify IAM role. Select the eksctl-user-instance-profile from the list</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-create-kubernetes-cluster">3. Create Kubernetes Cluster<a href="#3-create-kubernetes-cluster" class="hash-link" aria-label="Direct link to 3. Create Kubernetes Cluster" title="Direct link to 3. Create Kubernetes Cluster">​</a></h2>
<p>The following section provides the basic steps needed to create a Kubernetes Cluster on AWS.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-create-aws-eks-cluster-and-cambria-cluster-node-group">3.1. Create AWS EKS Cluster and Cambria Cluster Node Group<a href="#31-create-aws-eks-cluster-and-cambria-cluster-node-group" class="hash-link" aria-label="Direct link to 3.1. Create AWS EKS Cluster and Cambria Cluster Node Group" title="Direct link to 3.1. Create AWS EKS Cluster and Cambria Cluster Node Group">​</a></h2>
<ol>
<li>In a command line / terminal window, run the following command to create the base Kubernetes Cluster
(replace the highlighted values with those of your specific environment):</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="information--recommendation">Information / Recommendation<a href="#information--recommendation" class="hash-link" aria-label="Direct link to Information / Recommendation" title="Direct link to Information / Recommendation">​</a></h3>
<p>Cambria Cluster manages scheduling and handling Cambria FTC encoding / packaging programs. It is
important to think about how many programs you will be intended to run and choose an instance type
accordingly. The lowest recommended machine type for the manager machines is c7i.xlarge.</p>
<p>It is also recommended to set the node count to 3. This is because 1 of the nodes will act as the Cambria
Cluster node while the other 2 nodes act as backup (web server and database are replicated / duplicated).
In the case that the Cambria Cluster node goes down or stops responding, one of the other two nodes will
take over as the Cambria Cluster node. Depending on the desired workflow(s), think about how many
backup nodes may be needed</p>
<hr>
<ol>
<li>Set environment variables for the cluster</li>
</ol>
<ul>
<li>*--name=*cambria-cluster: Name of the Kubernetes Cluster</li>
<li>*--region=*us-west-2`: AWS region where the Cluster will run</li>
<li><em>--version=1.34:</em> Kubernetes version (recently tested: <strong>1.34</strong>)</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLUSTER_NAME=cambria-cluster REGION=us-west-2 KUBEVERSION=1.34</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Use kubectl to create the EKS cluster:</li>
</ol>
<p>*--nodes=*3: the number of nodes for the manager application. The recommended value is 3.</p>
<p><em>--instance-types</em>=c7i.xlarge: c7i.xlarge: the instance type for the manager application. The recommended type is
c7i.xlarge. Must be a x86-64 machine.</p>
<p>*--node-ami-family=*Ubuntu2404: what type of OS to install in the worker nodes. It is currently recommended
to use the Ubuntu2404 image. Capella has also tested with AmazonLinux2, but this image does not work with GPU.</p>
<p><em>--vpc-cidr=10.0.0.0/16:</em> the ip range for the VPC. This will depend on many factors such as number of instances, instance types, workflows. Omit this flag for the default VPC CIDR from eksctl. The lowest CIDR tested by Capella is /19.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create cluster \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--name=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--version=$KUBEVERSION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--kubeconfig=./$CLUSTER_NAME-kubeconfig.yaml \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--node-private-networking \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--nodegroup-name=manager-nodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--node-labels=&quot;capella-manager=true&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--with-oidc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--node-ami-family=Ubuntu2404 --nodes=3 --instance-types=c7i.xlarge --vpc-cidr=10.0.0.0/16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Set the kubeconfig as an environment variable:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export KUBECONFIG=$CLUSTER_NAME-kubeconfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Verify that the cluster and manager nodes are accessible:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get nodes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This should return something similar to the following. If it does not, verify the deployment information,
credentials, permissions, etc:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME STATUS ROLES AGE VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-10-0-12-44.us-west-2.compute.internal Ready &lt;none&gt; 118m v1.34.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-10-0-16-207.us-west-2.compute.internal Ready &lt;none&gt; 118m v1.34.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-10-0-22-84.us-west-2.compute.internal Ready &lt;none&gt; 118m v1.34.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Recommended: Ubuntu2404</p>
<p>AmazonLinux2 is supported but does not work with GPU</p>
<p>--vpc-cidr=10.0.0.0/16: VPC IP range</p>
<p>Omit this flag to use eksctl&#x27;s default</p>
<p>Lowest CIDR tested by Capella: /19</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create cluster \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --version=$KUBEVERSION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --kubeconfig=./$CLUSTER_NAME-kubeconfig.yaml \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --node-private-networking \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --nodegroup-name=manager-nodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --node-labels=&quot;capella-manager=true&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --with-oidc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --node-ami-family=Ubuntu2404 --nodes=3 --instance-types=c7i.xlarge --vpc-cidr=10.0.0.0/16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Set the kubeconfig as an environment variable</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export KUBECONFIG=$CLUSTER_NAME-kubeconfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Verify that the cluster and manager nodes are accessible</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get nodes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This should return something similar to the following. If it does not, verify the deployment information,
credentials, permissions, etc:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                                          STATUS   ROLES   AGE   VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-10-0-12-44.us-west-2.compute.internal      Ready    &lt;none&gt;  118m  v1.34.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-10-0-16-207.us-west-2.compute.internal     Ready    &lt;none&gt;  118m  v1.34.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-10-0-22-84.us-west-2.compute.internal      Ready    &lt;none&gt;  118m  v1.34.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-default-storage-class">3.2. Default Storage Class<a href="#32-default-storage-class" class="hash-link" aria-label="Direct link to 3.2. Default Storage Class" title="Direct link to 3.2. Default Storage Class">​</a></h3>
<p>Set gp2 as the default storage class:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl patch storageclass gp2 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p &#x27;{&quot;metadata&quot;: {&quot;annotations&quot;: {&quot;storageclass.kubernetes.io/is-default-class&quot;: &quot;true&quot;}}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-create-ebs-csi-driver">3.3. Create EBS CSI Driver<a href="#33-create-ebs-csi-driver" class="hash-link" aria-label="Direct link to 3.3. Create EBS CSI Driver" title="Direct link to 3.3. Create EBS CSI Driver">​</a></h3>
<ol>
<li>Create the IAM Role that will interact with AWS EBS CSI Driver to use volumes in the AWS Kubernetes environment (replace highlighted values):</li>
</ol>
<p>**--role-name=**eksctl-ebs-csi-driver-role</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create iamserviceaccount \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name=ebs-csi-controller-sa \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace=kube-system \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --cluster=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --role-only \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --attach-policy-arn=arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --approve \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --role-name=eksctl-ebs-csi-driver-role</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Add the AWS EBS CSI Driver to the Kubernetes Cluster</li>
</ol>
<p><strong>Important:</strong>
this step will install a plugin to handle volumes in AWS. This must be installed correctly and the
plugin must have an Active status before continuing. Otherwise, the Cambria product installation will always
fail. If this step fails, consider re-creating the Kubernetes cluster from scratch as the safest option</p>
<ul>
<li>eksctl-ebs-csi-driver-role: IAM Role created in Step 1</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create addon \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name aws-ebs-csi-driver \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --cluster=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --force \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --service-account-role-arn=arn:aws:iam::$AWS_ACCOUNT_ID:role/eksctl-ebs-csi-driver-role</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Run the following command to check on the state of the EBS CSI Driver plugin</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl get addon --name=aws-ebs-csi-driver --cluster=$CLUSTER_NAME --region=$REGION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="do-not-move-on-to-the-next-step-until-the-above-plugin-shows-active">DO NOT MOVE ON TO THE NEXT STEP UNTIL THE ABOVE PLUGIN SHOWS ‘ACTIVE’<a href="#do-not-move-on-to-the-next-step-until-the-above-plugin-shows-active" class="hash-link" aria-label="Direct link to DO NOT MOVE ON TO THE NEXT STEP UNTIL THE ABOVE PLUGIN SHOWS ‘ACTIVE’" title="Direct link to DO NOT MOVE ON TO THE NEXT STEP UNTIL THE ABOVE PLUGIN SHOWS ‘ACTIVE’">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-aws-iam-permissions-for-ftc">3.4. AWS IAM Permissions for FTC<a href="#34-aws-iam-permissions-for-ftc" class="hash-link" aria-label="Direct link to 3.4. AWS IAM Permissions for FTC" title="Direct link to 3.4. AWS IAM Permissions for FTC">​</a></h3>
<p>Certain permissions need to be added in order for functionality such as S3 reading / writing and the FTC autoscaler to work.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="341-create-ftc-role">3.4.1. Create FTC Role<a href="#341-create-ftc-role" class="hash-link" aria-label="Direct link to 3.4.1. Create FTC Role" title="Direct link to 3.4.1. Create FTC Role">​</a></h3>
<p>Cambria FTC needs special permissions to perform S3 read and write operations. For this, the Cambria FTC instances will need to assume a specific role with these permissions. Run the following script to create the role:</p>
<p>eksctl-ftc-role: the name of the IAM role for FTC in the kubernetes cluster. This name has to start with eksctl-, be unique to the EKS cluster, and be less than or equal to 64 characters</p>
<p>./config/ftcS3PermissionSample.json: this is the policy JSON file for the FTC instances. Capella provides this file as a sample which enables read, write, list for all S3 buckets. See AWS documentation for how to generate a policy for S3 needs.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/createRoleForFtcInstances.sh eksctl-ftc-role ./config/ftcS3PermissionSample.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="342-create-ftc-autoscaler-role">3.4.2. Create FTC Autoscaler Role<a href="#342-create-ftc-autoscaler-role" class="hash-link" aria-label="Direct link to 3.4.2. Create FTC Autoscaler Role" title="Direct link to 3.4.2. Create FTC Autoscaler Role">​</a></h3>
<p>Only run this if planning to use Cambria FTC&#x27;s autoscaler feature. For the FTC autoscaler to work, certain permissions need to be passed to the autoscaler container. Run the following script to create the role:</p>
<p>eksctl-autoscaler-role: the name of the IAM role for the FTC autoscaler. This name has to start with eksctl-, be unique to the EKS cluster, and be less than or equal to 64 characters</p>
<p>eksctl-autoscaler-cfg-role: the name of the IAM role for FTC autoscaler&#x27;s config. This name has to start with eksctl-, be unique to the EKS cluster, and be less than or equal to 64 characters</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/createRolesForFtcAutoscaler.sh eksctl-autoscaler-role eksctl-autoscaler-cfg-role</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-create-cambria-ftc-node-groups">3.5. Create Cambria FTC Node Group(s)<a href="#35-create-cambria-ftc-node-groups" class="hash-link" aria-label="Direct link to 3.5. Create Cambria FTC Node Group(s)" title="Direct link to 3.5. Create Cambria FTC Node Group(s)">​</a></h3>
<p>Skip this step if planning to use Cambria FTC&#x27;s autoscaler. Run the following command to create the Node Group for the worker application instances (replace the highlighted values to those of your specific environment):</p>
<h1>Information / Recommendation</h1>
<p>For this particular case, Cambria FTC nodes need to be added manually. Therefore, think about what machine / instance type will be needed for running the desired Cambria FTC workflows. Based on benchmarks (See 1.3. AWS Machine Information and Benchmark), the recommended machine / instance type to get started is c6a.4xlarge.</p>
<p>To get started, it is recommended to start with one instance. This way, when the installation is complete, there will already be one Cambria FTC instance to test with. The number of instances can always be scaled up and down, up to the maximum FTC instance count that will be configured in section 4.2. Creating and Editing Helm Configuration File.</p>
<p><em>--nodes=1:</em> the number of nodes that will be able to run the worker application. The recommended value is 1.</p>
<p><em>--instance-types=c</em>6a.4xlarge: the type of the worker application nodes. The recommended value is c6a.4xlarge. Must be an x86-64 machine.<br>
<!-- -->--node-ami-family=Ubuntu2404: what type of OS to install in the worker nodes. We currently recommend using the Ubuntu2404 image. Capella has also tested with AmazonLinux2, but this image does not work with GPU.</p>
<p><em>--node-ami-family=Ubuntu2404:</em> what type of OS to install in the worker nodes. We currently recommend
using the Ubuntu2404 image. Capella has also tested with AmazonLinux2, but this image does not work with GPU</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create nodegroup \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--name=worker-nodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--cluster=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--node-private-networking \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--node-labels=&quot;capella-worker=true&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--nodes=1 --instance-types=c6a.4xlarge --node-ami-family=Ubuntu2404</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>(Optional) If you want Cambria Cluster nodes to also be able to run encoding jobs, set this label on the Cambria Cluster nodegroup:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLUSTER_NAME=&lt;cluster_name&gt; REGION=&lt;region&gt;  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl set labels --cluster=$CLUSTER_NAME --region=$REGION --labels=&quot;capella-worker=true&quot; --nodegroup=manager-nodes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="36--beta--gpu-operator-for-nvenc">3.6. [ BETA ] GPU Operator for NVENC<a href="#36--beta--gpu-operator-for-nvenc" class="hash-link" aria-label="Direct link to 3.6. [ BETA ] GPU Operator for NVENC" title="Direct link to 3.6. [ BETA ] GPU Operator for NVENC">​</a></h3>
<p>This section is only required for a Kubernetes cluster that will use GPUs. Skip this step if GPUs will not be used in this Kubernetes cluster.</p>
<h1>Important: BETA Feature</h1>
<p>GPU can be used in Cambria Cluster/FTC. However, this feature is still a work in progress and may not function as expected.</p>
<h1>Limitation: Cambria FTC Autoscaler</h1>
<p>This feature currently does not work with the FTC autoscaler.</p>
<p>In your command prompt / terminal, run the following commands to deploy the GPU Operator to the Kubernetes
cluster:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">In your command prompt / terminal, run the following commands to deploy the GPU Operator to the Kubernetes cluster:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo add nvidia https://helm.ngc.nvidia.com/nvidia; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo update; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm install nvidia-operator nvidia/gpu-operator \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--create-namespace \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--namespace gpu-operator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>*Wait at least 5 minutes for the GPU operator to install completely.</p>
<p>Run this command with &#x27;kubectl&#x27; and make sure that all of the pods are in a Running or Completed state:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods -n gpu-operator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If any pod is still in an Init state or PodCreating state, wait another 5 minutes to see if the pods will complete their install process.</p>
<p>For any pods that are in an errored state or that are still in an Init state after 10 minutes, do the following:</p>
<p>a. Check that at least one node is one of the supported Akamai Cloud GPU instances<br>
<!-- -->b. Use the following command to check the state of a failing pod (check the Events section):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl describe pod &lt;your-pod-name&gt; -n gpu-operator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Either look up the error for a potential solution or send the entire Events section to the Capella support team for investigation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="37-application-ingress-ingress-nginx">3.7. Application Ingress: Ingress-Nginx<a href="#37-application-ingress-ingress-nginx" class="hash-link" aria-label="Direct link to 3.7. Application Ingress: Ingress-Nginx" title="Direct link to 3.7. Application Ingress: Ingress-Nginx">​</a></h3>
<p>By default, certain parts of the Cambria applications are exposed via an ingress. In order to access these, the ingress-nginx service needs to be created and attached to the ingress via a reverse-proxy.</p>
<ol>
<li>Run the following command:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.13.0/deploy/static/provider/aws/deploy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Verify that the resources are created and in an active / online state:</li>
</ol>
<ul>
<li>Pods should be in a <strong>Running</strong> STATUS and all containers in <strong>READY</strong> should be active</li>
<li>Services should have a <strong>CLUSTER-IP</strong> assigned. The <strong>ingress-nginx-controller</strong> should have an <strong>EXTERNAL-IP</strong></li>
<li>All other resources (replicasets, deployments, statefulsets, etc.) should have all desired resources active</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get all -n ingress-nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If any resources are still not ready, wait about a minute for them to complete. If still not complete, contact the Capella support team.</p>
<p><strong>For Production / Using Publicly Registered Domain Name and TLS Certificate.Example with Namecheap Registered Domain:</strong></p>
<h1>In AWS Route 53:</h1>
<ol>
<li>Go to the Route 53 console and create a <strong>Hosted Zone</strong> for your domain (mydomain.com)</li>
<li>After creating it, Route 53 will provide four <strong>Name Server (NS)</strong> addresses such as <code>ns-123.awsdns-01.com</code>. Copy these addresses.</li>
</ol>
<h1>In Namecheap Account:</h1>
<ol>
<li>Go to your Namecheap domain’s <strong>Manage</strong> page.</li>
<li>On the <strong>Domain</strong> tab, find the <strong>Nameservers</strong> section and change the dropdown from <strong>Namecheap BasicDNS</strong> to <strong>Custom DNS</strong>.</li>
<li>Paste the four Name Server addresses you copied from Route 53 into the fields provided, then click the green checkmark to save.</li>
</ol>
<h1>Wait for DNS Switchover</h1>
<p>This change can take anywhere from <strong>30 minutes to 48 hours</strong>. During this time, control of the domain&#x27;s DNS is being transferred to AWS.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-alias-record-in-route-53">Create the Alias Record in Route 53:<a href="#create-the-alias-record-in-route-53" class="hash-link" aria-label="Direct link to Create the Alias Record in Route 53:" title="Direct link to Create the Alias Record in Route 53:">​</a></h3>
<ol>
<li>
<p>Once the nameservers have updated, get the DNS name of the EKS cluster&#x27;s ingress:</p>
<p>a. Using kubectl, run the following command:</p>
<p>kubectl get ingress -n monitoring</p>
<p>b. You should see the DNS name of the ingress in the ADDRESS column. Example:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">af14406933b624f5a825626a491236af-de6fb9599822dfc6.elb.us-west-2.amazonaws.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>Navigate to the Route 53 service in the AWS Console.</p>
</li>
<li>
<p>In the navigation pane, click <strong>Hosted zones</strong>. Select the hosted zone for the domain you want to use (e.g., yourdomain.com).</p>
</li>
<li>
<p>Click <strong>Create record</strong> and configure the record as follows:</p>
<p><strong>Record name</strong><br>
<!-- -->Enter the subdomain <strong>monitoring</strong> (e.g., <em>monitoring</em> for monitoring.mydomain.com)</p>
<p><strong>Record type</strong><br>
<!-- -->Select <strong>A – Routes traffic to an IPv4 address and some AWS resources</strong></p>
<p><strong>Alias</strong><br>
<!-- -->Enable this toggle</p>
<p><strong>Route traffic to</strong><br>
<!-- -->Select <strong>Alias to Network Load Balancer</strong></p>
<p><strong>Region</strong><br>
<!-- -->Select the Network Load Balancer&#x27;s region</p>
<p><strong>Choose load balancer</strong><br>
<!-- -->Select the load balancer that matches the DNS name from step 1</p>
</li>
<li>
<p>Repeat step 4 for the following subdomains:</p>
<ul>
<li>api</li>
<li>webui</li>
<li>licenseui</li>
</ul>
</li>
</ol>
<p>If not working or unsure of how to do this, contact Capella support.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="38-performance-metrics-and-logging">3.8. Performance Metrics and Logging<a href="#38-performance-metrics-and-logging" class="hash-link" aria-label="Direct link to 3.8. Performance Metrics and Logging" title="Direct link to 3.8. Performance Metrics and Logging">​</a></h3>
<p>This section is required for logging and other performance information about the Cambria applications.</p>
<p>Follow the steps in the document below to install Prometheus, Grafana, Loki, and Promtail:</p>
<p><a href="https://www.dropbox.com/scl/fi/5z8e070qyrhh2g4mwq8fl/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_AWS_Kubernetes.pdf?rlkey=yukesitiwcevuld3mohjyjk16&amp;st=6d3da8g1&amp;dl=0" target="_blank" rel="noopener noreferrer">https://www.dropbox.com/scl/fi/5z8e070qyrhh2g4mwq8fl/Prometheus_Grafana_Setup_for_Cambria_Cluster_5_6_0_on_AWS_Kubernetes.pdf?rlkey=yukesitiwcevuld3mohjyjk16&amp;st=6d3da8g1&amp;dl=0</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-install-cambria-cluster-ftc-and-dependencies">4. Install Cambria Cluster, FTC, and Dependencies<a href="#4-install-cambria-cluster-ftc-and-dependencies" class="hash-link" aria-label="Direct link to 4. Install Cambria Cluster, FTC, and Dependencies" title="Direct link to 4. Install Cambria Cluster, FTC, and Dependencies">​</a></h3>
<h1>4.1. Prerequisite: Deploy External Kubernetes Tools</h1>
<p>There are a few tools that need to be deployed in order to make Cambria FTC / Cluster work properly.</p>
<ol>
<li>Run the following commands to deploy the pre-requisite tools for the Kubernetes cluster:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/deployCambriaKubeDependencies.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Verify that resources are created and in an active / online state:</li>
</ol>
<ul>
<li>Pods should be in a Running STATUS and all containers in READY should be active</li>
<li>Services should have a CLUSTER-IP assigned</li>
<li>All other resources (replicasets, deployments, statefulsets, etc.) should have all desired resources active</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get all -n cnpg-system; kubectl get all -n argo-events; kubectl get all -n cert-manager</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If any resources are still not ready, wait about a minute for them to complete. If still not working, contact the Capella support team.</p>
<h1>4.2. Creating and Editing Helm Configuration File</h1>
<p>With Helm and Kubectl installed on the Linux deployment server, create the Helm configuration file (yaml) that will be used to deploy Cambria Cluster / FTC to the Kubernetes environment.</p>
<ol>
<li>In a command line / terminal window, run the following command to create the configuration file:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm show values ./config/capella-cluster-0.5.4.tgz &gt; cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Open the configuration file in your favorite text / document editor and edit the following values:</li>
</ol>
<p>Example using nano:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">nano cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Values provided by Capella (release defaults)<br>
<!-- -->Values that <strong>must be customized</strong> for your specific environment</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cambriaclusterconfigyaml-explanation">cambriaClusterConfig.yaml Explanation<a href="#cambriaclusterconfigyaml-explanation" class="hash-link" aria-label="Direct link to cambriaClusterConfig.yaml Explanation" title="Direct link to cambriaClusterConfig.yaml Explanation">​</a></h3>
<table><thead><tr><th>Parameter</th><th>Example Value</th><th>Explanation</th></tr></thead><tbody><tr><td><strong>workersUseGPU</strong></td><td>workersUseGPU: false</td><td>Allow workers to use NVIDIA GPU. Set to <strong>true</strong> only when using GPU / NVENC workflows. Otherwise leave as false.</td></tr><tr><td><strong>nbGPUs</strong></td><td>nbGPUs: 1</td><td>Number of GPUs available on worker nodes. Only used when workersUseGPU = true. <strong>If more than 1 GPU</strong>, multi-GPU must be enabled in the Cambria license.</td></tr><tr><td><strong>enableManagerWebUI</strong></td><td>enableManagerWebUI: true</td><td>Enables the Cambria Manager WebUI. If you do not plan to use the UI, set this to false.</td></tr><tr><td><strong>ftcEnableAutoScaler</strong></td><td>ftcEnableAutoScaler: true</td><td>Enables Cambria FTC autoscaler, which spawns FTC encoders based on queue size. Set to false if adding FTC nodes manually.</td></tr><tr><td><strong>ftcEnableScriptableWorkflow</strong></td><td>ftcEnableScriptableWorkflow: true</td><td>Enables scriptable workflow execution for FTC jobs. Usually left true.</td></tr><tr><td><strong>ftcAutoScalerExtraConfig</strong></td><td>cpClusterName=cambria-cluster,<code>&lt;br/&gt;</code>cpCloudVendor=AWS,<code>&lt;br/&gt;</code>cpRegion=us-west-2,<code>&lt;br/&gt;</code>cpNodeRole=aws:iam::12341234<!-- -->:role<!-- -->/eksctl-autoscaler-cfg-role,<code>&lt;br/&gt;</code>cpCapacityType=dedicated</td><td>Extra config used when autoscaler is enabled.<code>&lt;br/&gt;``&lt;br/&gt;</code></td></tr><tr><td><strong>maxFTCInstances</strong></td><td>maxFTCInstances: 20</td><td>Maximum number of FTC encoder instances that can be created.</td></tr><tr><td><strong>pgInstances</strong></td><td>pgInstances: 3</td><td>Number of PostgreSQL replicas.</td></tr><tr><td><strong>cambriaClusterReplicas</strong></td><td>cambriaClusterReplicas: 3</td><td>Number of Cambria Cluster instances.<code>&lt;br/&gt;</code><strong>Must match pgInstances and manager node count.</strong></td></tr><tr><td><strong>externalAccess.exposeStreamServiceExternally</strong></td><td>exposeStreamServiceExternally: true</td><td>Set to true to access Cambria Cluster externally.</td></tr><tr><td><strong>externalAccess.enableIngress</strong></td><td>enableIngress: true</td><td>Enable NGINX ingress controller integration.</td></tr><tr><td><strong>externalAccess.hostName</strong></td><td>hostName: myhost.com</td><td>Hostname for ingress. Must be a valid domain name in production.</td></tr><tr><td><strong>externalAccess.acmeRegistrationEmail</strong></td><td>acmeRegistrationEmail: <a href="mailto:test@example.com" target="_blank" rel="noopener noreferrer">test@example.com</a></td><td>Email used by ACME for TLS certificate creation. Must be valid in production.</td></tr><tr><td><strong>externalAccess.acmeServer</strong></td><td>acmeServer: <a href="https://acme-staging-v02.api.letsencrypt.org/directory" target="_blank" rel="noopener noreferrer">https://acme-staging-v02.api.letsencrypt.org/directory</a></td><td>ACME server used for requesting certificates. Use staging for tests; production requires real Let&#x27;s Encrypt server.</td></tr><tr><td><strong>secrets.pgClusterPassword</strong></td><td>pgClusterPassword: &quot;xrtVeQ4nN82SSiYHoswqdURZ…&quot;</td><td>Password for the PostgreSQL cluster. <strong>Must be changed</strong> from the default.</td></tr><tr><td><strong>secrets.ftcLicenseKey</strong></td><td>ftcLicenseKey: &quot;2XXXXX-XXXXXX-XXXXXX-XXXXXX-XXXXXX-XXXXXX&quot;</td><td>FTC license key provided by Capella. Replace placeholder with your actual license.</td></tr><tr><td><strong>secrets.cambriaClusterAPIToken</strong></td><td>cambriaClusterAPIToken: &quot;12345678-1234-43f8-b4fc-53afd3893d5f&quot;</td><td>API token for Cambria Cluster API calls. Must contain letters, numbers, underscores, or dashes.</td></tr><tr><td><strong>secrets.cambriaClusterWebUIUser</strong></td><td>cambriaClusterWebUIUser: &quot;admin,defaultWebUIUser,RZvSSd3ffsElsCEEe9&quot;</td><td>Comma-separated list of WebUI users in the format: role,username,password.<code>&lt;br/&gt;``&lt;br/&gt;</code><strong>Roles:</strong> admin, user, viewer.<code>&lt;br/&gt;</code><strong>Example:</strong> admin,admin,changethis,user,guest,password123</td></tr><tr><td><strong>secrets.argoEventWebhookSourceBearerToken</strong></td><td>argoEventWebhookSourceBearerToken: &quot;L9Em5WIW8yth6H4uPtzT&quot;</td><td>Bearer token for argo-events workflows. Can be configured to any desired value.</td></tr><tr><td><strong>aws.role.ftc</strong></td><td>ftc: arn:aws:iam::12341234<!-- -->:role<!-- -->/eksctl-ftc-role</td><td>IAM role ARN for Cambria FTC. Must match the role created in <strong>3.4.1 Create FTC Role</strong>.</td></tr><tr><td><strong>aws.role.autoscaler</strong></td><td>autoscaler: arn:aws:iam::12341234<!-- -->:role<!-- -->/eksctl-autoscaler-role</td><td>IAM role ARN for the FTC autoscaler. Must match role created in <strong>3.4.2 Create FTC Autoscaler Role</strong>.</td></tr><tr><td><strong>optionalInstall.enableEventing</strong></td><td>enableEventing: true</td><td>Enables or disables argo-events functionality.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-installing-cambria-ftc--cluster">4.3. Installing Cambria FTC / Cluster<a href="#43-installing-cambria-ftc--cluster" class="hash-link" aria-label="Direct link to 4.3. Installing Cambria FTC / Cluster" title="Direct link to 4.3. Installing Cambria FTC / Cluster">​</a></h3>
<p>Wait at least 5 minutes after installing prerequisites before moving on to this step.</p>
<p>In a command line / terminal window, run the following command:</p>
<div class="language-basg codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-basg codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade --install capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The result of running the command should look something like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Release &quot;capella-cluster&quot; does not exist. Installing it now.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    NAME: capella-cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LAST DEPLOYED: Thu May  3 10:09:47 2023</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    NAMESPACE: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    STATUS: deployed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    REVISION: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TEST SUITE: None</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>At this point, several components are being deployed to the Kubernetes environment. Wait a few minutes for everything to be deployed.</p>
</li>
<li>
<p>Get important information about the Cambria Stream Manager deployment:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/getFtcInfo.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>
<p>At this point, the default VPC has been created for the EKS cluster, as well as the default security groups.<br>
<!-- -->See section 1.5. Firewall Information for the recommended Capella ports. These will be in addition to AWS-recommended ports.<br>
<!-- -->For more details:</p>
<p><a href="https://docs.aws.amazon.com/eks/latest/best-practices/network-security.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/best-practices/network-security.html</a></p>
</li>
</ol>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-verify-cambria-ftc--cluster-installation">5. Verify Cambria FTC / Cluster Installation<a href="#5-verify-cambria-ftc--cluster-installation" class="hash-link" aria-label="Direct link to 5. Verify Cambria FTC / Cluster Installation" title="Direct link to 5. Verify Cambria FTC / Cluster Installation">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-verify-cambria-cluster-deployment">5.1. Verify Cambria Cluster Deployment<a href="#51-verify-cambria-cluster-deployment" class="hash-link" aria-label="Direct link to 5.1. Verify Cambria Cluster Deployment" title="Direct link to 5.1. Verify Cambria Cluster Deployment">​</a></h3>
<p><strong>Important:</strong> The components below are only a subset of the whole installation. These are the components considered <strong>key</strong> to a proper deployment.</p>
<ol>
<li>Run the following command:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    kubectl get all -n default</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>Verify the following information:</p>
<p><strong>Deployments</strong></p>
<ul>
<li>1 deployment named <strong>cambriaclusterapp</strong>, all items active</li>
<li>1 deployment named <strong>cambriaclusterwebui</strong>, all items active</li>
</ul>
<p><strong>Pods</strong></p>
<ul>
<li>X pods with <strong>cambriaclusterapp</strong> in the name (X = number of replicas in config file), all items active / Running</li>
<li>1 pod with <strong>cambriaclusterwebui</strong> in the name</li>
</ul>
<p><strong>Services</strong></p>
<ul>
<li>1 service named <strong>cambriaclusterservice</strong><br>
<!-- -->If <code>exposeStreamServiceExternally = true</code>, this should have an <strong>EXTERNAL-IP</strong> assigned</li>
<li>1 service named <strong>cambriaclusterwebuiservice</strong><br>
<!-- -->If <code>exposeStreamServiceExternally = true</code>, this should have an <strong>EXTERNAL-IP</strong> assigned</li>
</ul>
</li>
<li>
<p>If any of the above are not in the expected state, wait a few more minutes in case some resources take longer than expected to complete. If issues persist, contact the Capella support team.</p>
</li>
<li>
<p>Run the following command for the pgcluster configuration:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    kubectl get all -n capella-database</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="5">
<li>
<p>Verify the following information:</p>
<p><strong>Pods</strong></p>
<ul>
<li>X pods with <strong>pgcluster</strong> in the name (X = number of replicas specified), all items active / Running</li>
</ul>
<p><strong>Services</strong></p>
<ul>
<li>3 services with <strong>pgcluster</strong> in the name, each with a <strong>CLUSTER-IP</strong> assigned</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-verify-cambria-ftc-deployment">5.2. Verify Cambria FTC Deployment<a href="#52-verify-cambria-ftc-deployment" class="hash-link" aria-label="Direct link to 5.2. Verify Cambria FTC Deployment" title="Direct link to 5.2. Verify Cambria FTC Deployment">​</a></h3>
<p>Important: The components below are only a subset of the whole installation. These are the components considered as key to a proper deployment.</p>
<ol>
<li>Run the following command:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    kubectl get all -n capella-worker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>Verify the following information:</p>
<p><strong>Pods</strong></p>
<ul>
<li>X pods with <strong>cambriaftcapp</strong> in the name (X = max number of FTCs specified in the config file)</li>
</ul>
<p><strong>Notes:</strong></p>
<ol>
<li>If using Cambria FTC autoscaler, all of these pods should be in a <strong>Pending</strong> state.<br>
<!-- -->Each time the autoscaler deploys a Cambria FTC node, one pod will be assigned to it.</li>
<li>If <strong>not</strong> using the autoscaler, Y pods should be <strong>Running</strong>, all containers active<br>
<!-- -->(Y = number of manually-created Cambria FTC nodes)</li>
</ol>
<p><strong>Deployments</strong></p>
<ul>
<li>1 deployment named <strong>cambriaftcapp</strong></li>
</ul>
</li>
<li>
<p>If any of the above are not in an expected state, wait a few more minutes in case some resources take longer than expected to complete. If after a few minutes there are still resources in an unexpected state, contact the Capellasupport team.</p>
</li>
</ol>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-verify-applications-are-accessible">5.3. Verify Applications are Accessible<a href="#53-verify-applications-are-accessible" class="hash-link" aria-label="Direct link to 5.3. Verify Applications are Accessible" title="Direct link to 5.3. Verify Applications are Accessible">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="531-cambria-cluster-webui">5.3.1. Cambria Cluster WebUI<a href="#531-cambria-cluster-webui" class="hash-link" aria-label="Direct link to 5.3.1. Cambria Cluster WebUI" title="Direct link to 5.3.1. Cambria Cluster WebUI">​</a></h3>
<p>Skip this step if the WebUI was disabled in the Helm values configuration file, or if ingress will be used instead.<br>
<!-- -->For any issues, contact the Capella support team.</p>
<ol>
<li>
<p>Get the WebUI address. A web browser is required to access the WebUI.</p>
<p><strong>Option 1: External URL (if External Access is Enabled)</strong><br>
<!-- -->Run:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get svc/cambriaclusterwebuiservice -n default -o=jsonpath=&quot;{&#x27;https://&#x27;}{.status.loadBalancer.ingress[0].hostname}{&#x27;:8161&#x27;}{&#x27;\n&#x27;}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example response:</p>
<p><a href="https://192.122.45.33:8161" target="_blank" rel="noopener noreferrer">https://192.122.45.33:8161</a></p>
<p><strong>Option 2: Non-External URL Access</strong><br>
<!-- -->Run the following command to temporarily expose the WebUI via port-forwarding:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        kubectl port-forward -n default svc/cambriaclusterwebuiservice 8161:8161 --address=0.0.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The url depends on the location of the web browser. If the web browser and the port-forward are on the same machine, use localhost. Otherwise, use the ip address of the machine with the port-forward:</p>
<ul>
<li>If browser is on the same machine:<br>
<a href="https://localhost:8161" target="_blank" rel="noopener noreferrer">https://localhost:8161</a></li>
<li>If remote:<br>
<!-- -->https://<code>&lt;server&gt;</code>:8161</li>
</ul>
<ol start="2">
<li>In a web browser, enter the above URL. This will trigger an “Unsafe” page similar to what is shown in the installation guide.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Screenshot" src="/assets/images/01_screenshot-2a06a001da2a4bf44da256639f520585.png" width="533" height="357" class="img_ev3q"></p>
<ol start="3">
<li>Click on Advanced and Proceed to [ EXTERNAL IP ] (unsafe). This will show the login page.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Screenshot" src="/assets/images/02_screenshot-2881561f1ce767fe394d2334b5f4445c.png" width="1184" height="159" class="img_ev3q"></p>
<ol start="4">
<li>Log in using the credentials created in the Helm values yaml file (see cambriaClusterWebUIUser)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="532-cambria-cluster-rest-api">5.3.2. Cambria Cluster REST API<a href="#532-cambria-cluster-rest-api" class="hash-link" aria-label="Direct link to 5.3.2. Cambria Cluster REST API" title="Direct link to 5.3.2. Cambria Cluster REST API">​</a></h3>
<p>Skip this step if the ingress will be used instead of external access or any other type of access. For any issues, contact the Capella support team.</p>
<ol>
<li>
<p>Get the REST API address:</p>
<p><strong>Option 1: External URL (if External Access is Enabled)</strong><br>
<!-- -->Run:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get svc/cambriaclusterservice -n default -o=jsonpath=&quot;{&#x27;https://&#x27;}{.status.loadBalancer.ingress[0].hostname}{&#x27;:8650&#x27;}{&#x27;\n&#x27;}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example response:</p>
<p><a href="https://192.122.45.33:8650" target="_blank" rel="noopener noreferrer">https://192.122.45.33:8650</a></p>
<p><strong>Option 2: Non-External URL Access</strong><br>
<!-- -->Run the following command to temporarily expose the REST API via port-forwarding:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        kubectl port-forward -n default svc/cambriaclusterservice 8650:8650 --address=0.0.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The url depends on the location of the port-forward. If the web browser and the port-forward are on the
same machine, use localhost. Otherwise, use the ip address of the machine with the port-forward:</p>
<p>https://<code>&lt;server&gt;</code>:8650</p>
<ol start="2">
<li>Run the following API query to check if the REST API is active:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -k -X GET https://`&lt;server&gt;`:8650/CambriaFC/v1/SystemInfo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="533-cambria-license">5.3.3. Cambria License<a href="#533-cambria-license" class="hash-link" aria-label="Direct link to 5.3.3. Cambria License" title="Direct link to 5.3.3. Cambria License">​</a></h3>
<p>The Cambria license must be active in all entities where the Cambria application is deployed. A web browser is required.</p>
<ol>
<li>
<p>Get the URL for the License Manager WebUI:</p>
<p><strong>Option 1: External URL (if External Access is Enabled)</strong><br>
<!-- -->Run:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get svc/cambriaclusterwebuiservice -n default -o=jsonpath=&quot;{&#x27;https://&#x27;}{.status.loadBalancer.ingress[0].hostname}{&#x27;:8481&#x27;}{&#x27;\n&#x27;}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example response:</p>
<p><a href="https://192.122.45.33:8481" target="_blank" rel="noopener noreferrer">https://192.122.45.33:8481</a></p>
<p><strong>Option 2: Non-External URL Access</strong><br>
<!-- -->Run the following command to temporarily expose the License WebUI via port-forwarding:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        kubectl port-forward -n default svc/cambriaclusterwebuiservice 8481:8481 --address=0.0.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The url depends on the location of the port-forward. If the web browser and the port-forward are on the
same machine, use <strong>localhost.</strong> Otherwise, use the <strong>ip address</strong> of the machine with the port-forward:</p>
<p>https://<code>&lt;server&gt;</code>:8481</p>
<ol start="2">
<li>In a web browser, enter the above URL. This should trigger an “Unsafe” SSL warning page, as expected for self-signed certificates used in testing.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Screenshot" src="/assets/images/03_screenshot-3f6cff6b1ae76e05f7d18f4d6235fb11.png" width="554" height="382" class="img_ev3q"></p>
<ol start="3">
<li>Click on Advanced and Proceed to [ EXTERNAL IP ] (unsafe). This will show the login page.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Screenshot" src="/assets/images/04_screenshot-44b1b704a18082ab1af2c4afc531dabb.png" width="1573" height="116" class="img_ev3q"></p>
<ol start="4">
<li>
<p>Log in using the credentials created in the Helm values yaml file (See cambriaClusterWebUIUser)</p>
</li>
<li>
<p>Verify that the License Status is valid for at least either the Primary or Backup. Preferably, both Primary and
Backup should be valid. If there are issues with the license, wait a few minutes as sometimes it takes a few minutes
to properly update. If still facing issues, contact the Capella support team.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="534-cambria-ingress">5.3.4. Cambria Ingress<a href="#534-cambria-ingress" class="hash-link" aria-label="Direct link to 5.3.4. Cambria Ingress" title="Direct link to 5.3.4. Cambria Ingress">​</a></h3>
<p>Skip this step if not planning to test with Cambria&#x27;s ingress. For any issues, contact the Capella support team.</p>
<h1>5.3.4.1. Get the Ingress Endpoints</h1>
<p>There are two ways to use the ingress:</p>
<p><strong>Option 1: Using Default Testing Ingress</strong><br>
<!-- -->Only use this option for testing purposes. Skip to option 2 for production.<br>
<!-- -->For testing, the hostname must be DNS resolvable on the machines that need access to Cambria applications.</p>
<ol>
<li>Get the ingress HOSTS and ADDRESS:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get ingress -A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example output:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        NAMESPACE   NAME                    CLASS   HOSTS                                   ADDRESS                                                                     PORTS        AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default     cambriaclusteringress  nginx   api.awscapellatest.com,webui.awscapellatest.com  a1657b4eb1fad4693ae75491619b242c-b4207eb1ce094c06.elb.us-west-2.amazonaws.com   80, 443     23m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        monitoring  cambriamonitoringingress nginx monitoring.myhost.com  a1657b4eb1fad4693ae75491619b242c-b4207eb1ce094c06.elb.us-west-2.amazonaws.com 80, 443     58m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Since AWS uses <strong>hostnames</strong> instead of IP addresses for ingress, resolve the hostname to an IP:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ping a1c1d1a23a121.us-west-2.elb.amazonaws.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>On all machines that need access to the ingress, edit the hosts file (Linux: <code>/etc/hosts</code>):</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        55.99.103.99 api.myhost.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        55.99.103.99 webui.myhost.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        55.99.103.99 monitoring.myhost.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Option 2: Using Publicly Registered Domain (Production)</strong><br>
<!-- -->Contact Capella if unable to set up a purchased domain with the ingress.<br>
<!-- -->If the domain has been configured, the required endpoints are:</p>
<p>Example for domain <strong>mydomain.com</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">- REST API: https://api.myhost.com  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- WebUI: https://webui.myhost.com  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Grafana Dashboard: https://monitoring.myhost.com  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>5.3.4.2. Test Ingress Endpoints</h1>
<p>If using the test ingress, these steps only work on machines that had their hosts file modified.<br>
<!-- -->The test ingress is not publicly DNS resolvable.</p>
<ol>
<li>
<p>Test Cambria Cluster WebUI (endpoint begins with <strong>webui</strong>).<br>
<!-- -->Follow steps 2–3 of section <strong>5.3.1. Cambria Cluster WebUI</strong>.</p>
<p>Example:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        https://webui.myhost.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>Test Cambria REST API (endpoint begins with <strong>api</strong>).<br>
<!-- -->Follow step 2 of <strong>5.3.2. Cambria Cluster REST API</strong>.</p>
<p>Example:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        https://api.myhost.com/CambriaFC/v1/SystemInfo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>
<p>Test Grafana Dashboard (endpoint begins with <strong>monitoring</strong>).<br>
<!-- -->Use the Grafana verification steps in section <strong>1.4. Verify Grafana Deployment</strong> of the document referenced in <strong>3.7. Performance Metrics and Logging</strong>.</p>
<p>Example:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        https://monitoring.myhost.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-testing-cambria-ftc--cluster">6. Testing Cambria FTC / Cluster<a href="#6-testing-cambria-ftc--cluster" class="hash-link" aria-label="Direct link to 6. Testing Cambria FTC / Cluster" title="Direct link to 6. Testing Cambria FTC / Cluster">​</a></h3>
<p>The following guide provides information on how to get started testing the Cambria FTC / Cluster software:</p>
<p><a href="https://www.dropbox.com/scl/fi/ymu5fln1n811a1i92radv/Cambria_Cluster_and_FTC_5_6_0_Kubernetes_User_Guide.pdf?rlkey=cd0unkt9hcs3mhjp1fjbcvi9n&amp;st=fb030h8o&amp;dl=0" target="_blank" rel="noopener noreferrer">https://www.dropbox.com/scl/fi/ymu5fln1n811a1i92radv/Cambria_Cluster_and_FTC_5_6_0_Kubernetes_User_Guide.pdf?rlkey=cd0unkt9hcs3mhjp1fjbcvi9n&amp;st=fb030h8o&amp;dl=0</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-updating--upgrading-cambria-cluster--ftc">7. Updating / Upgrading Cambria Cluster / FTC<a href="#7-updating--upgrading-cambria-cluster--ftc" class="hash-link" aria-label="Direct link to 7. Updating / Upgrading Cambria Cluster / FTC" title="Direct link to 7. Updating / Upgrading Cambria Cluster / FTC">​</a></h3>
<p>There are two ways to update / upgrade Cambria FTC / Cluster in the Kubernetes environment.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-option-1-normal-upgrade-via-helm-upgrade">7.1. Option 1: Normal Upgrade via Helm Upgrade<a href="#71-option-1-normal-upgrade-via-helm-upgrade" class="hash-link" aria-label="Direct link to 7.1. Option 1: Normal Upgrade via Helm Upgrade" title="Direct link to 7.1. Option 1: Normal Upgrade via Helm Upgrade">​</a></h3>
<p>Best for version changes, secret updates (license key, WebUI users), or configuration changes (replicas, max pods, etc.).</p>
<p><strong>Warning: Known Issues</strong></p>
<ul>
<li>postgres password (<strong>pgClusterPassword</strong>) cannot currently be updated via this method</li>
<li>postgres version also cannot be changed via this method</li>
</ul>
<ol>
<li>
<p>Edit your existing Helm values file or create a new one.<br>
<!-- -->See section <strong>4.2. Creating and Editing Helm Configuration File</strong>.</p>
</li>
<li>
<p>Apply the upgrade:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Restart the deployments:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl rollout restart deployment cambriaclusterapp cambriaclusterwebui -n default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl rollout restart deployment cambriaftcapp -n capella-worker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Wait a few minutes for pods to restart.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-option-2-upgrade-via-cambria-cluster-reinstallation">7.2. Option 2: Upgrade via Cambria Cluster Reinstallation<a href="#72-option-2-upgrade-via-cambria-cluster-reinstallation" class="hash-link" aria-label="Direct link to 7.2. Option 2: Upgrade via Cambria Cluster Reinstallation" title="Direct link to 7.2. Option 2: Upgrade via Cambria Cluster Reinstallation">​</a></h3>
<p>For any upgrade cases for the Cambria Cluster | Cambria FTC environment, this is the most reliable option. This
upgrade option basically uninstalls all of the Cambria FTC and Cluster components and then reinstall with the
new Helm chart and values (.yaml) file. As a result, this will delete the database and delete all of your
jobs in the Cambria Cluster UI.</p>
<ol>
<li>
<p>Follow section 4.2. Creating and Editing Helm Configuration File to download and edit your new <strong>cambriaClusterConfig.yaml file.</strong></p>
</li>
<li>
<p>In a command line / terminal window in your local server, run the following command:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm uninstall capella-cluster --wait</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Deploy the Helm configuration file with the following command</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade --install capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="73-upgrade-verification">7.3. Upgrade Verification<a href="#73-upgrade-verification" class="hash-link" aria-label="Direct link to 7.3. Upgrade Verification" title="Direct link to 7.3. Upgrade Verification">​</a></h3>
<p>The best way to verify the upgrade is to use the steps in 5.0. Verify Cambria FTC / Cluster Installation. For any
issues, contact the Capella support team.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-deleting-kubernetes-cluster">8. Deleting Kubernetes Cluster<a href="#8-deleting-kubernetes-cluster" class="hash-link" aria-label="Direct link to 8. Deleting Kubernetes Cluster" title="Direct link to 8. Deleting Kubernetes Cluster">​</a></h3>
<p>Many resources are created in a Kubernetes environment. It is important that each step is followed carefully: If using FTC&#x27;s autoscaler, make sure no leftover Cambria FTC nodes are running.</p>
<ol>
<li>Run the following command to remove the Helm deployments:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm uninstall capella-cluster -n default --wait</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>If any volumes are remaining, run the following command:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pv -o name | awk -F&#x27;/&#x27; &#x27;{print $2}&#x27; | xargs -I{} kubectl patch pv {} -p=&#x27;{&quot;spec&quot;: {&quot;persistentVolumeReclaimPolicy&quot;: &quot;Delete&quot;}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Only if the ingress-nginx tool was deployed, delete the namespace:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete namespace ingress-nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>
<p>Run the following commands to uninstall the monitoring deployment:</p>
<p><strong><code>&lt;install_type&gt;</code></strong>: the Loki install type.</p>
<ul>
<li>If S3 Loki version was installed → use <strong>s3_embedcred</strong></li>
<li>If Filesystem Loki version was installed → use <strong>local</strong></li>
</ul>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/quickDestroyMonitoring.sh `&lt;install_type&gt;`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="5">
<li>Set the Kubernetes cluster name and region as environment variables (if not already done):</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLUSTER_NAME=cambria-cluster REGION=us-west-2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="6">
<li>Delete the inline policy for the FTC role:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws iam delete-role-policy --role-name=eksctl-ftc-role --policy-name=S3AccessPolicy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="7">
<li>If using FTC&#x27;s autoscaler, delete the inline policy for the autoscaler role:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws iam delete-role-policy --role-name=eksctl-autoscaler-role --policy-name=FTCAutoscalerPolicy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="8">
<li>If using FTC&#x27;s autoscaler, delete the autoscaler config role created for the cluster. This can be done manually or via aws-cli. Example:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/deleteConfigRoleForFtcAutoscaler.sh eksctl-autoscaler-cfg-role</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="9">
<li>Delete the Kubernetes cluster:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl delete cluster --name=$CLUSTER_NAME --region=$REGION --wait</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Wait several minutes for the Kubernetes cluster to delete completely.</p>
<ol start="10">
<li>
<p>To verify that the cluster was deleted, log in to the AWS Console with an IAM user that has EKS permissions. Check the following:</p>
<p>a. Search for <strong>Elastic Kubernetes Service</strong> in the region where the cluster was located.<br>
<!-- -->Confirm that the deleted cluster no longer appears in the list.</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Screenshot" src="/assets/images/05_screenshot-7f022d52d49f14e365ba9c71ed7dfe55.png" width="1336" height="392" class="img_ev3q"></p>
<p>b. Search for CloudFormation in the region that the Kubernetes Cluster is located. Make sure there are no stacks specific to the Kubernetes Cluster on the list</p>
<p><img decoding="async" loading="lazy" alt="Screenshot" src="/assets/images/06_screenshot-b468a9f83a9a795458f7f27e12a9ab60.png" width="1374" height="383" class="img_ev3q"></p>
<p>c. Important: Check in <strong>EC2 Volumes</strong> and <strong>Load Balancers</strong> to make sure no volumes or load balancers were leftover from the Kubernetes cluster.<br>
<!-- -->Most AWS resources will include the EKS cluster name in their resource names.</p>
<ol start="11">
<li>(Optional) If you also want to delete the role created for the EKS setup, do the following:<br>
<!-- -->Requires IAM admin permissions.</li>
</ol>
<p>a. Switch the Linux Deployment Server EC2 instance to assume an IAM admin role.<br>
<!-- -->b. In an SSH session on the Linux Deployment Server, go to the location of the Cambria FTC package (see section 2.2. Cambria FTC Package).<br>
<!-- -->c. Run the following command with the name of the IAM role to delete:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/deleteRole.sh eksctl-user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-quick-reference-installation-testing-and-teardown">9. Quick Reference: Installation, Testing, and Teardown<a href="#9-quick-reference-installation-testing-and-teardown" class="hash-link" aria-label="Direct link to 9. Quick Reference: Installation, Testing, and Teardown" title="Direct link to 9. Quick Reference: Installation, Testing, and Teardown">​</a></h3>
<h1>9.1. Installation (Deploy from Linux to Oracle Kubernetes)</h1>
<p>This installation will be basic and not include optional content.<br>
<!-- -->For any optional components, review the detailed steps in previous sections.</p>
<h1>9.1.1. Prerequisites and Administration</h1>
<p>Review and execute the steps in <strong>section 2. Prerequisites</strong>.</p>
<h1>9.1.2. Cambria FTC Package</h1>
<p>The instructions below install the default Kubernetes components, including the default OKE VNC.
Optional components like Labeling will not be configured. For any deviations or help, consult sections 1-4.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt update &amp;&amp; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::=&quot;--force-confold&quot; -y upgrade &amp;&amp; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo DEBIAN_FRONTEND=noninteractive apt -o Dpkg::Options::=&quot;--force-confold&quot; -y install curl unzip jq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Download the package:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -o CambriaClusterKubernetesAws_5_6_0.zip -L &quot;https://www.dropbox.com/scl/fi/dtsqn334iu6e82atem5jy/CambriaClusterKubernetesAws_5_6_0.zip?rlkey=ds31kx7hgtuazidejxu64okpq&amp;st=4x3whwtv&amp;dl=1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">unzip -o CambriaClusterKubernetesAws_5_6_0.zip &amp;&amp; chmod +x *.sh ./bin/*.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>9.1.3. IAM Administrator Required Steps</h1>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export AWS_ACCOUNT_ID=$(aws sts get-caller-identity --query &quot;Account&quot; --output text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/createEksctlCustomAwsPolicies.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/createEksctlClusterUserRole.sh eksctl-user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>9.1.4. Installation</h1>
<p>Make sure the Linux deployment machine is assuming the IAM admin role created in <strong>9.1.3. IAM
Administrator Required Steps.</strong>.</p>
<p>The instructions below install the default Kubernetes components, including the default eksctl VPC.
Optional components like GPU and Labeling will not be configured. For any deviations or help,
consult sections 1-4.</p>
<ol>
<li>Set environment variables:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLUSTER_NAME=cambria-cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export REGION=us-west-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export KUBEVERSION=1.34</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CAMBRIA_CLUSTER_NODE_COUNT=3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CAMBRIA_CLUSTER_INSTANCE_TYPE=c7i.xlarge</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export EBS_CSI_CONTROLLER_ROLE_NAME=eksctl-ebs-csi-driver-role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export FTC_ROLE_NAME=eksctl-ftc-role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export FTC_ROLE_POLICY_JSON=ftcS3PermissionSample.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export AUTOSCALER_ROLE_NAME=eksctl-autoscaler-role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export AUTOSCALER_CONFIG_ROLE_NAME=eksctl-autoscaler-cfg-role</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Get the Cambria Cluster Helm values and configure in a text editor. See section 4.2. Creating and Editing
Helm Configuration File for details about the Helm values configuration:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm show values ./config/capella-cluster-0.5.4.tgz &gt; cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Run the following commands to deploy the cluster:</li>
</ol>
<p>Deploy the EKS cluster:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        eksctl create cluster \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --name=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --version=$KUBEVERSION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --kubeconfig=./$CLUSTER_NAME-kubeconfig.yaml \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --node-private-networking \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --nodegroup-name=manager-nodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --node-labels=&quot;capella-manager=true&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --with-oidc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --node-ami-family=Ubuntu2404 --nodes=3 --instance-types=c7i.xlarge --vpc-cidr=10.0.0.0/16</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export KUBECONFIG=$CLUSTER_NAME-kubeconfig.yaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        eksctl create iamserviceaccount \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --name=ebs-csi-controller-sa \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --namespace=kube-system \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --cluster=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --role-only \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --attach-policy-arn=arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --approve \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --role-name=eksctl-ebs-csi-driver-role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        eksctl create addon \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --name aws-ebs-csi-driver \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --cluster=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --force \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --service-account-role-arn=arn:aws:iam::$AWS_ACCOUNT_ID:role/eksctl-ebs-csi-driver-role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Only if using FTC autoscaler:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ./bin/createRoleForFtcInstances.sh eksctl-ftc-role ./config/ftcS3PermissionSample.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ./bin/createRolesForFtcAutoscaler.sh eksctl-autoscaler-role eksctl-autoscaler-cfg-role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Only if NOT using the FTC autoscaler:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        eksctl create nodegroup \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --name=worker-nodes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --cluster=$CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --region=$REGION \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --node-private-networking \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --node-labels=&quot;capella-worker=true&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        --nodes=1 --instance-types=c6a.4xlarge --node-ami-family=Ubuntu2404</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Deploy the monitoring system:</li>
</ol>
<p><strong>Option 1: S3 Loki Logs</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export LOG_RETENTION_PERIOD=7d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export LOKI_BUCKET=my-bucket-name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export LOKI_REGION=us-west-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export LOKI_ROLE_NAME=capella-loki-storage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export REPLICAS=2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export GRAFANA_PASSWORD=prom-capellaPsw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export MONITORING_INGRESS_HOST=myhost.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ./bin/quickInstallMonitoring.sh s3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Option 2: Local / Filesystem Logs</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export STORAGE_SIZE=100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export GRAFANA_PASSWORD=prom-capellaPsw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        export MONITORING_INGRESS_HOST=myhost.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ./bin/quickInstallMonitoring.sh local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="5">
<li>Deploy Cambria Cluster and Dependencies:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.13.0/deploy/static/provider/aws/deploy.yaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ./bin/deployCambriaKubeDependencies.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        helm upgrade --install capella-cluster ./config/capella-cluster-0.5.4.tgz --values cambriaClusterConfig.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="6">
<li>Perform verification steps from section 5. Verify Cambria FTC / Cluster Installation</li>
</ol>
<hr>
<h1>9.2. Upgrades and Teardown</h1>
<h1>9.2.1. Cambria FTC | Cambria Cluster and/or the Kubernetes Cluster Upgrades</h1>
<p>Edit the <strong>cambriaClusterConfig.yaml</strong> file and run the following command<br>
<!-- -->(see section 7. Updating / Upgrading Kubernetes Cluster for warnings):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./quickUpgradeCambriaCluster.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>9.2.2. Cambria FTC | Cambria Cluster Uninstall</h1>
<p>If just wanting to uninstall Cambria Cluster and Cambria FTC, run the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm uninstall capella-cluster --wait</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>9.2.3. Kubernetes Cluster Teardown</h1>
<p>Since teardown involves multiple components, follow the steps in:<br>
<strong>section 8. Deleting Kubernetes Cluster</strong></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-quick-reference-helpful-commands--info-for-after-installation">10. Quick Reference: Helpful Commands / Info for After Installation<a href="#10-quick-reference-helpful-commands--info-for-after-installation" class="hash-link" aria-label="Direct link to 10. Quick Reference: Helpful Commands / Info for After Installation" title="Direct link to 10. Quick Reference: Helpful Commands / Info for After Installation">​</a></h3>
<p>This section provides helpful commands and other information that may be useful after the installation process such as how to get the WebUI address, what ports are available to use for incoming sources, etc.</p>
<h1>General Cambria FTC Deployment Information</h1>
<p>Requires the Cambria FTC Package from <strong>section 2.2</strong> and all prerequisites.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/getFtcInfo.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Setting Cambria FTC Label on New Nodes</h1>
<p>For any node that should be an encoding node:</p>
<ol>
<li>List nodes:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get nodes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Apply the worker label:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl label node `&lt;node-name&gt;` capella-worker=true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Setting Cambria Cluster Label on New Nodes</h1>
<p>For any node that should be a manager node or backup:</p>
<ol>
<li>List nodes:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get nodes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Apply the manager label:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl label node `&lt;node-name&gt;` capella-manager=true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Set Cambria Cluster (Manager) Label to All Nodes in Nodegroup</h1>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLUSTER_NAME=`&lt;cluster_name&gt;` REGION=`&lt;region&gt;` NODE_GROUP=`&lt;node_group&gt;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl set labels --cluster=$CLUSTER_NAME --region=$REGION --labels=&quot;capella-manager=true&quot; --nodegroup=$NODE_GROUP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Set Cambria FTC (Encoder) Label to All Nodes in Nodegroup</h1>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export CLUSTER_NAME=`&lt;cluster_name&gt;` REGION=`&lt;region&gt;` NODE_GROUP=`&lt;node_group&gt;`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl set labels --cluster=$CLUSTER_NAME --region=$REGION --labels=&quot;capella-worker=true&quot; --nodegroup=$NODE_GROUP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>AWS Kubernetes Kubeconfig File (for use with kubectl)</h1>
<p>Using the aws-cli:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws eks update-kubeconfig --name=CapellaEKS --region=us-west-2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cambria-cluster-webui">Cambria Cluster WebUI<a href="#cambria-cluster-webui" class="hash-link" aria-label="Direct link to Cambria Cluster WebUI" title="Direct link to Cambria Cluster WebUI">​</a></h3>
<ol>
<li>Run the following command to get the WebUI address:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get service/cambriaclusterwebuiservice -n default -o=jsonpath=&quot;{&#x27;https://&#x27;}{.status.loadBalancer.ingress[0].hostname}{&#x27;:8161&#x27;}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>To log in to the WebUI, the credentials are located in the Helm values .yaml file that you configured (see section 4.2. Creating and Editing Helm Configuration File).</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cambria-cluster-rest-api">Cambria Cluster REST API<a href="#cambria-cluster-rest-api" class="hash-link" aria-label="Direct link to Cambria Cluster REST API" title="Direct link to Cambria Cluster REST API">​</a></h2>
<ol>
<li>Run the following command to get the base REST API Web Address:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get service/cambriaclusterservice -n default -o=jsonpath=&quot;{&#x27;https://&#x27;}{.status.loadBalancer.ingress[0].hostname}{&#x27;:8650&#x27;}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Example REST API URL:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">https://a7e4559218cg923a8dfc85d689bd9713-329199856.us-west-2.elb.amazonaws.com:8650/CambriaFC/v1/Jobs?usertoken=12345678-1234-43f8-b4fc-53afd3893d5f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="leader-cambria-cluster-pod">Leader Cambria Cluster Pod<a href="#leader-cambria-cluster-pod" class="hash-link" aria-label="Direct link to Leader Cambria Cluster Pod" title="Direct link to Leader Cambria Cluster Pod">​</a></h2>
<p>Run the following command to get the name of the Cambria Cluster leader pod:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get lease -o=jsonpath=&quot;{.items[0].spec.holderIdentity}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cambria-ftc-instance-external-ip">Cambria FTC Instance External IP<a href="#cambria-ftc-instance-external-ip" class="hash-link" aria-label="Direct link to Cambria FTC Instance External IP" title="Direct link to Cambria FTC Instance External IP">​</a></h3>
<ol>
<li>
<p>In the Cambria Cluster WebUI, go to the Machines tab and copy the name of the machine (pod).</p>
</li>
<li>
<p>Run the following commands with the pod name:</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get node/$(kubectl get pod/pod name -n capella-worker -o=jsonpath={.spec.nodeName}) -o=jsonpath=&quot;{.status.addresses[1].address}{&#x27;\n&#x27;}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remote-access-to-kubernetes-pod">Remote Access to Kubernetes Pod<a href="#remote-access-to-kubernetes-pod" class="hash-link" aria-label="Direct link to Remote Access to Kubernetes Pod" title="Direct link to Remote Access to Kubernetes Pod">​</a></h2>
<p>The general command for remote accessing a pod is:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl exec -it pod name -n &lt;namespace&gt; -- /bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Example with Cambria FTC:</h1>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl exec -it cambriaftcapp-5c79586784-wbfvf -n capella-worker -- /bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extracting-cambria-cluster--cambria-ftc--cambria-license-logs">Extracting Cambria Cluster | Cambria FTC | Cambria License Logs<a href="#extracting-cambria-cluster--cambria-ftc--cambria-license-logs" class="hash-link" aria-label="Direct link to Extracting Cambria Cluster | Cambria FTC | Cambria License Logs" title="Direct link to Extracting Cambria Cluster | Cambria FTC | Cambria License Logs">​</a></h3>
<p>In a machine that has kubectl and the kubeconfig file for your Kubernetes cluster, open a terminal window and
make sure to set the KUBECONFIG environment variable to the path of your kubeconfig file. Then run one or
more of the following commands depending on what types of logs you need (or that Capella needs). You will get
a folder full of logs. Compress these logs into one zip file and send it to Capella:</p>
<p>pod name: the name of the pod to grab logs from (Eg. cambriaftcapp-5c79586784-wbfvf)</p>
<p><strong>Cambria FTC Logs</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp pod name:/opt/capella/Cambria/Logs ./CambriaFTCLogs -n capella-worker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Cambria Cluster Logs</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp pod name:/opt/capella/CambriaCluster/Logs ./CambriaClusterLogs -n default</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Cambria License Manager (Cambria FTC)</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp pod name:/opt/capella/CambriaLicenseManager/Logs ./CambriaFTCLicLogs -n capella-worker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Cambria License Manager (Cambria Cluster)</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp pod name:/opt/capella/CambriaLicenseManager/Logs ./CambriaClusterLicLogs -n default</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Copy Files to Cambria FTC / Cluster Pod</h1>
<p>In some cases, you might need to copy files to a Cambria FTC / Cluster pod. For example, you have an MP4 file
you want to use as a source directly from the encoding machine’s file system. In this case, to copy the file over
to the Cambria FTC / Cluster pod, do the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp &lt;host-file-path&gt; pod name:&lt;path-inside-container&gt; -n &lt;namespace&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Examples:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Copy file to Cambria FTC pod  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp /mnt/n/MySource.mp4 cambriaftcapp-7c55887db9-t42v7:/var/media/MySource.mp4 -n capella-worker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Copy file to Cambria Cluster pod  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp C:\MyKeys\MyKeyFile.key cambriaclusterapp-695dcc848f-vjpc7:/var/keys/MyKeyFile.key -n default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Copy directory to Cambria FTC container  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl cp /mnt/n/MyMediaFiles cambriaftcapp-7c55887db9-t42v7:/var/temp/mediafiles -n capella-worker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="restarting--re-creating-pods">Restarting / Re-creating Pods<a href="#restarting--re-creating-pods" class="hash-link" aria-label="Direct link to Restarting / Re-creating Pods" title="Direct link to Restarting / Re-creating Pods">​</a></h3>
<p>Kubectl does not currently have a way to restart pods. Instead, a pod will need to be “restarted” by deleting the pod
which causes a new pod to be created / existing pod to take over the containers.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Kubectl does not have a direct restart command. To restart a pod, delete it:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete pod pod name -n &lt;namespace&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Examples:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Delete Cambria FTC container  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete pod cambriaftcapp-7c55887db9-t42v7 -n capella-worker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Delete Cambria Cluster container  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete pod cambriaclusterapp-695dcc848f-vjpc7 -n default</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Find the ARN of a Role</h1>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws iam get-role --role-name=eksctl-autoscaler-role-$CLUSTER_NAME --query &quot;Role.Arn&quot; --output text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-glossary">11. Glossary<a href="#11-glossary" class="hash-link" aria-label="Direct link to 11. Glossary" title="Direct link to 11. Glossary">​</a></h3>
<p>This glossary provides a brief definition / description of some of the more common terms found in this guide.</p>
<h1>11.1. Kubernetes</h1>
<p>For Kubernetes terms, please refer to the official Kubernetes Glossary:
<a href="https://kubernetes.io/docs/reference/glossary/?fundamental=true" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/glossary/?fundamental=true</a></p>
<h1>11.2. Third-Party Tools</h1>
<p><strong>Argo</strong><br>
<!-- -->The Argo third-party system is a collection of tools for orchestrating parallel jobs in a Kubernetes environment.</p>
<p><strong>Argo-Events</strong><br>
<!-- -->An Argo tool that triggers Kubernetes functions based on external events such as webhook, S3, etc.</p>
<p><strong>Cert-Manager</strong><br>
<!-- -->Cert-manager automates retrieving and managing TLS certificates.<br>
<!-- -->Certificates are periodically renewed to remain valid.</p>
<p><strong>Helm</strong><br>
<!-- -->Helm is used for deploying and managing (install, update, delete) Kubernetes applications.</p>
<p><strong>Ingress-Nginx</strong><br>
<!-- -->Ingress-nginx uses Nginx as a reverse proxy and load balancer.<br>
<!-- -->In this guide, it is used to apply domain names to services such as the REST API, WebUI, and monitoring.</p>
<h1>11.3. Capella Applications</h1>
<p><strong>cambriaclusterapp</strong><br>
<!-- -->the Cambria Cluster application container. This container exists in all cambriaclusterapp-xyz pods.</p>
<p><strong>cambriaftautoscale</strong><br>
<!-- -->This container functions as a load balancer for the FTC autoscaler.<br>
<!-- -->It creates FTC nodes when Cambria Cluster detects queued jobs.</p>
<p><strong>cambriaftcapp</strong><br>
<!-- -->The Cambria FTC application container. Exists in all <em>cambriaftcapp-xyz</em> pods.</p>
<p><strong>cambriaftcconnect</strong><br>
<!-- -->this container is used for automatically connecting Cambria FTC instances to Cambria
Cluster. This container exists in all cambriaftcapp-xyz pods.</p>
<p><strong>cambrialeaderelector</strong><br>
<!-- -->Handles Cambria Cluster replication by determining the leader instance.<br>
<!-- -->Exists in all <em>cambriaclusterapp-xyz</em> pods.</p>
<p><strong>pgcluster-capella</strong><br>
<!-- -->A pod type containing the PostgreSQL database used by Cambria Cluster.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h3>
<h1>No Instances Are Being Deployed With FTC Autoscaler</h1>
<ol>
<li>On the Linux deployment machine, run:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl logs -c cambriaftcautoscale -n default $(kubectl get lease -o=jsonpath=&quot;{.items[0].spec.holderIdentity}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Check for any errors. Below are common issues:</li>
</ol>
<p>[AWS] NodePoolCreate exception: One or more errors occurred. (No cluster found for name: xyz.)</p>
<p>Edit the Helm values (cambriaClusterConfig.yaml) and verify that cpClusterName in
ftcAutoScalerExtraConfig is set to the correct kubernetes cluster name. If not, change the name in the
Helm values file and run the steps in 7. Updating / Upgrading Cambria Cluster / FTC.</p>
<p>[AWS] NodePoolCreate exception: One or more errors occurred. (Cross-account pass role is not allowed.)</p>
<p>This error can happen for many reasons but usually it means the IAM roles were not set up correctly or
they were not configured correctly in the Helm values file. First, check the Helm values file and make
sure all IAM roles specified are correct (See 4.2. Creating and Editing Helm Configuration File).
Otherwise, destroy the kubernetes cluster and re-create it.</p>
<p>[AWS] NodePoolCreate exception: One or more errors occurred. (User:
arn:aws:sts::12341234<!-- -->:assumed-role<!-- -->/eksctl-XYZ/i-12341234 is not authorized to perform: ABC on resource: arn:aws::xyzabc1234)</p>
<p>Similar to the previous error. Verify that the correct roles were set in the Helm values file. Otherwise,
destroy the kubernetes cluster and re-create it.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Cambria_FTC/FTC-Overview/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cambria FTC 5.x – Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Cambria_FTC/Installation Guides/Kubernetes/Akamai/Akamai-Kubernetes/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Akamai Cloud Kubernetes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#document-history" class="table-of-contents__link toc-highlight">Document History</a><ul><li><a href="#limitations-and-security-information" class="table-of-contents__link toc-highlight">Limitations and Security Information</a></li></ul></li><li><a href="#️-important-before-you-begin" class="table-of-contents__link toc-highlight">⚠️ Important: Before You Begin</a></li><li><a href="#️-critical-information-read-before-proceeding" class="table-of-contents__link toc-highlight">⚠️ Critical Information: Read Before Proceeding</a><ul><li><a href="#1-a-new-kubernetes-cluster-will-be-deployed" class="table-of-contents__link toc-highlight">1. A New Kubernetes Cluster Will Be Deployed</a></li><li><a href="#2-default-installation-is-non-secure" class="table-of-contents__link toc-highlight">2. Default Installation is Non-Secure</a></li><li><a href="#3-understand-your-transcoding-requirements" class="table-of-contents__link toc-highlight">3. Understand Your Transcoding Requirements</a></li><li><a href="#4-administrative-aws-rights-required" class="table-of-contents__link toc-highlight">4. Administrative AWS Rights Required</a></li><li><a href="#5-verify-aws-account-quota" class="table-of-contents__link toc-highlight">5. Verify AWS Account Quota</a></li><li><a href="#6-a-separate-linux-machine-is-required" class="table-of-contents__link toc-highlight">6. A Separate Linux Machine is Required</a></li><li><a href="#7-verify-region-specific-resource-availability" class="table-of-contents__link toc-highlight">7. Verify Region-Specific Resource Availability</a></li></ul></li><li><a href="#document-overview" class="table-of-contents__link toc-highlight">Document Overview</a></li><li><a href="#1-overview" class="table-of-contents__link toc-highlight">1. Overview</a><ul><li><a href="#11-cambria-cluster--ftc-kubernetes-deployment" class="table-of-contents__link toc-highlight">1.1 Cambria Cluster / FTC Kubernetes Deployment</a></li><li><a href="#cambria-cluster" class="table-of-contents__link toc-highlight"><strong>Cambria Cluster</strong></a></li><li><a href="#cambria-ftc" class="table-of-contents__link toc-highlight"><strong>Cambria FTC</strong></a></li><li><a href="#12-resource-usage" class="table-of-contents__link toc-highlight">1.2 Resource Usage</a></li><li><a href="#approximate-components" class="table-of-contents__link toc-highlight">Approximate Components</a></li></ul></li><li><a href="#13-aws-machine-information-and-benchmark" class="table-of-contents__link toc-highlight">1.3 AWS Machine Information and Benchmark</a><ul><li><a href="#13-aws-machine-information-and-benchmark-1" class="table-of-contents__link toc-highlight">1.3 AWS Machine Information and Benchmark</a></li></ul></li><li><a href="#14-cambria-application-access" class="table-of-contents__link toc-highlight">1.4 Cambria Application Access</a><ul><li><a href="#141-external-access-via-tcp-load-balancer" class="table-of-contents__link toc-highlight">1.4.1 External Access via TCP Load Balancer</a></li><li><a href="#142-http-ingress-via-reverse-proxy" class="table-of-contents__link toc-highlight">1.4.2 HTTP Ingress via Reverse Proxy</a></li></ul></li><li><a href="#15-firewall-information" class="table-of-contents__link toc-highlight">1.5 Firewall Information</a><ul><li><a href="#required-ports" class="table-of-contents__link toc-highlight">Required Ports</a></li></ul></li><li><a href="#16-specifications-for-linux-deployment-server" class="table-of-contents__link toc-highlight">1.6 Specifications for Linux Deployment Server</a></li><li><a href="#2-prerequisites" class="table-of-contents__link toc-highlight">2. Prerequisites</a><ul><li><a href="#21-linux-tools" class="table-of-contents__link toc-highlight">2.1 Linux Tools</a></li><li><a href="#important-aws-admin-rights" class="table-of-contents__link toc-highlight">Important: AWS Admin Rights</a></li></ul></li><li><a href="#3-create-kubernetes-cluster" class="table-of-contents__link toc-highlight">3. Create Kubernetes Cluster</a></li><li><a href="#31-create-aws-eks-cluster-and-cambria-cluster-node-group" class="table-of-contents__link toc-highlight">3.1. Create AWS EKS Cluster and Cambria Cluster Node Group</a><ul><li><a href="#information--recommendation" class="table-of-contents__link toc-highlight">Information / Recommendation</a></li><li><a href="#32-default-storage-class" class="table-of-contents__link toc-highlight">3.2. Default Storage Class</a></li><li><a href="#33-create-ebs-csi-driver" class="table-of-contents__link toc-highlight">3.3. Create EBS CSI Driver</a></li></ul></li><li><a href="#do-not-move-on-to-the-next-step-until-the-above-plugin-shows-active" class="table-of-contents__link toc-highlight">DO NOT MOVE ON TO THE NEXT STEP UNTIL THE ABOVE PLUGIN SHOWS ‘ACTIVE’</a><ul><li><a href="#34-aws-iam-permissions-for-ftc" class="table-of-contents__link toc-highlight">3.4. AWS IAM Permissions for FTC</a></li><li><a href="#341-create-ftc-role" class="table-of-contents__link toc-highlight">3.4.1. Create FTC Role</a></li><li><a href="#342-create-ftc-autoscaler-role" class="table-of-contents__link toc-highlight">3.4.2. Create FTC Autoscaler Role</a></li><li><a href="#35-create-cambria-ftc-node-groups" class="table-of-contents__link toc-highlight">3.5. Create Cambria FTC Node Group(s)</a></li><li><a href="#36--beta--gpu-operator-for-nvenc" class="table-of-contents__link toc-highlight">3.6. [ BETA ] GPU Operator for NVENC</a></li><li><a href="#37-application-ingress-ingress-nginx" class="table-of-contents__link toc-highlight">3.7. Application Ingress: Ingress-Nginx</a></li><li><a href="#create-the-alias-record-in-route-53" class="table-of-contents__link toc-highlight">Create the Alias Record in Route 53:</a></li><li><a href="#38-performance-metrics-and-logging" class="table-of-contents__link toc-highlight">3.8. Performance Metrics and Logging</a></li><li><a href="#4-install-cambria-cluster-ftc-and-dependencies" class="table-of-contents__link toc-highlight">4. Install Cambria Cluster, FTC, and Dependencies</a></li><li><a href="#cambriaclusterconfigyaml-explanation" class="table-of-contents__link toc-highlight">cambriaClusterConfig.yaml Explanation</a></li><li><a href="#43-installing-cambria-ftc--cluster" class="table-of-contents__link toc-highlight">4.3. Installing Cambria FTC / Cluster</a></li><li><a href="#5-verify-cambria-ftc--cluster-installation" class="table-of-contents__link toc-highlight">5. Verify Cambria FTC / Cluster Installation</a></li><li><a href="#51-verify-cambria-cluster-deployment" class="table-of-contents__link toc-highlight">5.1. Verify Cambria Cluster Deployment</a></li><li><a href="#52-verify-cambria-ftc-deployment" class="table-of-contents__link toc-highlight">5.2. Verify Cambria FTC Deployment</a></li><li><a href="#53-verify-applications-are-accessible" class="table-of-contents__link toc-highlight">5.3. Verify Applications are Accessible</a></li><li><a href="#531-cambria-cluster-webui" class="table-of-contents__link toc-highlight">5.3.1. Cambria Cluster WebUI</a></li><li><a href="#532-cambria-cluster-rest-api" class="table-of-contents__link toc-highlight">5.3.2. Cambria Cluster REST API</a></li><li><a href="#533-cambria-license" class="table-of-contents__link toc-highlight">5.3.3. Cambria License</a></li><li><a href="#534-cambria-ingress" class="table-of-contents__link toc-highlight">5.3.4. Cambria Ingress</a></li><li><a href="#6-testing-cambria-ftc--cluster" class="table-of-contents__link toc-highlight">6. Testing Cambria FTC / Cluster</a></li><li><a href="#7-updating--upgrading-cambria-cluster--ftc" class="table-of-contents__link toc-highlight">7. Updating / Upgrading Cambria Cluster / FTC</a></li><li><a href="#71-option-1-normal-upgrade-via-helm-upgrade" class="table-of-contents__link toc-highlight">7.1. Option 1: Normal Upgrade via Helm Upgrade</a></li><li><a href="#72-option-2-upgrade-via-cambria-cluster-reinstallation" class="table-of-contents__link toc-highlight">7.2. Option 2: Upgrade via Cambria Cluster Reinstallation</a></li><li><a href="#73-upgrade-verification" class="table-of-contents__link toc-highlight">7.3. Upgrade Verification</a></li><li><a href="#8-deleting-kubernetes-cluster" class="table-of-contents__link toc-highlight">8. Deleting Kubernetes Cluster</a></li><li><a href="#9-quick-reference-installation-testing-and-teardown" class="table-of-contents__link toc-highlight">9. Quick Reference: Installation, Testing, and Teardown</a></li><li><a href="#10-quick-reference-helpful-commands--info-for-after-installation" class="table-of-contents__link toc-highlight">10. Quick Reference: Helpful Commands / Info for After Installation</a></li><li><a href="#cambria-cluster-webui" class="table-of-contents__link toc-highlight">Cambria Cluster WebUI</a></li></ul></li><li><a href="#cambria-cluster-rest-api" class="table-of-contents__link toc-highlight">Cambria Cluster REST API</a></li><li><a href="#leader-cambria-cluster-pod" class="table-of-contents__link toc-highlight">Leader Cambria Cluster Pod</a><ul><li><a href="#cambria-ftc-instance-external-ip" class="table-of-contents__link toc-highlight">Cambria FTC Instance External IP</a></li></ul></li><li><a href="#remote-access-to-kubernetes-pod" class="table-of-contents__link toc-highlight">Remote Access to Kubernetes Pod</a><ul><li><a href="#extracting-cambria-cluster--cambria-ftc--cambria-license-logs" class="table-of-contents__link toc-highlight">Extracting Cambria Cluster | Cambria FTC | Cambria License Logs</a></li><li><a href="#restarting--re-creating-pods" class="table-of-contents__link toc-highlight">Restarting / Re-creating Pods</a></li><li><a href="#11-glossary" class="table-of-contents__link toc-highlight">11. Glossary</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.capellasystems.net/about-capella" target="_blank" rel="noopener noreferrer" class="footer__link-item">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.capellasystems.net/newsfeed" target="_blank" rel="noopener noreferrer" class="footer__link-item">Newsfeed<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.capellasystems.net/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://documents.capellasystems.net/docs/Cambria%20Stream/Installation%20Guides/Kubernetes/AWS/AWS_Kubernetes_Documentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cambria Stream<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://documents.capellasystems.net/docs/Cambria_FTC/Installation%20Guides/Kubernetes/AWS/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cambria FTC<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Other</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.capellasystems.net/terms-of-use" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.capellasystems.net/online-privacy-policy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Capella Systems</div></div></div></footer></div>
</body>
</html>